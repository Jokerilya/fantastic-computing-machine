{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\product\\product-detail\\index.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\product\\product-detail\\index.vue","mtime":1669258939322},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\@vue\\cli-service\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWRpdF92aWV3IHsKICBvdmVyZmxvdzogaGlkZGVuOwogIHBhZGRpbmc6IDUwcHggMjBweDsKICBiYWNrZ3JvdW5kOiAjZmZmZmZmOwogIC5lbC1mb3JtIHsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICBwYWRkaW5nOiAxMHB4OwogICAgLmVsX2Nhc2NhZGVyIGlucHV0IHsKICAgICAgJjo6cGxhY2Vob2xkZXIgewogICAgICAgIGNvbG9yOiAjMzMzOwogICAgICB9CiAgICB9CiAgICAuc3BlY19uYW1lIHsKICAgICAgaW5wdXQgewogICAgICAgIC8vIGJhY2tncm91bmQ6ICMzMDMxMzM7CiAgICAgICAgLy8gZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgLy8gYm9yZGVyLWNvbG9yOiAjMzAzMTMzOwogICAgICAgIC8vIGNvbG9yOiAjZmZmZmZmOwogICAgICB9CiAgICB9CiAgfQogIC5mbG9hdF9pdGVtIHsKICAgIGhlaWdodDogYXV0bzsKICAgIHdpZHRoOiA1MCU7CiAgICBmbG9hdDogbGVmdDsKICB9CiAgLmxpc3RfdGFibGUgewogICAgLmVsLWlucHV0X19pbm5lciB7CiAgICAgIGhlaWdodDogMzNweDsKICAgIH0KICAgIC5lbC1pbnB1dF9faWNvbiB7CiAgICAgIGxpbmUtaGVpZ2h0OiAzM3B4OwogICAgfQogICAgLmVsLXNlbGVjdCB7CiAgICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgICAgbWFyZ2luLWJvdHRvbTogNXB4OwogICAgfQogIH0KICAudmFsdWVfaXRlbSB7CiAgICBmbG9hdDogbGVmdDsKICAgIG1hcmdpbi1yaWdodDogNXB4OwogICAgLml0ZW0gewogICAgICB3aWR0aDogMTUwcHg7CiAgICAgIHBhZGRpbmc6IDVweCAwOwogICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAuZWwtaW5wdXQgewogICAgICAgIGZsb2F0OiBsZWZ0OwogICAgICAgIHdpZHRoOiAxMDBweDsKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4kCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/product/product-detail","sourcesContent":["<template>\n  <div class=\"content_box\">\n    <first-title title=\"新增/编辑商品\" />\n    <div class=\"edit_view\">\n      <el-form ref=\"form\" :model=\"addEditData\" label-width=\"110px\">\n        <el-form-item class=\"float_item\" label=\"是否多规格\">\n          <el-select\n            :disabled=\"addEditData.id != ''\"\n            v-model=\"addEditData.isExistManySpec\"\n            style=\"width: 300px\"\n            placeholder=\"请选择是否多规格\"\n          >\n            <el-option\n              v-for=\"item in isExistManySpec\"\n              :key=\"item.val\"\n              :label=\"item.name\"\n              :value=\"item.val\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item class=\"float_item\" label=\"商品型号\">\n          <el-input\n            v-model=\"addEditData.mode\"\n            placeholder=\"请输入商品型号\"\n            style=\"width: 300px\"\n          />\n        </el-form-item>\n        <el-form-item class=\"float_item\" style=\"height: auto\" label=\"商品名称\">\n          <el-input\n            v-model=\"addEditData.title\"\n            rows=\"3\"\n            type=\"textarea\"\n            style=\"width: 300px\"\n            resize=\"none\"\n          />\n        </el-form-item>\n        <el-form-item class=\"float_item\" style=\"height: auto\" label=\"商品简述\">\n          <el-input\n            v-model=\"addEditData.simpleDesc\"\n            rows=\"3\"\n            type=\"textarea\"\n            style=\"width: 300px\"\n            resize=\"none\"\n          />\n        </el-form-item>\n        <div style=\"width: 100%; height: auto; overflow: hidden; float: left\">\n          <el-form-item\n            class=\"float_item\"\n            style=\"height: auto\"\n            label=\"商品封面图\"\n          >\n            <upload-img\n              width=\"80px\"\n              height=\"80px\"\n              :img=\"addEditData.coverImage\"\n              @uploadSuc=\"uploadSucFn\"\n            />\n          </el-form-item>\n          <el-form-item\n            class=\"float_item\"\n            style=\"height: auto\"\n            label=\"商品多图\"\n          >\n            <upload-imgs\n              :imgs=\"addEditData.images\"\n              @uploadSuc=\"uploadImgsSucFn\"\n              @deleteImg=\"deleteImgFn\"\n            />\n          </el-form-item>\n        </div>\n        <div style=\"width: 100%; height: auto; overflow: hidden; float: left\">\n          <el-form-item\n            class=\"float_item\"\n            style=\"height: auto\"\n            label=\"商品背景图\"\n          >\n            <upload-img\n              width=\"80px\"\n              height=\"80px\"\n              :img=\"addEditData.backImage\"\n              @uploadSuc=\"uploadSucFn2\"\n            />\n            <span style=\"font-size: 12px; color: #999\"\n              >注：鼠标移入显示的图片</span\n            >\n          </el-form-item>\n          <el-form-item class=\"float_item\" label=\"商品类型\">\n            <el-select\n              v-model=\"addEditData.type\"\n              style=\"width: 300px\"\n              placeholder=\"请选择商品类型\"\n              @change=\"productTypeChange\"\n            >\n              <el-option\n                v-for=\"item in types\"\n                :key=\"item.val\"\n                :label=\"item.name\"\n                :value=\"item.val\"\n              />\n            </el-select>\n          </el-form-item>\n        </div>\n\n        <el-form-item class=\"float_item\" label=\"商品分类\">\n          <el-cascader\n            style=\"width: 300px\"\n            v-model=\"addEditData.categoryId\"\n            :class=\"{ el_cascader: addEditData.categoryId != '' }\"\n            :placeholder=\"\n              addEditData.categoryId\n                ? addEditData.categoryName\n                : '请选择商品分类'\n            \"\n            expand-trigger=\"hover\"\n            :props=\"categoryList\"\n            :show-all-levels=\"false\"\n            clearable\n            :disabled=\"!addEditData.type\"\n          />\n        </el-form-item>\n        <!-- <el-form-item class=\"float_item\" label=\"商品分类\" v-if=\"addEditData.type === 3\">\n\t\t\t<el-select v-model=\"addEditData.partsId\" filterable placeholder=\"请选择配件分类\" style=\"width: 300px;\" :disabled=\"!addEditData.type\">\n\t\t\t\t<el-option v-for=\"item in categoryPartsList\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\n\t\t\t</el-select>\n\t\t\t<el-cascader style=\"width: 300px\" v-model=\"addEditData.partsId\" :class=\"{ el_cascader: addEditData.partsId != '' }\" placeholder=\"请选择配件分类\" expand-trigger=\"hover\" :props=\"categoryList\" :show-all-levels=\"false\" clearable :disabled=\"!addEditData.type\" />\n        </el-form-item> -->\n\n        <el-form-item class=\"float_item\" label=\"上/下架\">\n          <el-select\n            v-model=\"addEditData.isShelves\"\n            style=\"width: 300px\"\n            placeholder=\"请选择上/下架\"\n          >\n            <el-option\n              v-for=\"item in isShelves\"\n              :key=\"item.val\"\n              :label=\"item.name\"\n              :value=\"item.val\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item class=\"float_item\" label=\"参考价(销售价)\" v-if=\"addEditData.isExistManySpec == 0\">\n          <el-input\n            v-model=\"addEditData.price\"\n            style=\"width: 300px\"\n            min=\"0\"\n            type=\"number\"\n          />\n        </el-form-item>\n        <el-form-item class=\"float_item\" label=\"运费\">\n          <el-select\n            v-model=\"addEditData.expId\"\n            style=\"width: 300px\"\n            clearable\n            placeholder=\"请选择运费模板\"\n          >\n            <el-option\n              v-for=\"item in expList\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            />\n          </el-select>\n        </el-form-item>\n\n        <el-form-item class=\"float_item\" label=\"供应商\">\n          <el-select\n            v-model=\"addEditData.supplierId\"\n            style=\"width: 300px\"\n            filterable\n            clearable\n            placeholder=\"请选择供应商\"\n          >\n            <el-option\n              v-for=\"item in supplierList\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            />\n          </el-select>\n        </el-form-item>\n\n        <el-form-item class=\"float_item\" label=\"库存\" v-if=\"addEditData.isExistManySpec == 0\">\n          <el-input\n            v-model=\"addEditData.lastInventory\"\n            style=\"width: 300px\"\n            min=\"0\"\n            type=\"number\"\n            placeholder=\"请输入库存\"\n          />\n        </el-form-item>\n\n        <el-form-item class=\"float_item\" label=\"原价\" v-if=\"addEditData.isExistManySpec == 0\">\n          <el-input\n            v-model=\"addEditData.originalPrice\"\n            style=\"width: 300px\"\n            min=\"0\"\n            type=\"number\"\n            placeholder=\"请输入原价\"\n          />\n        </el-form-item>\n\n        <template v-if=\"addEditData.type === 2\">\n          <el-form-item\n            class=\"float_item\"\n            style=\"height: auto\"\n            label=\"拼团库存\"\n          >\n            <el-input-number\n              v-model=\"addEditData.groupNum\"\n              style=\"width: 300px\"\n            />\n          </el-form-item>\n\n          <!-- <el-form-item class=\"float_item\" style=\"height: auto\" label=\"拼团时长(H)\">\n\t\t  <el-input-number\n\t\t    v-model=\"addEditData.groupHours\"\n\t\t    style=\"width: 300px\"\n\t\t  />\n\t\t</el-form-item> -->\n\n          <el-form-item\n            class=\"float_item\"\n            style=\"height: auto\"\n            label=\"活动截止时间\"\n          >\n            <el-date-picker\n              v-model=\"addEditData.activityTime\"\n              class=\"mg_r15 mg_t10\"\n              type=\"datetimerange\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              range-separator=\"至\"\n              start-placeholder=\"开始日期\"\n              end-placeholder=\"结束日期\"\n            >\n            </el-date-picker>\n          </el-form-item>\n        </template>\n\n        <el-form-item\n          v-if=\"addEditData.isExistManySpec == 1\"\n          style=\"clear: both\"\n          label=\"商品规格属性\"\n        >\n          <el-table\n            class=\"list_table\"\n            :data=\"addEditData.list\"\n            border\n            style=\"width: 100%\"\n          >\n            <el-table-column label=\"规格名称(例如:颜色)\" width=\"150\">\n              <template slot-scope=\"scope\">\n                <el-input\n                  v-model=\"scope.row.name\"\n                  class=\"spec_name\"\n                  placeholder=\"填写规格名称\"\n                  @input=\"nameChange(scope.$index)\"\n                />\n              </template>\n            </el-table-column>\n            <el-table-column label=\"规格值(例如:白色,红色)\">\n              <template slot-scope=\"scope\">\n                <div\n                  v-for=\"(item, index) in scope.row.value\"\n                  :key=\"index\"\n                  class=\"value_item\"\n                >\n                  <div class=\"item\">\n                    <el-input\n                      v-model=\"scope.row.value[index]\"\n                      placeholder=\"规格值\"\n                      @input=\"valueChange(scope.$index, index)\"\n                    />\n                    <el-button\n                      v-if=\"\n                        !addEditData.id ||\n                        editAddValItem.indexOf(scope.$index + ',' + index) > -1\n                      \"\n                      type=\"danger\"\n                      size=\"small\"\n                      icon=\"el-icon-delete\"\n                      @click=\"delListValuItemFn(scope.$index, index)\"\n                    />\n                  </div>\n                </div>\n              </template>\n            </el-table-column>\n            <el-table-column\n              label=\"操作\"\n              width=\"180\"\n              align=\"center\"\n              header-align=\"center\"\n            >\n              <template slot-scope=\"scope\">\n                <el-button\n                  size=\"small\"\n                  type=\"primary\"\n                  @click=\"addListValFn(scope.$index)\"\n                  >添加规格值</el-button\n                >\n                <el-button\n                  v-if=\"!addEditData.id\"\n                  size=\"small\"\n                  type=\"danger\"\n                  @click=\"delListFn(scope.$index)\"\n                  >删除</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-button\n            v-if=\"!addEditData.id\"\n            size=\"small\"\n            icon=\"el-icon-plus\"\n            style=\"margin-top: 15px\"\n            type=\"primary\"\n            @click=\"addListItemFn\"\n            >添加规格属性</el-button\n          >\n        </el-form-item>\n        <el-form-item v-if=\"addEditData.isExistManySpec == 1\" label=\"商品规格\">\n          <el-table\n            class=\"list_table\"\n            :data=\"addEditData.specList\"\n            border\n            style=\"width: 100%\"\n          >\n            <el-table-column label=\"规格组合\" width=\"440\">\n              <template slot-scope=\"scope\">\n                <template v-for=\"(item, index) in scope.row.skuIndex\">\n                  <el-select\n                    v-if=\"addEditData.list[index]\"\n                    :key=\"index\"\n                    v-model=\"scope.row.skuIndex[index]\"\n                    style=\"width: 120px\"\n                    :placeholder=\"`请选择${addEditData.list[index].name}`\"\n                  >\n                    <el-option\n                      v-for=\"(item2, index2) in addEditData.list[index].value\"\n                      :key=\"index2\"\n                      :label=\"item2\"\n                      :value=\"index2 + ''\"\n                    />\n                  </el-select>\n                </template>\n              </template>\n            </el-table-column>\n            <el-table-column\n              label=\"规格图片\"\n              width=\"100px\"\n              align=\"center\"\n              header-align=\"center\"\n            >\n              <template slot-scope=\"scope\">\n                <upload-img\n                  width=\"80px\"\n                  height=\"80px\"\n                  :img=\"scope.row.specImage\"\n                  @uploadSuc=\"upLoadSpceImgFn($event, scope.$index)\"\n                />\n              </template>\n            </el-table-column>\n            <el-table-column\n              label=\"规格编码\"\n              align=\"center\"\n              header-align=\"center\"\n            >\n              <template slot-scope=\"scope\">\n                <el-input v-model=\"scope.row.skuCode\" min=\"0\" type=\"text\" />\n              </template>\n            </el-table-column>\n\n            <el-table-column\n              v-if=\"addEditData.isExistManySpec == 1\"\n              label=\"参考价(销售价)\"\n              align=\"center\"\n              header-align=\"center\"\n            >\n              <template slot-scope=\"scope\">\n                <el-input v-model=\"scope.row.price\" min=\"0\" type=\"number\" />\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"原价\" align=\"center\" header-align=\"center\">\n              <template slot-scope=\"scope\">\n                <el-input\n                  v-model=\"scope.row.originalPrice\"\n                  min=\"0\"\n                  type=\"number\"\n                />\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"库存\" align=\"center\" header-align=\"center\">\n              <template slot-scope=\"scope\">\n                <el-input v-model=\"scope.row.inventory\" min=\"0\" type=\"number\" />\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"操作\" align=\"center\" header-align=\"center\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  size=\"small\"\n                  type=\"danger\"\n                  @click=\"delSpecFn(scope.$index)\"\n                  >删除</el-button\n                >\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-button\n            size=\"small\"\n            style=\"margin-top: 15px\"\n            type=\"primary\"\n            icon=\"el-icon-plus\"\n            @click=\"addSpecItemFn\"\n            >添加商品规格</el-button\n          >\n          <el-button\n            v-if=\"!addEditData.id\"\n            size=\"small\"\n            style=\"margin-top: 15px\"\n            type=\"success\"\n            icon=\"el-icon-plus\"\n            @click=\"showBatchDataFn\"\n            >批量生成所有规格</el-button\n          >\n        </el-form-item>\n        <el-form-item style=\"clear: both\" label=\"商品详情\">\n          <tinymce :key=\"addEditData.id\"\n            ref=\"ppp\"\n            :id=\"'agreement_' + addEditData.id\"\n            v-model=\"addEditData.content\"\n            :height=\"600\"\n          />\n        </el-form-item>\n        <el-form-item label=\"\">\n          <el-link\n            v-if=\"productId\"\n            style=\"margin-right: 10px\"\n            :href=\"`#/product/product-list?pageNo=${pageNo}&pageSize=${pageSize}`\"\n          >\n            <el-button type=\"primary\" plain icon=\"el-icon-d-arrow-left\"\n              >返回</el-button\n            >\n          </el-link>\n          <el-button type=\"primary\" :disabled=\"submitIng\" @click=\"submitFn\">{{\n            submitIng ? \"提交中...\" : \"确认提交\"\n          }}</el-button>\n          <span v-show=\"submitIng\" style=\"margin-left: 15px; color: #f56c6c\"\n            >提交中,请勿重复点击!</span\n          >\n        </el-form-item>\n      </el-form>\n    </div>\n\n    <el-dialog\n      title=\"设置批量生成参数\"\n      :visible.sync=\"dialogVisible\"\n      width=\"600px\"\n    >\n      <div>\n        <el-form ref=\"form\" :model=\"batchData\" label-width=\"140px\">\n          <el-form-item label=\"批量规格图片\">\n            <upload-img\n              width=\"80px\"\n              height=\"80px\"\n              :img=\"batchData.specImage\"\n              @uploadSuc=\"batchImgSucFn\"\n            />\n          </el-form-item>\n          <el-form-item label=\"批量参考价\">\n            <el-input v-model=\"batchData.price\" min=\"0\" type=\"number\" />\n          </el-form-item>\n          <el-form-item label=\"批量规格库存\">\n            <el-input v-model=\"batchData.inventory\" min=\"0\" type=\"number\" />\n          </el-form-item>\n        </el-form>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"batchCreatFn\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport uploadImg from \"@/components/uploadImg/upload-img.vue\";\nimport uploadImgs from \"@/components/uploadImgs/upload-imgs.vue\";\nimport Tinymce from \"@/components/Tinymce\";\nimport {\n  getProductDetailFn,\n  queryProductCategoryFn,\n  editProductFn,\n  queryProductFittingCategoryFn,\n  querySupplierList,\n} from \"@/api/product.js\";\nimport { queryExpRuleFn } from \"@/api/system.js\";\nexport default {\n  name: \"ProductList\",\n  components: {\n    Tinymce,\n    uploadImg,\n    uploadImgs,\n  },\n  data() {\n    return {\n      pageNo: 0,\n      pageSize: 0,\n      submitIng: false,\n      productId: \"\",\n      dialogVisible: false,\n      editAddValItem: [],\n      types: [\n        { name: \"优选商品\", val: 1 },\n        { name: \"拼团产品\", val: 2 },\n        { name: \"配件\", val: 3 },\n        { name: \"机件\", val: 4 },\n      ],\n      isShelves: [\n        { name: \"上架\", val: 1 },\n        { name: \"下架\", val: 0 },\n      ],\n      isExistManySpec: [\n        { name: \"是\", val: 1 },\n        { name: \"否\", val: 0 },\n      ],\n      addEditData: {\n        expId: \"\",\n        categoryId: \"\",\n        content: \"\",\n        coverImage: \"\",\n        backImage: \"\",\n        id: \"\",\n        images: [],\n        inventory: \"\",\n        isExistManySpec: \"\",\n        isShelves: \"\",\n        mode: \"\",\n        price: 0,\n        simpleDesc: \"\",\n        list: [],\n        specList: [],\n        title: \"\",\n        type: \"\",\n        // partsId:'',\n        supplierId: \"\",\n        // groupHours:1,\n        groupNum: 1,\n        activityTime: [],\n        activityStartTime: \"\",\n        activityEndTime: \"\",\n        lastInventory:'',\n        originalPrice:''\n      },\n      supplierList: [], // 供应商列表\n      editLevelData: [],\n      expList: [],\n      batchData: {\n        specImage: \"\",\n        price: 0,\n        originalPrice: 0,\n        inventory: 0,\n      },\n      results: [],\n      result: [],\n      levelList: [],\n      categoryList: {\n        lazy: true,\n        checkStrictly: true,\n        lazyLoad(node, resolve) {\n          queryProductCategoryFn({ pid: node.value || 0 }).then((res) => {\n            const resData = res.data;\n            const nodes = resData.map((item) => ({\n              value: item.id,\n              label: item.name,\n            }));\n            // 通过调用resolve将子节点数据返回，通知组件数据加载完成\n            resolve(nodes);\n          });\n        },\n      },\n      categoryPartsList: [],\n    };\n  },\n  mounted() {\n    this.productId = this.$route.query.id;\n    this.pageNo = this.$route.query.pageNo;\n    this.pageSize = this.$route.query.pageSize;\n    this.getInit();\n  },\n  created() {\n    this.queryProductFittingCategoryFn();\n  },\n  activated() {\n    // 解决组件被keep-alive无法更新数据\n    this.addProductFn();\n    this.productId = this.$route.query.id;\n    this.pageNo = this.$route.query.pageNo;\n    this.pageSize = this.$route.query.pageSize;\n    this.getInit();\n  },\n  watch: {\n    productId(newval) {\n      if (newval === undefined) {\n        this.$refs.ppp.setContent(\"\");\n      }\n    },\n  },\n  methods: {\n    // 获取\n    async getInit() {\n      await queryExpRuleFn({\n        pageNo: 1,\n        pageSize: 20,\n        name: \"\",\n      }).then((res) => {\n        const resData = this.resDataFn(res);\n        this.expList.splice(0, this.expList.length, ...resData.records);\n      });\n      this.getProductDetailFn();\n      this.getQuerySupplierList();\n    },\n    // 获取供应商列表\n    async getQuerySupplierList() {\n      const res = await querySupplierList({\n        pageNo: 1,\n        pageSize: 1000,\n      });\n      if (res.code === \"000\") {\n        this.supplierList = res.data.records;\n      }\n    },\n    // 产品类型选择\n    productTypeChange(e) {\n      this.addEditData.categoryId = \"\";\n    },\n    // 获取装机配件商品分类\n    async queryProductFittingCategoryFn() {\n      const res = await queryProductFittingCategoryFn();\n      if (res.code === \"000\") {\n        this.categoryPartsList = res.data;\n      }\n    },\n    //\n    cascaderChangeFn(val) {\n      // const endIndex = val.length - 1\n      // this.addEditData.categoryId = val[endIndex]\n    },\n    nameChange(index) {\n      this.addEditData.list[index].name = this.addEditData.list[\n        index\n      ].name.replace(/\\s+/g, \"\");\n    },\n    valueChange(index, index2) {\n      this.addEditData.list[index].value[index2] = this.addEditData.list[\n        index\n      ].value[index2].replace(/\\s+/g, \"\");\n    },\n    levelValueChange(index, key) {\n      this.editLevelData[index][key] = this.editLevelData[index][key].replace(\n        /\\s+/g,\n        \"\"\n      );\n    },\n    batchCreatFn() {\n      const arr = [];\n      this.result = [];\n      this.results = [];\n      this.addEditData.specList.splice(0, this.addEditData.specList.length);\n      this.addEditData.list.forEach((item) => {\n        const valArr = [];\n        item.value.forEach((item, index) => {\n          valArr.push(index + \"\");\n        });\n        arr.push(valArr);\n      });\n      this.doExchange(arr, 0);\n      this.results.forEach((item) => {\n        this.addEditData.specList.push({\n          specImage: this.batchData.specImage,\n          inventory: this.batchData.inventory,\n          skuName: \"\",\n          skuCode: \"\",\n          price: this.batchData.price,\n          originalPrice: this.batchData.originalPrice,\n          skuIndex: item.split(\",\"),\n        });\n      });\n      this.dialogVisible = false;\n    },\n    doExchange(arr, index) {\n      for (var i = 0; i < arr[index].length; i++) {\n        this.result[index] = arr[index][i];\n        if (index != arr.length - 1) {\n          this.doExchange(arr, index + 1);\n        } else {\n          this.results.push(this.result.join(\",\"));\n        }\n      }\n    },\n    showBatchDataFn() {\n      if (this.addEditData.list.length == 0) {\n        this.$message({\n          showClose: true,\n          message: `请添加规格属性！`,\n          type: \"warning\",\n        });\n        return;\n      }\n      this.dialogVisible = true;\n    },\n    batchImgSucFn(img) {\n      this.batchData.specImage = img;\n    },\n    addProductFn() {\n      this.addEditData = {\n        expId: \"\",\n        categoryId: \"\",\n        content: \"\",\n        coverImage: \"\",\n        backImage: \"\",\n        id: \"\",\n        images: [],\n        inventory: \"\",\n        isExistManySpec: \"\",\n        isShelves: \"\",\n        mode: \"\",\n        originalPrice: \"\",\n        price: \"\",\n        lastInventory:\"\",\n        simpleDesc: \"\",\n        list: [],\n        specList: [],\n        title: \"\",\n        // partsId:'',\n        supplierId: \"\",\n        // groupHours:1,\n        groupNum: 1,\n        activityTime: [],\n        activityStartTime: \"\",\n        activityEndTime: \"\",\n      };\n    },\n    submitFn() {\n      const postData = JSON.parse(JSON.stringify(this.addEditData));\n      postData.originalPrice = Number(postData.originalPrice);\n      postData.lastInventory = Number(postData.lastInventory)\n      console.log(postData, \"000\");\n      let listFlag = true;\n      let specListFlag = true;\n\n      // 规格数据验证\n      if (this.addEditData.isExistManySpec == 1) {\n        if (this.addEditData.list.length == 0) {\n          listFlag = false;\n          this.$message({\n            showClose: true,\n            message: `请添加规格属性！`,\n            type: \"warning\",\n          });\n        }\n        if (this.addEditData.specList.length == 0) {\n          specListFlag = false;\n          this.$message({\n            showClose: true,\n            message: `请添加商品规格！`,\n            type: \"warning\",\n          });\n        }\n        for (var i = 0, j = this.addEditData.list.length; i < j; i++) {\n          if (this.addEditData.list[i].value.length == 0) {\n            listFlag = false;\n            this.$message({\n              showClose: true,\n              message: `请添加“${this.addEditData.list[i].name}”规格属性值或者删除该规格属性！`,\n              type: \"warning\",\n            });\n            break;\n          }\n          this.addEditData.list[i].value.forEach((item, index) => {\n            console.log(index);\n            if (item == \"\") {\n              listFlag = false;\n              this.$message({\n                showClose: true,\n                message: `“${this.addEditData.list[i].name}”规格属性第${\n                  index + 1\n                }个值为空，请删除或输入值！`,\n                type: \"warning\",\n              });\n            }\n          });\n        }\n        for (var m = 0, n = this.addEditData.specList.length; m < n; m++) {\n          if (this.addEditData.specList[m].skuIndex.indexOf(\"\") > -1) {\n            specListFlag = false;\n            this.$message({\n              showClose: true,\n              message: `第${\n                m - 0 + 1\n              }个商品规格有规格属性未选择，请选择后再提交！`,\n              type: \"warning\",\n            });\n            break;\n          }\n        }\n\n        postData.specList.forEach((item) => {\n          let name = \"\";\n          item.skuIndex.forEach((item2, index) => {\n            name += postData.list[index].value[Number(item2)] + \",\";\n          });\n          item.skuName = name;\n          item.skuName = item.skuName.replace(/\\,$/, \"\");\n          item.skuIndex = item.skuIndex.join(\",\");\n        });\n        postData.list.forEach((item) => {\n          item.value = item.value.join(\",\");\n        });\n        postData.inventory = undefined;\n      }\n      if (!listFlag || !specListFlag) {\n        return;\n      }\n      if (this.addEditData.isExistManySpec === 1) {\n        postData.specInfoList = postData.list.slice();\n        postData.skuInfoList = postData.specList.slice();\n      } else {\n        postData.specInfoList = [];\n        postData.skuInfoList = [];\n      }\n      // postData.rewardInfoList = this.editLevelData;\n      // postData.rewardInfoList.map((item) => {\n      //   delete item.name;\n      // });\n      delete postData.list;\n      delete postData.specList;\n      delete postData.categoryName;\n      delete postData.createTime;\n\n      if (!postData.categoryId || postData.categoryId.length === 0) {\n        this.$message({\n          showClose: true,\n          message: `请选择商品分类！`,\n          type: \"warning\",\n        });\n        return;\n      }\n      /* if(this.addEditData.type !== 3){\n\t\t if (!postData.categoryId || postData.categoryId.length === 0) {\n\t\t\tthis.$message({\n\t\t\t  showClose: true,\n\t\t\t  message: `请选择商品分类！`,\n\t\t\t  type: \"warning\",\n\t\t\t});\n\t\t\treturn;\n\t\t  }\n\t  }else{\n\t\t  if (!postData.partsId || postData.partsId.length === 0) {\n\t\t\t\tthis.$message({\n\t\t\t\t  showClose: true,\n\t\t\t\t  message: `请选择商品分类！`,\n\t\t\t\t  type: \"warning\",\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t   }\n\t  } */\n\n      if (!this.addEditData.supplierId) {\n        this.$message({\n          showClose: true,\n          message: `请选择供应商！`,\n          type: \"warning\",\n        });\n        return;\n      }\n      postData.categoryId = postData.categoryId.pop();\n      postData.images = postData.images.join(\",\");\n      postData.id = this.productId ? this.productId : undefined;\n      postData.activityStartTime = postData.activityTime[0];\n      postData.activityEndTime = postData.activityTime[1];\n      console.log(postData);\n      // return\n      this.submitIng = true;\n      editProductFn(postData)\n        .then((res) => {\n          setTimeout(() => {\n            this.submitIng = false;\n          }, 1000);\n          if (res.code == \"000\") {\n            this.$message({\n              showClose: true,\n              message: \"操作成功！\",\n              type: \"success\",\n            });\n            this.editAddValItem.splice(0, this.editAddValItem.length);\n            if (this.productId) {\n              this.getProductDetailFn();\n            } else {\n              this.$router.go(-1);\n            }\n          }\n        })\n        .catch(() => {\n          setTimeout(() => {\n            this.submitIng = false;\n          }, 1000);\n        });\n    },\n    upLoadSpceImgFn(img, index) {\n      this.addEditData.specList[index].specImage = img;\n    },\n    addSpecItemFn() {\n      let specListMoreLength = 1;\n      if (this.addEditData.list.length == 0) {\n        this.$message({\n          showClose: true,\n          message: \"请先添加规格属性和规格属性值！\",\n          type: \"warning\",\n        });\n        return;\n      }\n      this.addEditData.list.forEach((item) => {\n        specListMoreLength = specListMoreLength * item.value.length;\n      });\n      if (this.addEditData.specList.length >= specListMoreLength) {\n        this.$message({\n          showClose: true,\n          message: \"您添加的商品规格已达到最大数量！\",\n          type: \"warning\",\n        });\n        return;\n      }\n      this.addEditData.specList.push({\n        specImage: \"\",\n        skuName: \"\",\n        inventory: 0,\n        skuCode: \"\",\n        price: 0,\n        originalPrice: 0,\n        skuIndex: Array(this.addEditData.list.length).fill(\"\"),\n      });\n    },\n    addListItemFn() {\n      this.addEditData.list.push({ name: \"\", value: [] });\n      this.addEditData.specList.forEach((item) => {\n        item.skuIndex.push(\"\");\n      });\n    },\n    delListValuItemFn(index, index2) {\n      for (var i = this.addEditData.specList.length; i--; ) {\n        // console.log('商品规格值：' + this.addEditData.specList[i].skuIndex[index], '规格：' + index, '规格值：' + index2)\n        if (this.addEditData.specList[i].skuIndex[index] != \"\") {\n          if (this.addEditData.specList[i].skuIndex[index] == index2) {\n            this.addEditData.specList.splice(i, 1);\n          }\n          if (this.addEditData.specList[i]) {\n            if (this.addEditData.specList[i].skuIndex[index] > index2) {\n              this.addEditData.specList[i].skuIndex[index] -= 1;\n              this.addEditData.specList[i].skuIndex[index] += \"\";\n            }\n          }\n        }\n      }\n      this.addEditData.list[index].value.splice(index2, 1);\n      const delIndex = this.editAddValItem.indexOf(index + \",\" + index2);\n      // this.editAddValItem.splice(delIndex, 1)\n    },\n    addListValFn(index) {\n      const delIndex = this.editAddValItem.indexOf(\n        index + \",\" + this.addEditData.list[index].value.length\n      );\n      if (delIndex == -1) {\n        this.editAddValItem.push(\n          index + \",\" + this.addEditData.list[index].value.length\n        );\n      }\n      this.addEditData.list[index].value.push(\"\");\n    },\n    delListFn(index) {\n      for (var i = this.addEditData.specList.length; i--; ) {\n        this.addEditData.specList[i].skuIndex.splice(index, 1);\n        if (this.addEditData.specList[i].skuIndex[index]) {\n          this.addEditData.specList.splice(i, 1);\n        }\n      }\n      this.addEditData.list.splice(index, 1);\n    },\n    delSpecFn(index) {\n      this.addEditData.specList.splice(index, 1);\n    },\n    uploadSucFn(img) {\n      this.addEditData.coverImage = img;\n    },\n    uploadSucFn2(img) {\n      this.addEditData.backImage = img;\n    },\n    uploadImgsSucFn(img) {\n      this.addEditData.images.push(img);\n    },\n    deleteImgFn(index) {\n      this.addEditData.images.splice(index, 1);\n      // console.log(this.addEditData.images,index)\n    },\n    getProductDetailFn() {\n      if (!this.productId) return;\n      this.addEditData.images.splice(0, this.addEditData.images.length);\n      this.addEditData.list.splice(0, this.addEditData.list.length);\n      this.addEditData.specList.splice(0, this.addEditData.specList.length);\n      getProductDetailFn({ id: this.productId }).then((res) => {\n        const resData = this.resDataFn(res);\n        if (!resData.specInfoList) {\n          resData.specInfoList = [];\n        }\n        if (!resData.skuInfoList) {\n          resData.skuInfoList = [];\n        }\n        if (resData.isExistManySpec == 1 && resData.specInfoList.length > 0) {\n          resData.specInfoList.forEach((item) => {\n            item.value = item.value.split(\",\");\n          });\n        }\n        if (resData.isExistManySpec == 1 && resData.skuInfoList.length > 0) {\n          resData.skuInfoList.forEach((item) => {\n            if (item.skuIndex) {\n              item.skuIndex = item.skuIndex.split(\",\");\n            } else {\n              item.skuIndex = [];\n              if (item.skuName) {\n                item.skuName.split(\",\").forEach((item2, index2) => {\n                  const posIndex =\n                    resData.specInfoList[index2].value.indexOf(item2);\n                  if (posIndex > -1) {\n                    item.skuIndex.push(String(posIndex));\n                  }\n                });\n              }\n            }\n          });\n        }\n        this.addEditData.activityTime =\n          resData.activityStartTime && resData.activityEndTime\n            ? [resData.activityStartTime, resData.activityEndTime]\n            : [];\n        this.addEditData = Object.assign({}, this.addEditData, resData, {\n          // provincePrice:\n          //   resData.type === 3 ? resData.productAgent.proPrice : undefined,\n          // cityPrice:\n          //   resData.type === 3 ? resData.productAgent.cityPrice : undefined,\n          // areaPrice:\n          //   resData.type === 3 ? resData.productAgent.areaPrice : undefined,\n          // dealerPrice:\n          //   resData.type === 3 ? resData.productAgent.dealerPrice : undefined,\n          // provinceThigh:\n          //   resData.type === 3 ? resData.productAgent.proThigh : undefined,\n          // cityThigh:\n          //   resData.type === 3 ? resData.productAgent.cityThigh : undefined,\n          // areaThigh:\n          //   resData.type === 3 ? resData.productAgent.areaThigh : undefined,\n          // dealerThigh:\n          //   resData.type === 3 ? resData.productAgent.dealerThigh : undefined,\n          // provinceBeginNum:\n          //   resData.type === 3 ? resData.productAgent.proNum : undefined,\n          // cityBeginNum:\n          //   resData.type === 3 ? resData.productAgent.cityNum : undefined,\n          // areaBeginNum:\n          //   resData.type === 3 ? resData.productAgent.areaNum : undefined,\n          // dealerBeginNum:\n          //   resData.type === 3 ? resData.productAgent.dealerNum : undefined,\n          // productAgent: undefined,\n          categoryId: resData.categoryIds,\n          images: resData.images.split(\",\"),\n          list:\n            resData.specInfoList && resData.specInfoList.length > 0\n              ? resData.specInfoList\n              : [],\n          specList:\n            resData.skuInfoList && resData.skuInfoList.length > 0\n              ? resData.skuInfoList\n              : [],\n        });\n        this.editLevelData = resData.rewardInfoList;\n        this.levelList.map((item, index) => {\n          if (this.editLevelData[index].levelId === item.id) {\n            this.editLevelData[index].name = item.name;\n          }\n        });\n        // 如果是装机商品 设定分类id 为装机分类的id\n        // if(this.addEditData.type === 3){\n        // \tthis.addEditData.categoryId = this.addEditData.partsId\n        // }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.edit_view {\n  overflow: hidden;\n  padding: 50px 20px;\n  background: #ffffff;\n  .el-form {\n    overflow: hidden;\n    padding: 10px;\n    .el_cascader input {\n      &::placeholder {\n        color: #333;\n      }\n    }\n    .spec_name {\n      input {\n        // background: #303133;\n        // font-weight: bold;\n        // border-color: #303133;\n        // color: #ffffff;\n      }\n    }\n  }\n  .float_item {\n    height: auto;\n    width: 50%;\n    float: left;\n  }\n  .list_table {\n    .el-input__inner {\n      height: 33px;\n    }\n    .el-input__icon {\n      line-height: 33px;\n    }\n    .el-select {\n      margin-right: 10px;\n      margin-bottom: 5px;\n    }\n  }\n  .value_item {\n    float: left;\n    margin-right: 5px;\n    .item {\n      width: 150px;\n      padding: 5px 0;\n      overflow: hidden;\n      .el-input {\n        float: left;\n        width: 100px;\n      }\n    }\n  }\n}\n</style>\n"]}]}