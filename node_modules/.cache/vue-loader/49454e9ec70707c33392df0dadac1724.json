{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\system\\setup-operator\\index.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\system\\setup-operator\\index.vue","mtime":1669258939335},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\@vue\\cli-service\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnVzZXJfaGVhZCB7CiAgd2lkdGg6IDUwcHg7CiAgaGVpZ2h0OiA1MHB4OwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICBib3JkZXItcmFkaXVzOiA1MHB4OwogIG92ZXJmbG93OiBoaWRkZW47CiAgYmFja2dyb3VuZDogI2RkZDsKICAudXBsb2FkIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICAgIGJhY2tncm91bmQ6IHVybCgiLi4vLi4vLi4vYXNzZXRzL3VwbG9hZC5wbmciKSBuby1yZXBlYXQgY2VudGVyIC8gMTAwJSAxMDAlOwogICAgZm9udC1zaXplOiAjZmZmOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgbGluZS1oZWlnaHQ6IDUwcHg7CiAgICBkaXNwbGF5OiBub25lOwogIH0KICAmOmhvdmVyIHsKICAgIC51cGxvYWQgewogICAgICBkaXNwbGF5OiBibG9jazsKICAgIH0KICB9CiAgaW1nIHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/setup-operator","sourcesContent":["<template>\n  <div class=\"content_box\">\n    <first-title title=\"系统操作员管理\" />\n    <div class=\"select_view\">\n      <el-button type=\"primary\" @click=\"addDataFn\"\n        ><i class=\"el-icon-plus\" />添加系统操作员</el-button\n      >\n      <span class=\"mg_l15\" style=\"color: #f56c6c\"\n        >注意：“修改”和“添加”系统操作员项目后需要点击右侧“提交编辑”按钮才会生效哦，登录密码如果不修改可以不填！</span\n      >\n    </div>\n    <el-table\n      v-loading=\"dataConfig.loading\"\n      border\n      :data=\"dataList\"\n      class=\"list\"\n    >\n      <el-table-column label=\"ID\" width=\"50px\">\n        <template slot-scope=\"scope\">\n          <span v-if=\"scope.row.id\">{{ scope.row.id }}</span>\n          <span\n            v-if=\"!scope.row.id\"\n            class=\"delete_icon\"\n            @click=\"deleteAddFn(scope.$index)\"\n            ><i class=\"el-icon-delete\"\n          /></span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"管理员头像\" width=\"100px\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <upload-img\n            width=\"60px\"\n            height=\"60px\"\n            :radius=\"true\"\n            :img=\"scope.row.portrait\"\n            @uploadSuc=\"uploadSucFn($event, scope.$index)\"\n          />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"管理员账号\">\n        <template slot-scope=\"scope\">\n          <el-input\n            v-model=\"scope.row.userAccount\"\n            placeholder=\"请输入用户账号\"\n          />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"角色名称\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.roleId\" placeholder=\"请选择角色名称\">\n            <el-option\n              v-for=\"item in roles\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            />\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"真实姓名\">\n        <template slot-scope=\"scope\">\n          <el-input v-model=\"scope.row.realName\" placeholder=\"请输入真实姓名\" />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"状态(启用/禁用)\" align=\"center\" width=\"140px\">\n        <template slot-scope=\"scope\">\n          <el-switch\n            v-model=\"scope.row.status\"\n            :disabled=\"scope.row.id == undefined\"\n            @change=\"statusChangeFn($event, scope.$index)\"\n          />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"联系电话\">\n        <template slot-scope=\"scope\">\n          <el-input\n            v-model=\"scope.row.telPhone\"\n            maxlength=\"11\"\n            placeholder=\"请输入联系电话\"\n          />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"密码(不填及不修改)\">\n        <template slot-scope=\"scope\">\n          <el-input v-model=\"scope.row.passWord\" placeholder=\"请输入密码\" />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"创建时间\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.createTime }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" width=\"240px\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" size=\"small\" @click=\"editDataFn(scope.row)\"\n            >提交编辑</el-button\n          >\n          <el-button\n            v-if=\"scope.row.id\"\n            type=\"danger\"\n            size=\"small\"\n            @click=\"deleteFn(scope)\"\n            ><i class=\"el-icon-delete\" />删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"el_pagination\">\n      <el-pagination\n        background\n        layout=\"prev, pager, next,total,sizes\"\n        :current-page=\"dataConfig.pageNo\"\n        :total=\"dataConfig.total\"\n        :page-sizes=\"[20, 30, 40, 50]\"\n        @current-change=\"currentChangeFn\"\n        @size-change=\"handleSizeChange\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport uploadImg from \"@/components/uploadImg/upload-img.vue\";\nimport {\n  userListFn,\n  userDetailFn,\n  addOrUpdateFn,\n  removeUserFn,\n  roleListFn,\n  updateStatusFn,\n} from \"@/api/system.js\";\nimport { mapGetters } from \"vuex\";\nimport md5 from \"js-md5\";\nexport default {\n  name: \"SetupOperator\",\n  components: {\n    uploadImg,\n  },\n  data() {\n    return {\n      dataList: [],\n      roles: [],\n      editData: {\n        portrait:\n          \"https://gw.alipayobjects.com/zos/antfincdn/XAosXuNZyF/BiazfanxmamNRoxxVxka.png\",\n        realName: \"\",\n        roleId: \"\",\n        status: true,\n        telPhone: \"\",\n        userAccount: \"\",\n      },\n      dataConfig: {\n        pageNo: 1,\n        pageSize: 20,\n        total: 0,\n        loading: true,\n      },\n    };\n  },\n  beforeMount() {\n    this.roleListFn();\n    this.userListFn();\n  },\n  computed: {\n    ...mapGetters([\"name\"]),\n    apiHost() {\n      return process.env.VUE_APP_BASE_API;\n    },\n  },\n  methods: {\n    roleListFn() {\n      roleListFn({\n        pageNo: 1,\n        pageSize: 100,\n      }).then((res) => {\n        const resData = this.resDataFn(res);\n        this.roles.splice(0, this.roles.length, ...resData.records);\n      });\n    },\n    handleSizeChange(val) {\n      this.dataConfig.pageSize = val;\n      this.userListFn();\n    },\n    currentChangeFn(pageNo) {\n      this.dataConfig.pageNo = pageNo;\n      this.userListFn();\n    },\n    statusChangeFn(val, index) {\n      updateStatusFn({\n        id: this.dataList[index].id,\n        status: val ? 1 : 0,\n      })\n        .then((res) => {\n          if (res.code == \"000\") {\n            this.$message({\n              showClose: true,\n              message: \"操作成功！\",\n              type: \"success\",\n            });\n          }\n          this.userListFn();\n        })\n        .catch(() => {\n          this.dataList[index].status = !val;\n        });\n    },\n    deleteFn(scope) {\n      this.deleteAlert()\n        .then(() => {\n          const resData = removeUserFn({ id: scope.row.id });\n          return resData;\n        })\n        .then((res) => {\n          const resData = this.resDataFn(res);\n          if (resData == \"000\") {\n            this.$message({\n              showClose: true,\n              message: \"操作成功！\",\n              type: \"success\",\n            });\n            this.userListFn();\n          }\n        });\n    },\n    uploadSucFn(img, index) {\n      this.$set(\n        this.dataList,\n        index,\n        Object.assign({}, this.dataList[index], { portrait: img })\n      );\n    },\n    editDataFn(val) {\n      const reg = /^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\\d{8}$/;\n      if (val.telPhone.length != 11) {\n        this.$message({\n          showClose: true,\n          message: \"请输入11位手机号！\",\n          type: \"warning\",\n        });\n        return;\n      } else if (!reg.test(val.telPhone)) {\n        this.$message({\n          showClose: true,\n          message: \"请输入正确的手机号！\",\n          type: \"warning\",\n        });\n        return;\n      }\n      addOrUpdateFn({\n        id: val.id,\n        portrait: val.portrait,\n        realName: val.realName,\n        roleId: val.roleId,\n        telPhone: val.telPhone,\n        passWord: val.passWord ? md5(val.passWord) : undefined,\n        userAccount: val.userAccount,\n      }).then((res) => {\n        const resData = this.resDataFn(res);\n        if (resData == \"000\") {\n          this.$message({\n            showClose: true,\n            message: \"操作成功！\",\n            type: \"success\",\n          });\n          this.userListFn();\n        }\n      });\n    },\n    addDataFn() {\n      this.dataList.unshift(Object.assign({}, this.editData));\n    },\n    deleteAddFn(index) {\n      this.dataList.splice(index, 1);\n    },\n    userDetailFn() {\n      this.dataList.forEach((item, index) => {\n        if (item.id) {\n          userDetailFn({ id: item.id }).then((res) => {\n            const resData = this.resDataFn(res);\n            this.$set(\n              this.dataList,\n              index,\n              Object.assign({}, item, {\n                roleId: resData.roleId || 1,\n              })\n            );\n          });\n        }\n      });\n    },\n    userListFn() {\n      userListFn({\n        pageNo: this.dataConfig.pageNo,\n        pageSize: this.dataConfig.pageSize,\n      }).then((res) => {\n        const resData = this.resDataFn(res);\n        resData.records.forEach((item) => {\n          item.status = item.status == 1;\n        });\n        this.dataList.splice(0, this.dataList.length, ...resData.records);\n        this.dataConfig.total = resData.total;\n        this.userDetailFn();\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.user_head {\n  width: 50px;\n  height: 50px;\n  position: relative;\n  border-radius: 50px;\n  overflow: hidden;\n  background: #ddd;\n  .upload {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    background: url(\"../../../assets/upload.png\") no-repeat center / 100% 100%;\n    font-size: #fff;\n    text-align: center;\n    line-height: 50px;\n    display: none;\n  }\n  &:hover {\n    .upload {\n      display: block;\n    }\n  }\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n"]}]}