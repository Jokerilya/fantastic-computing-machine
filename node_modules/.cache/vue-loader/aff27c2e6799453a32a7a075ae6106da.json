{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\customerManagement.vue?vue&type=style&index=0&id=63ec0957&scoped=true&lang=less&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\customerManagement.vue","mtime":1697165889544},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\@vue\\cli-service\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\style-resources-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmN1c3RvbWVyTWFuYWdlbWVudCB7DQogIHBhZGRpbmc6IDIwcHg7DQogIC50b3BUb29sIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgLnRvb2xJbnB1dCB7DQogICAgICB3aWR0aDogMTcwcHg7DQogICAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7DQogICAgfQ0KICAgIC50b29sQnRuIHsNCiAgICAgIGNvbG9yOiAjMmU0YzllOw0KICAgIH0NCiAgfQ0KICAudGFibGVDb250ZW50X2Zvb3RlciB7DQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIGhlaWdodDogNTBweDsNCiAgfQ0KDQogIC5jdXN0b21lck1hbmFnZW1lbnRsTGlzdCB7DQogICAgcGFkZGluZzogMjBweDsNCiAgfQ0KDQogIC5yZWNvcmRMaW5lIHsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIC5sYWJlbCB7DQogICAgICBmb250LXdlaWdodDogNzAwOw0KICAgICAgd2lkdGg6IDkwcHg7DQogICAgfQ0KICAgIC5jb250ZW50IHsNCiAgICAgIGZsZXg6IDE7DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["customerManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"customerManagement.vue","sourceRoot":"src/views/maintenance","sourcesContent":["<template>\r\n  <!-- 业务人员 -->\r\n  <div class=\"customerManagement\">\r\n    <!-- 顶部工具栏 -->\r\n    <div class=\"topTool\">\r\n      <el-input\r\n        placeholder=\"请输入公司名称\"\r\n        class=\"toolInput\"\r\n        v-model=\"enterpriseName\"\r\n      ></el-input>\r\n      <el-button class=\"toolBtn\" @click=\"searchFn\">查询</el-button>\r\n      <el-button class=\"toolBtn\" @click=\"resetSearch\">重置</el-button>\r\n    </div>\r\n\r\n    <el-card>\r\n      <div class=\"customerManagementlList\">\r\n        <el-table\r\n          :cell-style=\"{ 'text-align': 'center' }\"\r\n          :data=\"customerPoolList\"\r\n          style=\"width: 100%\"\r\n          :header-cell-style=\"{\r\n            background: '#f6f8fc',\r\n            color: '#707070',\r\n            'text-align': 'center',\r\n          }\"\r\n        >\r\n          <el-table-column label=\"创建时间\" prop=\"createTime\"></el-table-column>\r\n          <el-table-column\r\n            label=\"公司名称\"\r\n            prop=\"enterpriseName\"\r\n          ></el-table-column>\r\n          <el-table-column\r\n            label=\"设备台数\"\r\n            prop=\"deviceScale\"\r\n          ></el-table-column>\r\n          <el-table-column label=\"设备类型\">\r\n            <template slot-scope=\"{ row }\">\r\n              {{ row.deviceTypeIds }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            label=\"联系人员\"\r\n            prop=\"maintenancePeople\"\r\n          ></el-table-column>\r\n          <el-table-column\r\n            label=\"联系电话\"\r\n            prop=\"maintenancePhone\"\r\n          ></el-table-column>\r\n          <el-table-column label=\"状态\">\r\n            <template slot-scope=\"{ row }\">\r\n              {{\r\n                row.status === 0\r\n                  ? \"已释放\"\r\n                  : row.status === 1\r\n                  ? \"跟进中\"\r\n                  : \"已签约\"\r\n              }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\">\r\n            <template slot-scope=\"{ row }\">\r\n              <el-button type=\"text\" @click=\"openRecordDialog(row.id)\"\r\n                >跟进记录</el-button\r\n              >\r\n              <el-button type=\"text\" @click=\"openAuditDialog(row.id)\"\r\n                >申请记录</el-button\r\n              >\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n\r\n      <div class=\"tableContent_footer\">\r\n        <el-pagination\r\n          @current-change=\"currentChangeFn\"\r\n          layout=\"jumper, prev, pager, next,total \"\r\n          :total=\"total\"\r\n          :page-size=\"pageSize\"\r\n        >\r\n        </el-pagination>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 跟进记录框 -->\r\n    <el-dialog\r\n      title=\"跟进记录\"\r\n      width=\"30%\"\r\n      :visible=\"recordDialog\"\r\n      :before-close=\"closeRecordDialog\"\r\n      :close-on-click-modal=\"false\"\r\n      center\r\n    >\r\n      <div style=\"height: 55vh;overflow: auto;\">\r\n        <el-collapse accordion>\r\n          <el-collapse-item\r\n            v-for=\"(item, index) in customerVisitList\"\r\n            :key=\"index\"\r\n          >\r\n            <template slot=\"title\">\r\n              {{ \"第\" + (index + 1) + \"次跟进记录\" }}\r\n            </template>\r\n            <div class=\"recordLine\">\r\n              <div class=\"label\">\r\n                沟通内容:\r\n              </div>\r\n              <div class=\"content\">\r\n                {{ item.content }}\r\n              </div>\r\n            </div>\r\n            <div class=\"recordLine\">\r\n              <div class=\"label\">\r\n                客户意向:\r\n              </div>\r\n              <div class=\"content\">\r\n                {{ item.intention }}\r\n              </div>\r\n            </div>\r\n            <div class=\"recordLine\">\r\n              <div class=\"label\">\r\n                签约状态:\r\n              </div>\r\n              <div class=\"content\">\r\n                {{ item.status === 0 ? \"未签约\" : \"已签约\" }}\r\n              </div>\r\n            </div>\r\n            <div class=\"recordLine\">\r\n              <div class=\"label\">\r\n                拜访时间:\r\n              </div>\r\n              <div class=\"content\">\r\n                {{ item.createTime }}\r\n              </div>\r\n            </div>\r\n          </el-collapse-item>\r\n        </el-collapse>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- 跟进审核框 -->\r\n    <el-dialog\r\n      title=\"申请记录\"\r\n      width=\"50%\"\r\n      :visible=\"auditDialog\"\r\n      :before-close=\"closeAuditDialog\"\r\n      :close-on-click-modal=\"false\"\r\n      center\r\n    >\r\n      <div style=\"height: 55vh;overflow: auto;\">\r\n        <el-table\r\n          :data=\"customerApplyVisitList\"\r\n          :cell-style=\"{ 'text-align': 'center' }\"\r\n          :header-cell-style=\"{\r\n            background: '#f6f8fc',\r\n            color: '#707070',\r\n            'text-align': 'center',\r\n          }\"\r\n        >\r\n          <el-table-column label=\"申请时间\" prop=\"createTime\"></el-table-column>\r\n          <el-table-column label=\"业务员名称\" prop=\"realName\"></el-table-column>\r\n          <el-table-column label=\"业务员电话\" prop=\"phone\"></el-table-column>\r\n          <el-table-column label=\"操作\">\r\n            <template slot-scope=\"{ row }\">\r\n              <el-button\r\n                v-if=\"row.status === 0\"\r\n                type=\"text\"\r\n                @click=\"openChooseAuditDialog(row.id)\"\r\n                >操作</el-button\r\n              >\r\n              <div v-else>{{ row.status === 1 ? \"已通过\" : \"已驳回\" }}</div>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <el-dialog\r\n      title=\"审核请求\"\r\n      width=\"30%\"\r\n      :visible=\"chooseAuditVisible\"\r\n      center\r\n      :before-close=\"closeChooseAuditDialog\"\r\n    >\r\n      <div style=\"display: flex;justify-content: center;\">\r\n        <el-select v-model=\"statusValue\" placeholder=\"请选择\">\r\n          <el-option label=\"同意\" :value=\"1\"></el-option>\r\n          <el-option label=\"驳回\" :value=\"2\"> </el-option>\r\n        </el-select>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"closeChooseAuditDialog\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"comfirmBtn\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  queryCustomerPool,\r\n  queryCustomerVisitList,\r\n  queryCustomerApplyVisitList,\r\n  handleCustomerApplyVisit,\r\n} from \"@/api/user\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      copyId: null,\r\n\r\n      statusValue: null,\r\n      chooseAuditVisible: false,\r\n      customerApplyVisitId: null,\r\n      customerVisitList: [],\r\n      customerPoolList: [],\r\n      customerApplyVisitList: [],\r\n      recordDialog: false,\r\n      auditDialog: false,\r\n      chooseId: null,\r\n      pageNo: 1,\r\n      pageSize: 8,\r\n      total: 0,\r\n      enterpriseName: null,\r\n    };\r\n  },\r\n  methods: {\r\n    // 搜索框\r\n    searchFn() {\r\n      this.pageNo = 1;\r\n      this.queryCustomerPool();\r\n    },\r\n    // 重置搜索\r\n    resetSearch() {\r\n      this.enterpriseName = null;\r\n      this.queryCustomerPool();\r\n    },\r\n    // 点击页码触发\r\n    currentChangeFn(page) {\r\n      this.pageNo = page;\r\n      this.queryCustomerPool(this.customerApplyVisitId);\r\n    },\r\n    // 确定客户的申请\r\n    async comfirmBtn() {\r\n      const res = await handleCustomerApplyVisit({\r\n        id: this.customerApplyVisitId,\r\n        status: this.statusValue,\r\n      });\r\n      if (res.message === \"操作成功\") {\r\n        this.closeChooseAuditDialog();\r\n        this.openAuditDialog(this.copyId);\r\n      }\r\n    },\r\n    /* 关闭 */\r\n    closeChooseAuditDialog() {\r\n      this.statusValue = null;\r\n      this.chooseAuditVisible = false;\r\n    },\r\n    // 打开选择审核申请框\r\n    openChooseAuditDialog(id) {\r\n      this.customerApplyVisitId = id;\r\n      this.chooseAuditVisible = true;\r\n    },\r\n    // // 转换类型的JSON格式\r\n    // changDeviceTypeIds(deviceTypeIds) {\r\n    //   let str = \"\";\r\n    //   console.log(264, deviceTypeIds);\r\n    //   if (deviceTypeIds) {\r\n    //     let arr = JSON.parse(deviceTypeIds);\r\n    //     arr.forEach((item) => {\r\n    //       str += item + \" \";\r\n    //     });\r\n    //   }\r\n    //   return str == \"\" ? \"暂无\" : str;\r\n    // },\r\n    // 获取客户池\r\n    async queryCustomerPool() {\r\n      const res = await queryCustomerPool({\r\n        pageNo: this.pageNo,\r\n        pageSize: this.pageSize,\r\n        enterpriseName: this.enterpriseName,\r\n      });\r\n      this.total = res.data.total;\r\n      this.customerPoolList = res.data.records;\r\n    },\r\n    // 关闭跟进记录框\r\n    closeAuditDialog() {\r\n      this.auditDialog = false;\r\n    },\r\n    //打开跟进审核框\r\n    async openAuditDialog(id) {\r\n      this.copyId = id;\r\n      this.customerApplyVisitId = id;\r\n      const res = await queryCustomerApplyVisitList({\r\n        customerId: id,\r\n        pageNo: 1,\r\n        pageSize: 999,\r\n      });\r\n      this.customerApplyVisitList = res.data.records;\r\n      this.auditDialog = true;\r\n    },\r\n    // 关闭跟进记录框\r\n    closeRecordDialog() {\r\n      this.recordDialog = false;\r\n    },\r\n    // 打开跟进记录框\r\n    async openRecordDialog(id) {\r\n      const res = await queryCustomerVisitList({\r\n        customerId: id,\r\n        pageNo: 1,\r\n        pageSize: 999,\r\n      });\r\n      this.customerVisitList = res.data.records;\r\n      this.recordDialog = true;\r\n    },\r\n  },\r\n  created() {\r\n    this.queryCustomerPool();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.customerManagement {\r\n  padding: 20px;\r\n  .topTool {\r\n    display: flex;\r\n    margin-bottom: 20px;\r\n    .toolInput {\r\n      width: 170px;\r\n      margin-right: 10px;\r\n    }\r\n    .toolBtn {\r\n      color: #2e4c9e;\r\n    }\r\n  }\r\n  .tableContent_footer {\r\n    text-align: center;\r\n    height: 50px;\r\n  }\r\n\r\n  .customerManagementlList {\r\n    padding: 20px;\r\n  }\r\n\r\n  .recordLine {\r\n    display: flex;\r\n    .label {\r\n      font-weight: 700;\r\n      width: 90px;\r\n    }\r\n    .content {\r\n      flex: 1;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}