{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\worker\\components\\editWorker.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\worker\\components\\editWorker.vue","mtime":1673596697092},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\@vue\\cli-service\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\style-resources-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5jb250ZW50IHsNCiAgLm9uZUxpbmUgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgICAuaXRlbSB7DQogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICBmbGV4OiAxOw0KICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgICBwYWRkaW5nOiAwIDIwcHggMCAxMHB4Ow0KICAgICAgLmxhYmVsIHsNCiAgICAgICAgY29sb3I6ICMxZjFmMWY7DQogICAgICAgIGZvbnQtc2l6ZTogMTVweDsNCiAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsNCiAgICAgIH0NCiAgICAgIC5pbnAgew0KICAgICAgICB3aWR0aDogMjAwcHg7DQogICAgICB9DQogICAgICAubG9jYXRpb24gew0KICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgcmlnaHQ6IDEzcHg7DQogICAgICAgIGJvdHRvbTogOXB4Ow0KICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBvcmFuZ2U7DQogICAgICAgIGNvbG9yOiAjZmZmOw0KICAgICAgICB3aWR0aDogMjBweDsNCiAgICAgICAgaGVpZ2h0OiAyMHB4Ow0KICAgICAgICBib3JkZXItcmFkaXVzOiAxMHB4Ow0KICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgIGxpbmUtaGVpZ2h0OiAyMHB4Ow0KICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgLmltZ0xpbmUgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgaGVpZ2h0OiAxODBweDsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIC5pbWdJdGVtIHsNCiAgICAgIGZsZXg6IDE7DQogICAgICBwYWRkaW5nOiAwIDVweDsNCiAgICAgIC50aXRsZSB7DQogICAgICAgIGNvbG9yOiAjMWYxZjFmOw0KICAgICAgICBmb250LXNpemU6IDE1cHg7DQogICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQogICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgICB9DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["editWorker.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editWorker.vue","sourceRoot":"src/views/maintenance/worker/components","sourcesContent":["<template>\r\n  <div v-if=\"dialogForm\">\r\n    <el-dialog\r\n      title=\"编辑师傅\"\r\n      :visible=\"dialogVisible\"\r\n      width=\"1000px\"\r\n      :before-close=\"closeFn\"\r\n    >\r\n      <div class=\"content\">\r\n        <div class=\"oneLine\">\r\n          <div class=\"item\">\r\n            <div class=\"label\">姓名</div>\r\n            <el-input class=\"inp\" v-model=\"dialogForm.realName\"></el-input>\r\n          </div>\r\n          <div class=\"item\">\r\n            <span class=\"label\">身份证</span\r\n            ><el-input\r\n              class=\"inp\"\r\n              v-model=\"dialogForm.identityNumber\"\r\n            ></el-input>\r\n          </div>\r\n          <div class=\"item\">\r\n            <span class=\"label\">行业经验</span\r\n            ><el-input\r\n              class=\"inp\"\r\n              v-model=\"dialogForm.industryExperience\"\r\n            ></el-input>\r\n          </div>\r\n        </div>\r\n        <div class=\"oneLine\">\r\n          <div class=\"item\">\r\n            <span class=\"label\">推荐人</span>\r\n            <el-select\r\n              filterable\r\n              :remote-method=\"remoteMethod\"\r\n              remote\r\n              v-model=\"dialogForm.recommendMasterRealName\"\r\n              placeholder=\"请选择\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in options\"\r\n                :key=\"item.value\"\r\n                :label=\"item.realName\"\r\n                :value=\"item.realName\"\r\n              >\r\n              </el-option>\r\n            </el-select>\r\n          </div>\r\n          <div class=\"item\">\r\n            <span class=\"label\" style=\"margin-right: 20px;\">服务部位</span>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              :content=\"dialogForm.servePosition\"\r\n              placement=\"top\"\r\n            >\r\n              <el-input\r\n                style=\"width: 200px;\"\r\n                class=\"inp\"\r\n                v-if=\"servePositionShow\"\r\n                :disabled=\"true\"\r\n                :value=\"servePosition\"\r\n              >\r\n              </el-input>\r\n            </el-tooltip>\r\n\r\n            <div\r\n              class=\"location\"\r\n              @click=\"locationXiuFn(1)\"\r\n              v-if=\"servePositionShow\"\r\n            >\r\n              修\r\n            </div>\r\n            <el-select\r\n              collapse-tags\r\n              class=\"inp\"\r\n              v-model=\"dialogForm.servePosition\"\r\n              multiple\r\n              v-if=\"!servePositionShow\"\r\n              placeholder=\"请选择\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in PartsList\"\r\n                :key=\"PartsList.name\"\r\n                :label=\"item.name\"\r\n                :value=\"item.name\"\r\n              ></el-option>\r\n            </el-select>\r\n          </div>\r\n          <div class=\"item\">\r\n            <span class=\"label\" style=\"margin-right: 20px;\">服务地区</span>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              :content=\"dialogForm.serviceAreasName\"\r\n              placement=\"top\"\r\n            >\r\n              <el-input\r\n                style=\"width: 200px;\"\r\n                v-if=\"serviceAreasShow\"\r\n                class=\"inp\"\r\n                :disabled=\"true\"\r\n                v-model=\"dialogForm.serviceAreasName\"\r\n              >\r\n              </el-input>\r\n            </el-tooltip>\r\n            <div\r\n              class=\"location\"\r\n              @click=\"locationXiuFn(2)\"\r\n              v-if=\"serviceAreasShow\"\r\n            >\r\n              修\r\n            </div>\r\n            <el-cascader\r\n              v-if=\"!serviceAreasShow\"\r\n              v-model=\"dialogForm.serviceAreas\"\r\n              collapse-tags\r\n              class=\"inp\"\r\n              :props=\"props1\"\r\n              :show-all-levels=\"false\"\r\n            ></el-cascader>\r\n          </div>\r\n        </div>\r\n        <div class=\"oneLine\">\r\n          <div class=\"item\">\r\n            <div class=\"label\" style=\"width: 100px;\">服务类型</div>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              :content=\"dialogForm.serviceTypesName\"\r\n              placement=\"top\"\r\n            >\r\n              <el-input\r\n                style=\"width: 200px;\"\r\n                :disabled=\"true\"\r\n                v-model=\"dialogForm.serviceTypesName\"\r\n                v-if=\"serviceTypesNameShow\"\r\n              ></el-input>\r\n            </el-tooltip>\r\n            <div\r\n              class=\"location\"\r\n              @click=\"locationXiuFn(3)\"\r\n              v-if=\"serviceTypesNameShow\"\r\n            >\r\n              修\r\n            </div>\r\n            <el-cascader\r\n              v-if=\"!serviceTypesNameShow\"\r\n              class=\"inp\"\r\n              :show-all-levels=\"false\"\r\n              v-model=\"dialogForm.serviceTypes\"\r\n              :options=\"typeList\"\r\n              :props=\"{\r\n                checkStrictly: true,\r\n                emitPath: false,\r\n                value: 'id',\r\n                label: 'name',\r\n                multiple: true,\r\n                children: 'list',\r\n              }\"\r\n              collapse-tags\r\n              clearable\r\n            ></el-cascader>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"label\" style=\"width: 100px;\">师傅编号</div>\r\n            <el-input\r\n              class=\"inp\"\r\n              v-model=\"dialogForm.number\"\r\n              @input=\"blurWorkerNum\"\r\n            ></el-input>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"label\" style=\"width: 100px;\">虚拟服务数量</div>\r\n            <el-input\r\n              class=\"inp\"\r\n              v-model=\"dialogForm.virtualServiceNum\"\r\n            ></el-input>\r\n          </div>\r\n        </div>\r\n        <div class=\"imgLine\">\r\n          <div class=\"imgItem\">\r\n            <div class=\"title\">真实头像</div>\r\n            <el-upload\r\n              style=\"width: 50%;\"\r\n              :file-list=\"avatarFileList\"\r\n              :limit=\"1\"\r\n              action=\"#\"\r\n              :http-request=\"avatarUploadFn\"\r\n              accept=\".jpg,.png\"\r\n              list-type=\"picture-card\"\r\n            >\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n          </div>\r\n          <div class=\"imgItem\">\r\n            <div class=\"title\">身份证正面照</div>\r\n            <el-upload\r\n              style=\"width: 50%;\"\r\n              :file-list=\"idJustFileList\"\r\n              :limit=\"1\"\r\n              action=\"#\"\r\n              accept=\".jpg,.png\"\r\n              :http-request=\"idJustUploadFn\"\r\n              list-type=\"picture-card\"\r\n            >\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n          </div>\r\n          <div class=\"imgItem\">\r\n            <div class=\"title\">身份证反面照</div>\r\n            <el-upload\r\n              style=\"width: 50%;\"\r\n              :file-list=\"idBackFileList\"\r\n              :http-request=\"idBackUploadFn\"\r\n              accept=\".jpg,.png\"\r\n              :limit=\"1\"\r\n              action=\"#\"\r\n              list-type=\"picture-card\"\r\n            >\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"closeFn\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmFn\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addressFn, UploadImg } from \"@/api/system\";\r\nimport {\r\n  editMasterInfo,\r\n  queryDevicePositionList,\r\n  queryDeviceTypeList,\r\n  queryMasterName,\r\n} from \"@/api/order\";\r\n\r\nexport default {\r\n  props: {\r\n    dialogVisible: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      options: [],\r\n      value: \"\",\r\n\r\n      serviceAreasShow: true, //默认地区输入框显示\r\n      serviceTypesNameShow: true,\r\n      servePositionShow: true,\r\n\r\n      servePosition: null,\r\n      typeList: null,\r\n      PartsList: null,\r\n\r\n      dialogForm: null,\r\n      avatarFileList: [],\r\n      idJustFileList: [],\r\n      idBackFileList: [],\r\n\r\n      props1: {\r\n        checkStrictly: true,\r\n        value: \"id\",\r\n        label: \"name\",\r\n        multiple: true,\r\n        lazy: true,\r\n        emitPath: false,\r\n        lazyLoad: async (node, resolve) => {\r\n          let pid = 0;\r\n          if (node.level != 0) {\r\n            pid = node.data.id;\r\n          }\r\n          if (node.level > 2) {\r\n            resolve([]);\r\n            return;\r\n          }\r\n          let res = await addressFn(pid);\r\n          if (res.code == \"000\")\r\n            resolve(\r\n              res.data.map((item) => {\r\n                return {\r\n                  ...item,\r\n                };\r\n              })\r\n            );\r\n        },\r\n      },\r\n    };\r\n  },\r\n  async created() {\r\n    const res = await queryDevicePositionList();\r\n    this.PartsList = res.data;\r\n    const res1 = await queryDeviceTypeList();\r\n    this.typeList = res1.data;\r\n  },\r\n  methods: {\r\n    // 判断师傅编号是否为数字或字母\r\n    blurWorkerNum() {\r\n      this.dialogForm.number = this.dialogForm.number.replace(/[^\\w\\/]/gi, \"\");\r\n    },\r\n    // 搜索推荐人\r\n    async remoteMethod(query) {\r\n      const res = await queryMasterName(query);\r\n      this.options = res.data;\r\n    },\r\n\r\n    // 改造数据方案\r\n    repairData(arr) {\r\n      let str = null;\r\n      if (Array.isArray(arr)) {\r\n        arr.forEach((el, index) => {\r\n          if (index === 0) {\r\n            str = \"\" + el;\r\n          } else {\r\n            str = str + \",\" + el;\r\n          }\r\n        });\r\n      }\r\n      return str;\r\n    },\r\n\r\n    // 修改服务地区的事件\r\n    locationXiuFn(index) {\r\n      if (index === 2) {\r\n        this.serviceAreasShow = false;\r\n      } else if (index === 3) {\r\n        this.serviceTypesNameShow = false;\r\n      } else {\r\n        this.servePositionShow = false;\r\n      }\r\n    },\r\n\r\n    // 确定的事件\r\n    async confirmFn() {\r\n      // 师傅名字找到对于uid\r\n      if (this.dialogForm.recommendMasterRealName) {\r\n        const res = await queryMasterName(\r\n          this.dialogForm.recommendMasterRealName\r\n        );\r\n        this.dialogForm.recommendMasterUid = res.data[0].uid;\r\n      } else {\r\n        this.dialogForm.recommendMasterUid = \"\";\r\n      }\r\n\r\n      // 服务部位\r\n      if (\r\n        this.dialogForm.servePosition &&\r\n        this.dialogForm.servePosition.length > 1\r\n      ) {\r\n        this.dialogForm.servePosition = await this.repairData(\r\n          this.dialogForm.servePosition\r\n        );\r\n      } else if (\r\n        this.dialogForm.servePosition &&\r\n        this.dialogForm.servePosition.length === 0\r\n      ) {\r\n        this.dialogForm.servePosition = \"\";\r\n      }\r\n\r\n      // 改造一下服务地区的数据\r\n      if (this.serviceAreasShow === false) {\r\n        this.dialogForm.serviceAreas = await this.repairData(\r\n          this.dialogForm.serviceAreas\r\n        );\r\n      }\r\n\r\n      // 改造一下服务类型的数据\r\n      if (this.serviceTypesNameShow === false) {\r\n        this.dialogForm.serviceTypes = await this.repairData(\r\n          this.dialogForm.serviceTypes\r\n        );\r\n      }\r\n\r\n      const res = await editMasterInfo(this.dialogForm);\r\n      if (res.message === \"操作成功\") {\r\n        this.$message({\r\n          message: \"编辑成功\",\r\n          type: \"success\",\r\n        });\r\n        this.closeFn();\r\n      }\r\n    },\r\n    // 上传触发的事件\r\n    async idBackUploadFn(data) {\r\n      const loading = this.$loading({\r\n        text: \"上传图片中,请耐心等待...\",\r\n      });\r\n      const formData = new FormData();\r\n      formData.append(\"file\", data.file);\r\n      const res = await UploadImg(formData);\r\n      this.dialogForm.identityBackImage = res.data;\r\n      loading.close();\r\n    },\r\n    // 上传触发的事件\r\n    async idJustUploadFn(data) {\r\n      const loading = this.$loading({\r\n        text: \"上传图片中,请耐心等待...\",\r\n      });\r\n      const formData = new FormData();\r\n      formData.append(\"file\", data.file);\r\n      const res = await UploadImg(formData);\r\n      this.dialogForm.identityFrontImage = res.data;\r\n      loading.close();\r\n    },\r\n    // 上传触发的事件\r\n    async avatarUploadFn(data) {\r\n      const loading = this.$loading({\r\n        text: \"上传图片中,请耐心等待...\",\r\n      });\r\n      const formData = new FormData();\r\n      formData.append(\"file\", data.file);\r\n      const res = await UploadImg(formData);\r\n      this.dialogForm.realPortrait = res.data;\r\n      loading.close();\r\n    },\r\n    // 关闭事件\r\n    closeFn() {\r\n      this.servePositionShow = true;\r\n      this.serviceAreasShow = true;\r\n      this.serviceTypesNameShow = true;\r\n      this.dialogForm = null;\r\n      this.avatarFileList = [];\r\n      this.idJustFileList = [];\r\n      this.idBackFileList = [];\r\n      this.$emit(\"closeFn\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.content {\r\n  .oneLine {\r\n    display: flex;\r\n    margin-bottom: 20px;\r\n    .item {\r\n      position: relative;\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      padding: 0 20px 0 10px;\r\n      .label {\r\n        color: #1f1f1f;\r\n        font-size: 15px;\r\n        font-weight: 700;\r\n      }\r\n      .inp {\r\n        width: 200px;\r\n      }\r\n      .location {\r\n        cursor: pointer;\r\n        position: absolute;\r\n        right: 13px;\r\n        bottom: 9px;\r\n        background-color: orange;\r\n        color: #fff;\r\n        width: 20px;\r\n        height: 20px;\r\n        border-radius: 10px;\r\n        font-size: 12px;\r\n        line-height: 20px;\r\n        text-align: center;\r\n      }\r\n    }\r\n  }\r\n\r\n  .imgLine {\r\n    display: flex;\r\n    height: 180px;\r\n    overflow: hidden;\r\n    .imgItem {\r\n      flex: 1;\r\n      padding: 0 5px;\r\n      .title {\r\n        color: #1f1f1f;\r\n        font-size: 15px;\r\n        margin-bottom: 10px;\r\n        font-weight: 700;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}