{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\product\\product-detail\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\product\\product-detail\\index.vue","mtime":1669258939322},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB1cGxvYWRJbWcgZnJvbSAiQC9jb21wb25lbnRzL3VwbG9hZEltZy91cGxvYWQtaW1nLnZ1ZSI7CmltcG9ydCB1cGxvYWRJbWdzIGZyb20gIkAvY29tcG9uZW50cy91cGxvYWRJbWdzL3VwbG9hZC1pbWdzLnZ1ZSI7CmltcG9ydCBUaW55bWNlIGZyb20gIkAvY29tcG9uZW50cy9UaW55bWNlIjsKaW1wb3J0IHsKICBnZXRQcm9kdWN0RGV0YWlsRm4sCiAgcXVlcnlQcm9kdWN0Q2F0ZWdvcnlGbiwKICBlZGl0UHJvZHVjdEZuLAogIHF1ZXJ5UHJvZHVjdEZpdHRpbmdDYXRlZ29yeUZuLAogIHF1ZXJ5U3VwcGxpZXJMaXN0LAp9IGZyb20gIkAvYXBpL3Byb2R1Y3QuanMiOwppbXBvcnQgeyBxdWVyeUV4cFJ1bGVGbiB9IGZyb20gIkAvYXBpL3N5c3RlbS5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUHJvZHVjdExpc3QiLAogIGNvbXBvbmVudHM6IHsKICAgIFRpbnltY2UsCiAgICB1cGxvYWRJbWcsCiAgICB1cGxvYWRJbWdzLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhZ2VObzogMCwKICAgICAgcGFnZVNpemU6IDAsCiAgICAgIHN1Ym1pdEluZzogZmFsc2UsCiAgICAgIHByb2R1Y3RJZDogIiIsCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBlZGl0QWRkVmFsSXRlbTogW10sCiAgICAgIHR5cGVzOiBbCiAgICAgICAgeyBuYW1lOiAi5LyY6YCJ5ZWG5ZOBIiwgdmFsOiAxIH0sCiAgICAgICAgeyBuYW1lOiAi5ou85Zui5Lqn5ZOBIiwgdmFsOiAyIH0sCiAgICAgICAgeyBuYW1lOiAi6YWN5Lu2IiwgdmFsOiAzIH0sCiAgICAgICAgeyBuYW1lOiAi5py65Lu2IiwgdmFsOiA0IH0sCiAgICAgIF0sCiAgICAgIGlzU2hlbHZlczogWwogICAgICAgIHsgbmFtZTogIuS4iuaetiIsIHZhbDogMSB9LAogICAgICAgIHsgbmFtZTogIuS4i+aetiIsIHZhbDogMCB9LAogICAgICBdLAogICAgICBpc0V4aXN0TWFueVNwZWM6IFsKICAgICAgICB7IG5hbWU6ICLmmK8iLCB2YWw6IDEgfSwKICAgICAgICB7IG5hbWU6ICLlkKYiLCB2YWw6IDAgfSwKICAgICAgXSwKICAgICAgYWRkRWRpdERhdGE6IHsKICAgICAgICBleHBJZDogIiIsCiAgICAgICAgY2F0ZWdvcnlJZDogIiIsCiAgICAgICAgY29udGVudDogIiIsCiAgICAgICAgY292ZXJJbWFnZTogIiIsCiAgICAgICAgYmFja0ltYWdlOiAiIiwKICAgICAgICBpZDogIiIsCiAgICAgICAgaW1hZ2VzOiBbXSwKICAgICAgICBpbnZlbnRvcnk6ICIiLAogICAgICAgIGlzRXhpc3RNYW55U3BlYzogIiIsCiAgICAgICAgaXNTaGVsdmVzOiAiIiwKICAgICAgICBtb2RlOiAiIiwKICAgICAgICBwcmljZTogMCwKICAgICAgICBzaW1wbGVEZXNjOiAiIiwKICAgICAgICBsaXN0OiBbXSwKICAgICAgICBzcGVjTGlzdDogW10sCiAgICAgICAgdGl0bGU6ICIiLAogICAgICAgIHR5cGU6ICIiLAogICAgICAgIC8vIHBhcnRzSWQ6JycsCiAgICAgICAgc3VwcGxpZXJJZDogIiIsCiAgICAgICAgLy8gZ3JvdXBIb3VyczoxLAogICAgICAgIGdyb3VwTnVtOiAxLAogICAgICAgIGFjdGl2aXR5VGltZTogW10sCiAgICAgICAgYWN0aXZpdHlTdGFydFRpbWU6ICIiLAogICAgICAgIGFjdGl2aXR5RW5kVGltZTogIiIsCiAgICAgICAgbGFzdEludmVudG9yeTonJywKICAgICAgICBvcmlnaW5hbFByaWNlOicnCiAgICAgIH0sCiAgICAgIHN1cHBsaWVyTGlzdDogW10sIC8vIOS+m+W6lOWVhuWIl+ihqAogICAgICBlZGl0TGV2ZWxEYXRhOiBbXSwKICAgICAgZXhwTGlzdDogW10sCiAgICAgIGJhdGNoRGF0YTogewogICAgICAgIHNwZWNJbWFnZTogIiIsCiAgICAgICAgcHJpY2U6IDAsCiAgICAgICAgb3JpZ2luYWxQcmljZTogMCwKICAgICAgICBpbnZlbnRvcnk6IDAsCiAgICAgIH0sCiAgICAgIHJlc3VsdHM6IFtdLAogICAgICByZXN1bHQ6IFtdLAogICAgICBsZXZlbExpc3Q6IFtdLAogICAgICBjYXRlZ29yeUxpc3Q6IHsKICAgICAgICBsYXp5OiB0cnVlLAogICAgICAgIGNoZWNrU3RyaWN0bHk6IHRydWUsCiAgICAgICAgbGF6eUxvYWQobm9kZSwgcmVzb2x2ZSkgewogICAgICAgICAgcXVlcnlQcm9kdWN0Q2F0ZWdvcnlGbih7IHBpZDogbm9kZS52YWx1ZSB8fCAwIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7CiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gcmVzRGF0YS5tYXAoKGl0ZW0pID0+ICh7CiAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0uaWQsCiAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAvLyDpgJrov4fosIPnlKhyZXNvbHZl5bCG5a2Q6IqC54K55pWw5o2u6L+U5Zue77yM6YCa55+l57uE5Lu25pWw5o2u5Yqg6L295a6M5oiQCiAgICAgICAgICAgIHJlc29sdmUobm9kZXMpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgfSwKICAgICAgY2F0ZWdvcnlQYXJ0c0xpc3Q6IFtdLAogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLnByb2R1Y3RJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOwogICAgdGhpcy5wYWdlTm8gPSB0aGlzLiRyb3V0ZS5xdWVyeS5wYWdlTm87CiAgICB0aGlzLnBhZ2VTaXplID0gdGhpcy4kcm91dGUucXVlcnkucGFnZVNpemU7CiAgICB0aGlzLmdldEluaXQoKTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnF1ZXJ5UHJvZHVjdEZpdHRpbmdDYXRlZ29yeUZuKCk7CiAgfSwKICBhY3RpdmF0ZWQoKSB7CiAgICAvLyDop6PlhrPnu4Tku7booqtrZWVwLWFsaXZl5peg5rOV5pu05paw5pWw5o2uCiAgICB0aGlzLmFkZFByb2R1Y3RGbigpOwogICAgdGhpcy5wcm9kdWN0SWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsKICAgIHRoaXMucGFnZU5vID0gdGhpcy4kcm91dGUucXVlcnkucGFnZU5vOwogICAgdGhpcy5wYWdlU2l6ZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnBhZ2VTaXplOwogICAgdGhpcy5nZXRJbml0KCk7CiAgfSwKICB3YXRjaDogewogICAgcHJvZHVjdElkKG5ld3ZhbCkgewogICAgICBpZiAobmV3dmFsID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLiRyZWZzLnBwcC5zZXRDb250ZW50KCIiKTsKICAgICAgfQogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOiOt+WPlgogICAgYXN5bmMgZ2V0SW5pdCgpIHsKICAgICAgYXdhaXQgcXVlcnlFeHBSdWxlRm4oewogICAgICAgIHBhZ2VObzogMSwKICAgICAgICBwYWdlU2l6ZTogMjAsCiAgICAgICAgbmFtZTogIiIsCiAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIGNvbnN0IHJlc0RhdGEgPSB0aGlzLnJlc0RhdGFGbihyZXMpOwogICAgICAgIHRoaXMuZXhwTGlzdC5zcGxpY2UoMCwgdGhpcy5leHBMaXN0Lmxlbmd0aCwgLi4ucmVzRGF0YS5yZWNvcmRzKTsKICAgICAgfSk7CiAgICAgIHRoaXMuZ2V0UHJvZHVjdERldGFpbEZuKCk7CiAgICAgIHRoaXMuZ2V0UXVlcnlTdXBwbGllckxpc3QoKTsKICAgIH0sCiAgICAvLyDojrflj5bkvpvlupTllYbliJfooagKICAgIGFzeW5jIGdldFF1ZXJ5U3VwcGxpZXJMaXN0KCkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeVN1cHBsaWVyTGlzdCh7CiAgICAgICAgcGFnZU5vOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMDAwLAogICAgICB9KTsKICAgICAgaWYgKHJlcy5jb2RlID09PSAiMDAwIikgewogICAgICAgIHRoaXMuc3VwcGxpZXJMaXN0ID0gcmVzLmRhdGEucmVjb3JkczsKICAgICAgfQogICAgfSwKICAgIC8vIOS6p+WTgeexu+Wei+mAieaLqQogICAgcHJvZHVjdFR5cGVDaGFuZ2UoZSkgewogICAgICB0aGlzLmFkZEVkaXREYXRhLmNhdGVnb3J5SWQgPSAiIjsKICAgIH0sCiAgICAvLyDojrflj5boo4XmnLrphY3ku7bllYblk4HliIbnsbsKICAgIGFzeW5jIHF1ZXJ5UHJvZHVjdEZpdHRpbmdDYXRlZ29yeUZuKCkgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeVByb2R1Y3RGaXR0aW5nQ2F0ZWdvcnlGbigpOwogICAgICBpZiAocmVzLmNvZGUgPT09ICIwMDAiKSB7CiAgICAgICAgdGhpcy5jYXRlZ29yeVBhcnRzTGlzdCA9IHJlcy5kYXRhOwogICAgICB9CiAgICB9LAogICAgLy8KICAgIGNhc2NhZGVyQ2hhbmdlRm4odmFsKSB7CiAgICAgIC8vIGNvbnN0IGVuZEluZGV4ID0gdmFsLmxlbmd0aCAtIDEKICAgICAgLy8gdGhpcy5hZGRFZGl0RGF0YS5jYXRlZ29yeUlkID0gdmFsW2VuZEluZGV4XQogICAgfSwKICAgIG5hbWVDaGFuZ2UoaW5kZXgpIHsKICAgICAgdGhpcy5hZGRFZGl0RGF0YS5saXN0W2luZGV4XS5uYW1lID0gdGhpcy5hZGRFZGl0RGF0YS5saXN0WwogICAgICAgIGluZGV4CiAgICAgIF0ubmFtZS5yZXBsYWNlKC9ccysvZywgIiIpOwogICAgfSwKICAgIHZhbHVlQ2hhbmdlKGluZGV4LCBpbmRleDIpIHsKICAgICAgdGhpcy5hZGRFZGl0RGF0YS5saXN0W2luZGV4XS52YWx1ZVtpbmRleDJdID0gdGhpcy5hZGRFZGl0RGF0YS5saXN0WwogICAgICAgIGluZGV4CiAgICAgIF0udmFsdWVbaW5kZXgyXS5yZXBsYWNlKC9ccysvZywgIiIpOwogICAgfSwKICAgIGxldmVsVmFsdWVDaGFuZ2UoaW5kZXgsIGtleSkgewogICAgICB0aGlzLmVkaXRMZXZlbERhdGFbaW5kZXhdW2tleV0gPSB0aGlzLmVkaXRMZXZlbERhdGFbaW5kZXhdW2tleV0ucmVwbGFjZSgKICAgICAgICAvXHMrL2csCiAgICAgICAgIiIKICAgICAgKTsKICAgIH0sCiAgICBiYXRjaENyZWF0Rm4oKSB7CiAgICAgIGNvbnN0IGFyciA9IFtdOwogICAgICB0aGlzLnJlc3VsdCA9IFtdOwogICAgICB0aGlzLnJlc3VsdHMgPSBbXTsKICAgICAgdGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdC5zcGxpY2UoMCwgdGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdC5sZW5ndGgpOwogICAgICB0aGlzLmFkZEVkaXREYXRhLmxpc3QuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICAgIGNvbnN0IHZhbEFyciA9IFtdOwogICAgICAgIGl0ZW0udmFsdWUuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgIHZhbEFyci5wdXNoKGluZGV4ICsgIiIpOwogICAgICAgIH0pOwogICAgICAgIGFyci5wdXNoKHZhbEFycik7CiAgICAgIH0pOwogICAgICB0aGlzLmRvRXhjaGFuZ2UoYXJyLCAwKTsKICAgICAgdGhpcy5yZXN1bHRzLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICB0aGlzLmFkZEVkaXREYXRhLnNwZWNMaXN0LnB1c2goewogICAgICAgICAgc3BlY0ltYWdlOiB0aGlzLmJhdGNoRGF0YS5zcGVjSW1hZ2UsCiAgICAgICAgICBpbnZlbnRvcnk6IHRoaXMuYmF0Y2hEYXRhLmludmVudG9yeSwKICAgICAgICAgIHNrdU5hbWU6ICIiLAogICAgICAgICAgc2t1Q29kZTogIiIsCiAgICAgICAgICBwcmljZTogdGhpcy5iYXRjaERhdGEucHJpY2UsCiAgICAgICAgICBvcmlnaW5hbFByaWNlOiB0aGlzLmJhdGNoRGF0YS5vcmlnaW5hbFByaWNlLAogICAgICAgICAgc2t1SW5kZXg6IGl0ZW0uc3BsaXQoIiwiKSwKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIGRvRXhjaGFuZ2UoYXJyLCBpbmRleCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycltpbmRleF0ubGVuZ3RoOyBpKyspIHsKICAgICAgICB0aGlzLnJlc3VsdFtpbmRleF0gPSBhcnJbaW5kZXhdW2ldOwogICAgICAgIGlmIChpbmRleCAhPSBhcnIubGVuZ3RoIC0gMSkgewogICAgICAgICAgdGhpcy5kb0V4Y2hhbmdlKGFyciwgaW5kZXggKyAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5yZXN1bHRzLnB1c2godGhpcy5yZXN1bHQuam9pbigiLCIpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzaG93QmF0Y2hEYXRhRm4oKSB7CiAgICAgIGlmICh0aGlzLmFkZEVkaXREYXRhLmxpc3QubGVuZ3RoID09IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6IGDor7fmt7vliqDop4TmoLzlsZ7mgKfvvIFgLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGJhdGNoSW1nU3VjRm4oaW1nKSB7CiAgICAgIHRoaXMuYmF0Y2hEYXRhLnNwZWNJbWFnZSA9IGltZzsKICAgIH0sCiAgICBhZGRQcm9kdWN0Rm4oKSB7CiAgICAgIHRoaXMuYWRkRWRpdERhdGEgPSB7CiAgICAgICAgZXhwSWQ6ICIiLAogICAgICAgIGNhdGVnb3J5SWQ6ICIiLAogICAgICAgIGNvbnRlbnQ6ICIiLAogICAgICAgIGNvdmVySW1hZ2U6ICIiLAogICAgICAgIGJhY2tJbWFnZTogIiIsCiAgICAgICAgaWQ6ICIiLAogICAgICAgIGltYWdlczogW10sCiAgICAgICAgaW52ZW50b3J5OiAiIiwKICAgICAgICBpc0V4aXN0TWFueVNwZWM6ICIiLAogICAgICAgIGlzU2hlbHZlczogIiIsCiAgICAgICAgbW9kZTogIiIsCiAgICAgICAgb3JpZ2luYWxQcmljZTogIiIsCiAgICAgICAgcHJpY2U6ICIiLAogICAgICAgIGxhc3RJbnZlbnRvcnk6IiIsCiAgICAgICAgc2ltcGxlRGVzYzogIiIsCiAgICAgICAgbGlzdDogW10sCiAgICAgICAgc3BlY0xpc3Q6IFtdLAogICAgICAgIHRpdGxlOiAiIiwKICAgICAgICAvLyBwYXJ0c0lkOicnLAogICAgICAgIHN1cHBsaWVySWQ6ICIiLAogICAgICAgIC8vIGdyb3VwSG91cnM6MSwKICAgICAgICBncm91cE51bTogMSwKICAgICAgICBhY3Rpdml0eVRpbWU6IFtdLAogICAgICAgIGFjdGl2aXR5U3RhcnRUaW1lOiAiIiwKICAgICAgICBhY3Rpdml0eUVuZFRpbWU6ICIiLAogICAgICB9OwogICAgfSwKICAgIHN1Ym1pdEZuKCkgewogICAgICBjb25zdCBwb3N0RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5hZGRFZGl0RGF0YSkpOwogICAgICBwb3N0RGF0YS5vcmlnaW5hbFByaWNlID0gTnVtYmVyKHBvc3REYXRhLm9yaWdpbmFsUHJpY2UpOwogICAgICBwb3N0RGF0YS5sYXN0SW52ZW50b3J5ID0gTnVtYmVyKHBvc3REYXRhLmxhc3RJbnZlbnRvcnkpCiAgICAgIGNvbnNvbGUubG9nKHBvc3REYXRhLCAiMDAwIik7CiAgICAgIGxldCBsaXN0RmxhZyA9IHRydWU7CiAgICAgIGxldCBzcGVjTGlzdEZsYWcgPSB0cnVlOwoKICAgICAgLy8g6KeE5qC85pWw5o2u6aqM6K+BCiAgICAgIGlmICh0aGlzLmFkZEVkaXREYXRhLmlzRXhpc3RNYW55U3BlYyA9PSAxKSB7CiAgICAgICAgaWYgKHRoaXMuYWRkRWRpdERhdGEubGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgbGlzdEZsYWcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6IGDor7fmt7vliqDop4TmoLzlsZ7mgKfvvIFgLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3QubGVuZ3RoID09IDApIHsKICAgICAgICAgIHNwZWNMaXN0RmxhZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogYOivt+a3u+WKoOWVhuWTgeinhOagvO+8gWAsCiAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBmb3IgKHZhciBpID0gMCwgaiA9IHRoaXMuYWRkRWRpdERhdGEubGlzdC5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICAgIGlmICh0aGlzLmFkZEVkaXREYXRhLmxpc3RbaV0udmFsdWUubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgbGlzdEZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGDor7fmt7vliqDigJwke3RoaXMuYWRkRWRpdERhdGEubGlzdFtpXS5uYW1lfeKAneinhOagvOWxnuaAp+WAvOaIluiAheWIoOmZpOivpeinhOagvOWxnuaAp++8gWAsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFkZEVkaXREYXRhLmxpc3RbaV0udmFsdWUuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpOwogICAgICAgICAgICBpZiAoaXRlbSA9PSAiIikgewogICAgICAgICAgICAgIGxpc3RGbGFnID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBg4oCcJHt0aGlzLmFkZEVkaXREYXRhLmxpc3RbaV0ubmFtZX3igJ3op4TmoLzlsZ7mgKfnrKwkewogICAgICAgICAgICAgICAgICBpbmRleCArIDEKICAgICAgICAgICAgICAgIH3kuKrlgLzkuLrnqbrvvIzor7fliKDpmaTmiJbovpPlhaXlgLzvvIFgLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgZm9yICh2YXIgbSA9IDAsIG4gPSB0aGlzLmFkZEVkaXREYXRhLnNwZWNMaXN0Lmxlbmd0aDsgbSA8IG47IG0rKykgewogICAgICAgICAgaWYgKHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3RbbV0uc2t1SW5kZXguaW5kZXhPZigiIikgPiAtMSkgewogICAgICAgICAgICBzcGVjTGlzdEZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGDnrKwkewogICAgICAgICAgICAgICAgbSAtIDAgKyAxCiAgICAgICAgICAgICAgfeS4quWVhuWTgeinhOagvOacieinhOagvOWxnuaAp+acqumAieaLqe+8jOivt+mAieaLqeWQjuWGjeaPkOS6pO+8gWAsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwb3N0RGF0YS5zcGVjTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICBsZXQgbmFtZSA9ICIiOwogICAgICAgICAgaXRlbS5za3VJbmRleC5mb3JFYWNoKChpdGVtMiwgaW5kZXgpID0+IHsKICAgICAgICAgICAgbmFtZSArPSBwb3N0RGF0YS5saXN0W2luZGV4XS52YWx1ZVtOdW1iZXIoaXRlbTIpXSArICIsIjsKICAgICAgICAgIH0pOwogICAgICAgICAgaXRlbS5za3VOYW1lID0gbmFtZTsKICAgICAgICAgIGl0ZW0uc2t1TmFtZSA9IGl0ZW0uc2t1TmFtZS5yZXBsYWNlKC9cLCQvLCAiIik7CiAgICAgICAgICBpdGVtLnNrdUluZGV4ID0gaXRlbS5za3VJbmRleC5qb2luKCIsIik7CiAgICAgICAgfSk7CiAgICAgICAgcG9zdERhdGEubGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICBpdGVtLnZhbHVlID0gaXRlbS52YWx1ZS5qb2luKCIsIik7CiAgICAgICAgfSk7CiAgICAgICAgcG9zdERhdGEuaW52ZW50b3J5ID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIGlmICghbGlzdEZsYWcgfHwgIXNwZWNMaXN0RmxhZykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5hZGRFZGl0RGF0YS5pc0V4aXN0TWFueVNwZWMgPT09IDEpIHsKICAgICAgICBwb3N0RGF0YS5zcGVjSW5mb0xpc3QgPSBwb3N0RGF0YS5saXN0LnNsaWNlKCk7CiAgICAgICAgcG9zdERhdGEuc2t1SW5mb0xpc3QgPSBwb3N0RGF0YS5zcGVjTGlzdC5zbGljZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHBvc3REYXRhLnNwZWNJbmZvTGlzdCA9IFtdOwogICAgICAgIHBvc3REYXRhLnNrdUluZm9MaXN0ID0gW107CiAgICAgIH0KICAgICAgLy8gcG9zdERhdGEucmV3YXJkSW5mb0xpc3QgPSB0aGlzLmVkaXRMZXZlbERhdGE7CiAgICAgIC8vIHBvc3REYXRhLnJld2FyZEluZm9MaXN0Lm1hcCgoaXRlbSkgPT4gewogICAgICAvLyAgIGRlbGV0ZSBpdGVtLm5hbWU7CiAgICAgIC8vIH0pOwogICAgICBkZWxldGUgcG9zdERhdGEubGlzdDsKICAgICAgZGVsZXRlIHBvc3REYXRhLnNwZWNMaXN0OwogICAgICBkZWxldGUgcG9zdERhdGEuY2F0ZWdvcnlOYW1lOwogICAgICBkZWxldGUgcG9zdERhdGEuY3JlYXRlVGltZTsKCiAgICAgIGlmICghcG9zdERhdGEuY2F0ZWdvcnlJZCB8fCBwb3N0RGF0YS5jYXRlZ29yeUlkLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogYOivt+mAieaLqeWVhuWTgeWIhuexu++8gWAsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8qIGlmKHRoaXMuYWRkRWRpdERhdGEudHlwZSAhPT0gMyl7CgkJIGlmICghcG9zdERhdGEuY2F0ZWdvcnlJZCB8fCBwb3N0RGF0YS5jYXRlZ29yeUlkLmxlbmd0aCA9PT0gMCkgewoJCQl0aGlzLiRtZXNzYWdlKHsKCQkJICBzaG93Q2xvc2U6IHRydWUsCgkJCSAgbWVzc2FnZTogYOivt+mAieaLqeWVhuWTgeWIhuexu++8gWAsCgkJCSAgdHlwZTogIndhcm5pbmciLAoJCQl9KTsKCQkJcmV0dXJuOwoJCSAgfQoJICB9ZWxzZXsKCQkgIGlmICghcG9zdERhdGEucGFydHNJZCB8fCBwb3N0RGF0YS5wYXJ0c0lkLmxlbmd0aCA9PT0gMCkgewoJCQkJdGhpcy4kbWVzc2FnZSh7CgkJCQkgIHNob3dDbG9zZTogdHJ1ZSwKCQkJCSAgbWVzc2FnZTogYOivt+mAieaLqeWVhuWTgeWIhuexu++8gWAsCgkJCQkgIHR5cGU6ICJ3YXJuaW5nIiwKCQkJCX0pOwoJCQkJcmV0dXJuOwoJCSAgIH0KCSAgfSAqLwoKICAgICAgaWYgKCF0aGlzLmFkZEVkaXREYXRhLnN1cHBsaWVySWQpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6IGDor7fpgInmi6nkvpvlupTllYbvvIFgLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBwb3N0RGF0YS5jYXRlZ29yeUlkID0gcG9zdERhdGEuY2F0ZWdvcnlJZC5wb3AoKTsKICAgICAgcG9zdERhdGEuaW1hZ2VzID0gcG9zdERhdGEuaW1hZ2VzLmpvaW4oIiwiKTsKICAgICAgcG9zdERhdGEuaWQgPSB0aGlzLnByb2R1Y3RJZCA/IHRoaXMucHJvZHVjdElkIDogdW5kZWZpbmVkOwogICAgICBwb3N0RGF0YS5hY3Rpdml0eVN0YXJ0VGltZSA9IHBvc3REYXRhLmFjdGl2aXR5VGltZVswXTsKICAgICAgcG9zdERhdGEuYWN0aXZpdHlFbmRUaW1lID0gcG9zdERhdGEuYWN0aXZpdHlUaW1lWzFdOwogICAgICBjb25zb2xlLmxvZyhwb3N0RGF0YSk7CiAgICAgIC8vIHJldHVybgogICAgICB0aGlzLnN1Ym1pdEluZyA9IHRydWU7CiAgICAgIGVkaXRQcm9kdWN0Rm4ocG9zdERhdGEpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuc3VibWl0SW5nID0gZmFsc2U7CiAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIGlmIChyZXMuY29kZSA9PSAiMDAwIikgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgICAgICAgbWVzc2FnZTogIuaTjeS9nOaIkOWKn++8gSIsCiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5lZGl0QWRkVmFsSXRlbS5zcGxpY2UoMCwgdGhpcy5lZGl0QWRkVmFsSXRlbS5sZW5ndGgpOwogICAgICAgICAgICBpZiAodGhpcy5wcm9kdWN0SWQpIHsKICAgICAgICAgICAgICB0aGlzLmdldFByb2R1Y3REZXRhaWxGbigpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhpcy5zdWJtaXRJbmcgPSBmYWxzZTsKICAgICAgICAgIH0sIDEwMDApOwogICAgICAgIH0pOwogICAgfSwKICAgIHVwTG9hZFNwY2VJbWdGbihpbWcsIGluZGV4KSB7CiAgICAgIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3RbaW5kZXhdLnNwZWNJbWFnZSA9IGltZzsKICAgIH0sCiAgICBhZGRTcGVjSXRlbUZuKCkgewogICAgICBsZXQgc3BlY0xpc3RNb3JlTGVuZ3RoID0gMTsKICAgICAgaWYgKHRoaXMuYWRkRWRpdERhdGEubGlzdC5sZW5ndGggPT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+WFiOa3u+WKoOinhOagvOWxnuaAp+WSjOinhOagvOWxnuaAp+WAvO+8gSIsCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuYWRkRWRpdERhdGEubGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgc3BlY0xpc3RNb3JlTGVuZ3RoID0gc3BlY0xpc3RNb3JlTGVuZ3RoICogaXRlbS52YWx1ZS5sZW5ndGg7CiAgICAgIH0pOwogICAgICBpZiAodGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdC5sZW5ndGggPj0gc3BlY0xpc3RNb3JlTGVuZ3RoKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAi5oKo5re75Yqg55qE5ZWG5ZOB6KeE5qC85bey6L6+5Yiw5pyA5aSn5pWw6YeP77yBIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdC5wdXNoKHsKICAgICAgICBzcGVjSW1hZ2U6ICIiLAogICAgICAgIHNrdU5hbWU6ICIiLAogICAgICAgIGludmVudG9yeTogMCwKICAgICAgICBza3VDb2RlOiAiIiwKICAgICAgICBwcmljZTogMCwKICAgICAgICBvcmlnaW5hbFByaWNlOiAwLAogICAgICAgIHNrdUluZGV4OiBBcnJheSh0aGlzLmFkZEVkaXREYXRhLmxpc3QubGVuZ3RoKS5maWxsKCIiKSwKICAgICAgfSk7CiAgICB9LAogICAgYWRkTGlzdEl0ZW1GbigpIHsKICAgICAgdGhpcy5hZGRFZGl0RGF0YS5saXN0LnB1c2goeyBuYW1lOiAiIiwgdmFsdWU6IFtdIH0pOwogICAgICB0aGlzLmFkZEVkaXREYXRhLnNwZWNMaXN0LmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICBpdGVtLnNrdUluZGV4LnB1c2goIiIpOwogICAgICB9KTsKICAgIH0sCiAgICBkZWxMaXN0VmFsdUl0ZW1GbihpbmRleCwgaW5kZXgyKSB7CiAgICAgIGZvciAodmFyIGkgPSB0aGlzLmFkZEVkaXREYXRhLnNwZWNMaXN0Lmxlbmd0aDsgaS0tOyApIHsKICAgICAgICAvLyBjb25zb2xlLmxvZygn5ZWG5ZOB6KeE5qC85YC877yaJyArIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3RbaV0uc2t1SW5kZXhbaW5kZXhdLCAn6KeE5qC877yaJyArIGluZGV4LCAn6KeE5qC85YC877yaJyArIGluZGV4MikKICAgICAgICBpZiAodGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdFtpXS5za3VJbmRleFtpbmRleF0gIT0gIiIpIHsKICAgICAgICAgIGlmICh0aGlzLmFkZEVkaXREYXRhLnNwZWNMaXN0W2ldLnNrdUluZGV4W2luZGV4XSA9PSBpbmRleDIpIHsKICAgICAgICAgICAgdGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdC5zcGxpY2UoaSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdFtpXSkgewogICAgICAgICAgICBpZiAodGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdFtpXS5za3VJbmRleFtpbmRleF0gPiBpbmRleDIpIHsKICAgICAgICAgICAgICB0aGlzLmFkZEVkaXREYXRhLnNwZWNMaXN0W2ldLnNrdUluZGV4W2luZGV4XSAtPSAxOwogICAgICAgICAgICAgIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3RbaV0uc2t1SW5kZXhbaW5kZXhdICs9ICIiOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuYWRkRWRpdERhdGEubGlzdFtpbmRleF0udmFsdWUuc3BsaWNlKGluZGV4MiwgMSk7CiAgICAgIGNvbnN0IGRlbEluZGV4ID0gdGhpcy5lZGl0QWRkVmFsSXRlbS5pbmRleE9mKGluZGV4ICsgIiwiICsgaW5kZXgyKTsKICAgICAgLy8gdGhpcy5lZGl0QWRkVmFsSXRlbS5zcGxpY2UoZGVsSW5kZXgsIDEpCiAgICB9LAogICAgYWRkTGlzdFZhbEZuKGluZGV4KSB7CiAgICAgIGNvbnN0IGRlbEluZGV4ID0gdGhpcy5lZGl0QWRkVmFsSXRlbS5pbmRleE9mKAogICAgICAgIGluZGV4ICsgIiwiICsgdGhpcy5hZGRFZGl0RGF0YS5saXN0W2luZGV4XS52YWx1ZS5sZW5ndGgKICAgICAgKTsKICAgICAgaWYgKGRlbEluZGV4ID09IC0xKSB7CiAgICAgICAgdGhpcy5lZGl0QWRkVmFsSXRlbS5wdXNoKAogICAgICAgICAgaW5kZXggKyAiLCIgKyB0aGlzLmFkZEVkaXREYXRhLmxpc3RbaW5kZXhdLnZhbHVlLmxlbmd0aAogICAgICAgICk7CiAgICAgIH0KICAgICAgdGhpcy5hZGRFZGl0RGF0YS5saXN0W2luZGV4XS52YWx1ZS5wdXNoKCIiKTsKICAgIH0sCiAgICBkZWxMaXN0Rm4oaW5kZXgpIHsKICAgICAgZm9yICh2YXIgaSA9IHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3QubGVuZ3RoOyBpLS07ICkgewogICAgICAgIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3RbaV0uc2t1SW5kZXguc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICBpZiAodGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdFtpXS5za3VJbmRleFtpbmRleF0pIHsKICAgICAgICAgIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3Quc3BsaWNlKGksIDEpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmFkZEVkaXREYXRhLmxpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCiAgICBkZWxTcGVjRm4oaW5kZXgpIHsKICAgICAgdGhpcy5hZGRFZGl0RGF0YS5zcGVjTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKICAgIHVwbG9hZFN1Y0ZuKGltZykgewogICAgICB0aGlzLmFkZEVkaXREYXRhLmNvdmVySW1hZ2UgPSBpbWc7CiAgICB9LAogICAgdXBsb2FkU3VjRm4yKGltZykgewogICAgICB0aGlzLmFkZEVkaXREYXRhLmJhY2tJbWFnZSA9IGltZzsKICAgIH0sCiAgICB1cGxvYWRJbWdzU3VjRm4oaW1nKSB7CiAgICAgIHRoaXMuYWRkRWRpdERhdGEuaW1hZ2VzLnB1c2goaW1nKTsKICAgIH0sCiAgICBkZWxldGVJbWdGbihpbmRleCkgewogICAgICB0aGlzLmFkZEVkaXREYXRhLmltYWdlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmFkZEVkaXREYXRhLmltYWdlcyxpbmRleCkKICAgIH0sCiAgICBnZXRQcm9kdWN0RGV0YWlsRm4oKSB7CiAgICAgIGlmICghdGhpcy5wcm9kdWN0SWQpIHJldHVybjsKICAgICAgdGhpcy5hZGRFZGl0RGF0YS5pbWFnZXMuc3BsaWNlKDAsIHRoaXMuYWRkRWRpdERhdGEuaW1hZ2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkRWRpdERhdGEubGlzdC5zcGxpY2UoMCwgdGhpcy5hZGRFZGl0RGF0YS5saXN0Lmxlbmd0aCk7CiAgICAgIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3Quc3BsaWNlKDAsIHRoaXMuYWRkRWRpdERhdGEuc3BlY0xpc3QubGVuZ3RoKTsKICAgICAgZ2V0UHJvZHVjdERldGFpbEZuKHsgaWQ6IHRoaXMucHJvZHVjdElkIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIGNvbnN0IHJlc0RhdGEgPSB0aGlzLnJlc0RhdGFGbihyZXMpOwogICAgICAgIGlmICghcmVzRGF0YS5zcGVjSW5mb0xpc3QpIHsKICAgICAgICAgIHJlc0RhdGEuc3BlY0luZm9MaXN0ID0gW107CiAgICAgICAgfQogICAgICAgIGlmICghcmVzRGF0YS5za3VJbmZvTGlzdCkgewogICAgICAgICAgcmVzRGF0YS5za3VJbmZvTGlzdCA9IFtdOwogICAgICAgIH0KICAgICAgICBpZiAocmVzRGF0YS5pc0V4aXN0TWFueVNwZWMgPT0gMSAmJiByZXNEYXRhLnNwZWNJbmZvTGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICByZXNEYXRhLnNwZWNJbmZvTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICAgIGl0ZW0udmFsdWUgPSBpdGVtLnZhbHVlLnNwbGl0KCIsIik7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc0RhdGEuaXNFeGlzdE1hbnlTcGVjID09IDEgJiYgcmVzRGF0YS5za3VJbmZvTGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICByZXNEYXRhLnNrdUluZm9MaXN0LmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgICAgaWYgKGl0ZW0uc2t1SW5kZXgpIHsKICAgICAgICAgICAgICBpdGVtLnNrdUluZGV4ID0gaXRlbS5za3VJbmRleC5zcGxpdCgiLCIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGl0ZW0uc2t1SW5kZXggPSBbXTsKICAgICAgICAgICAgICBpZiAoaXRlbS5za3VOYW1lKSB7CiAgICAgICAgICAgICAgICBpdGVtLnNrdU5hbWUuc3BsaXQoIiwiKS5mb3JFYWNoKChpdGVtMiwgaW5kZXgyKSA9PiB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHBvc0luZGV4ID0KICAgICAgICAgICAgICAgICAgICByZXNEYXRhLnNwZWNJbmZvTGlzdFtpbmRleDJdLnZhbHVlLmluZGV4T2YoaXRlbTIpOwogICAgICAgICAgICAgICAgICBpZiAocG9zSW5kZXggPiAtMSkgewogICAgICAgICAgICAgICAgICAgIGl0ZW0uc2t1SW5kZXgucHVzaChTdHJpbmcocG9zSW5kZXgpKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgdGhpcy5hZGRFZGl0RGF0YS5hY3Rpdml0eVRpbWUgPQogICAgICAgICAgcmVzRGF0YS5hY3Rpdml0eVN0YXJ0VGltZSAmJiByZXNEYXRhLmFjdGl2aXR5RW5kVGltZQogICAgICAgICAgICA/IFtyZXNEYXRhLmFjdGl2aXR5U3RhcnRUaW1lLCByZXNEYXRhLmFjdGl2aXR5RW5kVGltZV0KICAgICAgICAgICAgOiBbXTsKICAgICAgICB0aGlzLmFkZEVkaXREYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5hZGRFZGl0RGF0YSwgcmVzRGF0YSwgewogICAgICAgICAgLy8gcHJvdmluY2VQcmljZToKICAgICAgICAgIC8vICAgcmVzRGF0YS50eXBlID09PSAzID8gcmVzRGF0YS5wcm9kdWN0QWdlbnQucHJvUHJpY2UgOiB1bmRlZmluZWQsCiAgICAgICAgICAvLyBjaXR5UHJpY2U6CiAgICAgICAgICAvLyAgIHJlc0RhdGEudHlwZSA9PT0gMyA/IHJlc0RhdGEucHJvZHVjdEFnZW50LmNpdHlQcmljZSA6IHVuZGVmaW5lZCwKICAgICAgICAgIC8vIGFyZWFQcmljZToKICAgICAgICAgIC8vICAgcmVzRGF0YS50eXBlID09PSAzID8gcmVzRGF0YS5wcm9kdWN0QWdlbnQuYXJlYVByaWNlIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gZGVhbGVyUHJpY2U6CiAgICAgICAgICAvLyAgIHJlc0RhdGEudHlwZSA9PT0gMyA/IHJlc0RhdGEucHJvZHVjdEFnZW50LmRlYWxlclByaWNlIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gcHJvdmluY2VUaGlnaDoKICAgICAgICAgIC8vICAgcmVzRGF0YS50eXBlID09PSAzID8gcmVzRGF0YS5wcm9kdWN0QWdlbnQucHJvVGhpZ2ggOiB1bmRlZmluZWQsCiAgICAgICAgICAvLyBjaXR5VGhpZ2g6CiAgICAgICAgICAvLyAgIHJlc0RhdGEudHlwZSA9PT0gMyA/IHJlc0RhdGEucHJvZHVjdEFnZW50LmNpdHlUaGlnaCA6IHVuZGVmaW5lZCwKICAgICAgICAgIC8vIGFyZWFUaGlnaDoKICAgICAgICAgIC8vICAgcmVzRGF0YS50eXBlID09PSAzID8gcmVzRGF0YS5wcm9kdWN0QWdlbnQuYXJlYVRoaWdoIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gZGVhbGVyVGhpZ2g6CiAgICAgICAgICAvLyAgIHJlc0RhdGEudHlwZSA9PT0gMyA/IHJlc0RhdGEucHJvZHVjdEFnZW50LmRlYWxlclRoaWdoIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gcHJvdmluY2VCZWdpbk51bToKICAgICAgICAgIC8vICAgcmVzRGF0YS50eXBlID09PSAzID8gcmVzRGF0YS5wcm9kdWN0QWdlbnQucHJvTnVtIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gY2l0eUJlZ2luTnVtOgogICAgICAgICAgLy8gICByZXNEYXRhLnR5cGUgPT09IDMgPyByZXNEYXRhLnByb2R1Y3RBZ2VudC5jaXR5TnVtIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gYXJlYUJlZ2luTnVtOgogICAgICAgICAgLy8gICByZXNEYXRhLnR5cGUgPT09IDMgPyByZXNEYXRhLnByb2R1Y3RBZ2VudC5hcmVhTnVtIDogdW5kZWZpbmVkLAogICAgICAgICAgLy8gZGVhbGVyQmVnaW5OdW06CiAgICAgICAgICAvLyAgIHJlc0RhdGEudHlwZSA9PT0gMyA/IHJlc0RhdGEucHJvZHVjdEFnZW50LmRlYWxlck51bSA6IHVuZGVmaW5lZCwKICAgICAgICAgIC8vIHByb2R1Y3RBZ2VudDogdW5kZWZpbmVkLAogICAgICAgICAgY2F0ZWdvcnlJZDogcmVzRGF0YS5jYXRlZ29yeUlkcywKICAgICAgICAgIGltYWdlczogcmVzRGF0YS5pbWFnZXMuc3BsaXQoIiwiKSwKICAgICAgICAgIGxpc3Q6CiAgICAgICAgICAgIHJlc0RhdGEuc3BlY0luZm9MaXN0ICYmIHJlc0RhdGEuc3BlY0luZm9MaXN0Lmxlbmd0aCA+IDAKICAgICAgICAgICAgICA/IHJlc0RhdGEuc3BlY0luZm9MaXN0CiAgICAgICAgICAgICAgOiBbXSwKICAgICAgICAgIHNwZWNMaXN0OgogICAgICAgICAgICByZXNEYXRhLnNrdUluZm9MaXN0ICYmIHJlc0RhdGEuc2t1SW5mb0xpc3QubGVuZ3RoID4gMAogICAgICAgICAgICAgID8gcmVzRGF0YS5za3VJbmZvTGlzdAogICAgICAgICAgICAgIDogW10sCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5lZGl0TGV2ZWxEYXRhID0gcmVzRGF0YS5yZXdhcmRJbmZvTGlzdDsKICAgICAgICB0aGlzLmxldmVsTGlzdC5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICBpZiAodGhpcy5lZGl0TGV2ZWxEYXRhW2luZGV4XS5sZXZlbElkID09PSBpdGVtLmlkKSB7CiAgICAgICAgICAgIHRoaXMuZWRpdExldmVsRGF0YVtpbmRleF0ubmFtZSA9IGl0ZW0ubmFtZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAvLyDlpoLmnpzmmK/oo4XmnLrllYblk4Eg6K6+5a6a5YiG57G7aWQg5Li66KOF5py65YiG57G755qEaWQKICAgICAgICAvLyBpZih0aGlzLmFkZEVkaXREYXRhLnR5cGUgPT09IDMpewogICAgICAgIC8vIAl0aGlzLmFkZEVkaXREYXRhLmNhdGVnb3J5SWQgPSB0aGlzLmFkZEVkaXREYXRhLnBhcnRzSWQKICAgICAgICAvLyB9CiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},null]}