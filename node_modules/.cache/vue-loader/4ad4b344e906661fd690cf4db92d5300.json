{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\product\\weixinindex-producttuijian\\update.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\product\\weixinindex-producttuijian\\update.vue","mtime":1669258939325},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHF1ZXJ5SW5zdGFsbExpc3RGbiB9IGZyb20gIkAvYXBpL2luc3RhbGwiOwppbXBvcnQgewogIHF1ZXJ5UHJvZHVjdEZuLAogIHF1ZXJ5UHJvZHVjdENhdGVnb3J5Rm4sCiAgdXBkYXRlUmVjb21tZW5kUHJvZHVjdCwKfSBmcm9tICJAL2FwaS9wcm9kdWN0IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICIiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0eXBlSUQ6IC0xLAogICAgICByZWFsc2VsZWN0YXJyOiBbXSwKICAgICAgc2VsZWN0YXJyOiBbXSwKICAgICAgcHJvZHVjdElkczogW10sCiAgICAgIGRhdGFMaXN0OiBbXSwKICAgICAgZGF0YUNvbmZpZzogewogICAgICAgIHBhZ2VObzogMSwKICAgICAgICBwYWdlU2l6ZTogMTAsCiAgICAgICAgdG90YWw6IDAsCiAgICAgICAgbG9hZGluZzogdHJ1ZSwKICAgICAgfSwKICAgICAgcXVlcnlkYXRhOiB7CiAgICAgICAgY2F0ZWdvcnlJZDogIiIsIC8v5ZWG5ZOB5YiG57G7aWQKICAgICAgfSwKICAgICAgY2F0ZWdvcnlMaXN0OiB7CiAgICAgICAgbGF6eTogdHJ1ZSwKICAgICAgICBjaGVja1N0cmljdGx5OiB0cnVlLAogICAgICAgIGxhenlMb2FkKG5vZGUsIHJlc29sdmUpIHsKICAgICAgICAgIHF1ZXJ5UHJvZHVjdENhdGVnb3J5Rm4oewogICAgICAgICAgICBwaWQ6IG5vZGUudmFsdWUgfHwgMCwKICAgICAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBjb25zdCByZXNEYXRhID0gcmVzLmRhdGE7CiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gcmVzRGF0YS5tYXAoKGl0ZW0pID0+ICh7CiAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0uaWQsCiAgICAgICAgICAgICAgbGFiZWw6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAvLyDpgJrov4fosIPnlKhyZXNvbHZl5bCG5a2Q6IqC54K55pWw5o2u6L+U5Zue77yM6YCa55+l57uE5Lu25pWw5o2u5Yqg6L295a6M5oiQCiAgICAgICAgICAgIHJlc29sdmUobm9kZXMpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgfSwKICAgIH07CiAgfSwKICBiZWZvcmVNb3VudCgpIHt9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLnR5cGVJRCA9IE51bWJlcih0aGlzLiRyb3V0ZS5xdWVyeS50eXBlSUQpOwogICAgaWYgKHRoaXMudHlwZUlEID09PSAxKSB7CiAgICAgIHRoaXMuZ2V0aW5zdGFsbHByb2R1Y3RMaXN0KCk7CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgcmVhbGNhdGVnb3J5SWQoKSB7CiAgICAgIGlmICghdGhpcy5xdWVyeWRhdGEuY2F0ZWdvcnlJZCkgcmV0dXJuIGZhbHNlOwogICAgICByZXR1cm4gdGhpcy5xdWVyeWRhdGEuY2F0ZWdvcnlJZC5wb3AoKTsKICAgIH0sCiAgfSwKICB3YXRjaDoge30sCiAgbWV0aG9kczogewogICAgLy/ojrflj5bllYblk4EKICAgIGdldERhdGFMaXN0Rm4oKSB7CiAgICAgIGlmICghdGhpcy5xdWVyeWRhdGEuY2F0ZWdvcnlJZCAmJiB0aGlzLnR5cGVJRCA9PT0gMSkKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+36YCJ5oup5ZWG5ZOB5YiG57G7Iik7CiAgICAgIHF1ZXJ5UHJvZHVjdEZuKHsKICAgICAgICBwYWdlTm86IHRoaXMuZGF0YUNvbmZpZy5wYWdlTm8sCiAgICAgICAgcGFnZVNpemU6IHRoaXMuZGF0YUNvbmZpZy5wYWdlU2l6ZSwKICAgICAgICBjYXRlZ29yeUlkOiB0aGlzLnJlYWxjYXRlZ29yeUlkLAogICAgICAgIGlzU2hlbHZlczogIiIsCiAgICAgICAgdGl0bGU6ICIiLAogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBjb25zdCByZXNEYXRhID0gdGhpcy5yZXNEYXRhRm4ocmVzKTsKICAgICAgICB0aGlzLmRhdGFDb25maWcudG90YWwgPSByZXNEYXRhLnRvdGFsOwogICAgICAgIHJlc0RhdGEucmVjb3Jkcy5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICBpdGVtLmlzU2hlbHZlcyA9IGl0ZW0uaXNTaGVsdmVzID09IDE7CiAgICAgICAgICBsZXQgaXNzZWxlY3QgPSB0aGlzLnNlbGVjdGFyci5pbmRleE9mKGl0ZW0uaWQpICE9PSAtMTsKICAgICAgICAgIGlmIChpc3NlbGVjdCkgewogICAgICAgICAgICB0aGlzLm9wZW5zZWxjdGlvbihpdGVtKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB0aGlzLmRhdGFMaXN0LnNwbGljZSgwLCB0aGlzLmRhdGFMaXN0Lmxlbmd0aCwgLi4ucmVzRGF0YS5yZWNvcmRzKTsKICAgICAgfSk7CiAgICB9LAogICAgLy/ojrflj5boo4XmnLrllYblk4EKICAgIGdldGluc3RhbGxwcm9kdWN0TGlzdCgpIHsKICAgICAgcXVlcnlJbnN0YWxsTGlzdEZuKHsKICAgICAgICBuYW1lOiAiIiwKICAgICAgICBwYWdlTm86IDEsCiAgICAgICAgcGFnZVNpemU6IDk5OTksCiAgICAgICAgcXVlcnlUaW1lOiAiIiwKICAgICAgfSkudGhlbigoZWxlKSA9PiB7CiAgICAgICAgdGhpcy5kYXRhTGlzdCA9IGVsZS5kYXRhLnJlY29yZHM7CiAgICAgIH0pOwogICAgfSwKICAgIC8v5p+l6K+i5ZWG5ZOBCiAgICBxdWVyeURhdGFMaXN0Rm4oKSB7CiAgICAgIHRoaXMuZGF0YUNvbmZpZyA9IHsKICAgICAgICBwYWdlTm86IDEsCiAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgIHRvdGFsOiAwLAogICAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIH07CiAgICAgIHRoaXMuZ2V0RGF0YUxpc3RGbigpOwogICAgfSwKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuZGF0YUNvbmZpZy5wYWdlU2l6ZSA9IHZhbDsKICAgICAgdGhpcy5nZXREYXRhTGlzdEZuKCk7CiAgICB9LAogICAgY3VycmVudENoYW5nZUZuKHBhZ2VObykgewogICAgICB0aGlzLmRhdGFDb25maWcucGFnZU5vID0gcGFnZU5vOwogICAgICB0aGlzLmdldERhdGFMaXN0Rm4oKTsKICAgIH0sCiAgICAvL+WIpOaWreaYr+WQpumAieS4rQogICAgb3BlbnNlbGN0aW9uKHJvdykgewogICAgICB0aGlzLiRyZWZzLnRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbihyb3cpOwogICAgfSwKICAgIC8v6KGo5qC85Y2V6KGM54K55Ye7CiAgICBzZWxlY3Rpb25Sb3coc2VsZWN0aW9uLCByb3cpIHsKICAgICAgaWYgKHRoaXMuc2VsZWN0YXJyLmxlbmd0aCA9PT0gMikKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi5pyA5aSa6YCJ5oup5Lik5LiqIik7CiAgICAgIGxldCBzZWxlY3RlZCA9IHNlbGVjdGlvbi5sZW5ndGggJiYgc2VsZWN0aW9uLmluZGV4T2Yocm93KSAhPT0gLTE7IC8v5Li6dHJ1ZeaXtumAieS4re+8jOS4uiAwIOaXtu+8iGZhbHNl77yJ5pyq6YCJ5LitCiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHRoaXMuc2VsZWN0YXJyLnB1c2gocm93LmlkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgaW5kID0gdGhpcy5zZWxlY3RhcnIuaW5kZXhPZihyb3cuaWQpOwogICAgICAgIGlmIChpbmQgPiAtMSkgewogICAgICAgICAgdGhpcy5zZWxlY3RhcnIuc3BsaWNlKGluZCwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaGFuZGxlc2VsZWN0QWxsKCkgewogICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLmnIDlpJrpgInmi6nkuKTkuKoiKTsKICAgICAgdGhpcy4kcmVmcy50YWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgfSwKICAgIC8v5o+Q5LqkCiAgICBzdWJtaXRGbigpIHsKICAgICAgaWYgKHRoaXMuc2VsZWN0YXJyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+mAieaLqeWVhuWTgSIpOwogICAgICBpZiAodGhpcy5zZWxlY3RhcnIubGVuZ3RoID09PSAxKQogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCLoh7PlsJHpgInmi6nkuKTkuKrllYblk4EiKTsKICAgICAgdXBkYXRlUmVjb21tZW5kUHJvZHVjdCh7CiAgICAgICAgaWQ6IE51bWJlcih0aGlzLiRyb3V0ZS5xdWVyeS50eXBlSUQpLAogICAgICAgIHByb2R1Y3RJZHM6IHRoaXMuc2VsZWN0YXJyLmpvaW4oIiwiKSwKICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAiMDAwIikgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLmj5DkuqTmiJDlip8iKTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJ3ZWl4aW5pbmRleHByb2R1Y3R0dWlqaWFuTGlzdCIgfSk7CiAgICAgICAgICB9LCA3NTApOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["update.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"update.vue","sourceRoot":"src/views/product/weixinindex-producttuijian","sourcesContent":["<template>\n  <div class=\"content_box\">\n    <first-title title=\"更换商品\" />\n    <div class=\"select_view\">\n      <el-cascader\n        v-if=\"typeID !== 1\"\n        style=\"width: 300px\"\n        v-model=\"querydata.categoryId\"\n        class=\"mg_r15 mg_t10\"\n        placeholder=\"请选择商品分类\"\n        expand-trigger=\"hover\"\n        :props=\"categoryList\"\n        :show-all-levels=\"false\"\n      />\n      <el-button\n        v-if=\"typeID !== 1\"\n        class=\"mg_r15 mg_t10\"\n        type=\"primary\"\n        @click=\"queryDataListFn\"\n        >查询</el-button\n      >\n      <span class=\"mg_t10\"\n        >已选择商品ID:{{ selectarr.length === 0 ? \"\" : selectarr }}</span\n      >\n    </div>\n    <div class=\"select_view\">\n      <el-table\n        ref=\"table\"\n        border\n        :data=\"dataList\"\n        @select=\"selectionRow\"\n        @select-all=\"handleselectAll\"\n      >\n        <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\n        <el-table-column\n          label=\"ID\"\n          width=\"60px\"\n          align=\"center\"\n          header-align=\"center\"\n        >\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.id }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column\n          label=\"名称\"\n          align=\"center\"\n          min-width=\"350px\"\n          header-align=\"center\"\n        >\n          <template slot-scope=\"scope\">\n            <span>{{ typeID == 1 ? scope.row.name : scope.row.title }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column\n          v-if=\"typeID!==1\"\n          label=\"商品图\"\n          width=\"110\"\n          align=\"center\"\n          header-align=\"center\"\n        >\n          <template slot-scope=\"scope\">\n            <el-image\n              style=\"width: 80px; height: 80px\"\n              :src=\"scope.row.coverImage\"\n              fit=\"cover\"\n              :preview-src-list=\"[scope.row.coverImage]\"\n            />\n          </template>\n        </el-table-column>\n        <el-table-column\n          label=\"商品原价\"\n          align=\"center\"\n          width=\"350px\"\n          header-align=\"center\"\n        >\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.originalPrice || \"-\" }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column\n          label=\"商品价格\"\n          align=\"center\"\n          width=\"350px\"\n          header-align=\"center\"\n        >\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.price }}</span>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"el_pagination\">\n        <el-pagination\n          v-if=\"typeID!==1\"\n          background\n          layout=\"prev, pager, next,total,sizes\"\n          :current-page=\"dataConfig.pageNo\"\n          :total=\"dataConfig.total\"\n          :page-sizes=\"[10, 20, 30, 40, 50]\"\n          :page-size=\"dataConfig.pageSize\"\n          @current-change=\"currentChangeFn\"\n          @size-change=\"handleSizeChange\"\n        />\n      </div>\n      <el-button class=\"\" type=\"primary\" @click=\"submitFn\">确定</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { queryInstallListFn } from \"@/api/install\";\nimport {\n  queryProductFn,\n  queryProductCategoryFn,\n  updateRecommendProduct,\n} from \"@/api/product\";\nexport default {\n  name: \"\",\n  data() {\n    return {\n      typeID: -1,\n      realselectarr: [],\n      selectarr: [],\n      productIds: [],\n      dataList: [],\n      dataConfig: {\n        pageNo: 1,\n        pageSize: 10,\n        total: 0,\n        loading: true,\n      },\n      querydata: {\n        categoryId: \"\", //商品分类id\n      },\n      categoryList: {\n        lazy: true,\n        checkStrictly: true,\n        lazyLoad(node, resolve) {\n          queryProductCategoryFn({\n            pid: node.value || 0,\n          }).then((res) => {\n            const resData = res.data;\n            const nodes = resData.map((item) => ({\n              value: item.id,\n              label: item.name,\n            }));\n            // 通过调用resolve将子节点数据返回，通知组件数据加载完成\n            resolve(nodes);\n          });\n        },\n      },\n    };\n  },\n  beforeMount() {},\n  mounted() {\n    this.typeID = Number(this.$route.query.typeID);\n    if (this.typeID === 1) {\n      this.getinstallproductList();\n    }\n  },\n  computed: {\n    realcategoryId() {\n      if (!this.querydata.categoryId) return false;\n      return this.querydata.categoryId.pop();\n    },\n  },\n  watch: {},\n  methods: {\n    //获取商品\n    getDataListFn() {\n      if (!this.querydata.categoryId && this.typeID === 1)\n        return this.$message.error(\"请选择商品分类\");\n      queryProductFn({\n        pageNo: this.dataConfig.pageNo,\n        pageSize: this.dataConfig.pageSize,\n        categoryId: this.realcategoryId,\n        isShelves: \"\",\n        title: \"\",\n      }).then((res) => {\n        const resData = this.resDataFn(res);\n        this.dataConfig.total = resData.total;\n        resData.records.forEach((item) => {\n          item.isShelves = item.isShelves == 1;\n          let isselect = this.selectarr.indexOf(item.id) !== -1;\n          if (isselect) {\n            this.openselction(item);\n          }\n        });\n        this.dataList.splice(0, this.dataList.length, ...resData.records);\n      });\n    },\n    //获取装机商品\n    getinstallproductList() {\n      queryInstallListFn({\n        name: \"\",\n        pageNo: 1,\n        pageSize: 9999,\n        queryTime: \"\",\n      }).then((ele) => {\n        this.dataList = ele.data.records;\n      });\n    },\n    //查询商品\n    queryDataListFn() {\n      this.dataConfig = {\n        pageNo: 1,\n        pageSize: 10,\n        total: 0,\n        loading: true,\n      };\n      this.getDataListFn();\n    },\n    handleSizeChange(val) {\n      this.dataConfig.pageSize = val;\n      this.getDataListFn();\n    },\n    currentChangeFn(pageNo) {\n      this.dataConfig.pageNo = pageNo;\n      this.getDataListFn();\n    },\n    //判断是否选中\n    openselction(row) {\n      this.$refs.table.toggleRowSelection(row);\n    },\n    //表格单行点击\n    selectionRow(selection, row) {\n      if (this.selectarr.length === 2)\n        return this.$message.error(\"最多选择两个\");\n      let selected = selection.length && selection.indexOf(row) !== -1; //为true时选中，为 0 时（false）未选中\n      if (selected) {\n        this.selectarr.push(row.id);\n      } else {\n        let ind = this.selectarr.indexOf(row.id);\n        if (ind > -1) {\n          this.selectarr.splice(ind, 1);\n        }\n      }\n    },\n    handleselectAll() {\n      this.$message.error(\"最多选择两个\");\n      this.$refs.table.clearSelection();\n    },\n    //提交\n    submitFn() {\n      if (this.selectarr.length === 0) return this.$message.error(\"请选择商品\");\n      if (this.selectarr.length === 1)\n        return this.$message.error(\"至少选择两个商品\");\n      updateRecommendProduct({\n        id: Number(this.$route.query.typeID),\n        productIds: this.selectarr.join(\",\"),\n      }).then((res) => {\n        if (res.code === \"000\") {\n          this.$message.success(\"提交成功\");\n          setTimeout(() => {\n            this.$router.push({ name: \"weixinindexproducttuijianList\" });\n          }, 750);\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.content-view {\n  padding: 20px;\n  background: #fff;\n}\n</style>\n"]}]}