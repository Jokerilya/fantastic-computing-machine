{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\type.vue?vue&type=style&index=0&id=261331d0&lang=less&scoped=true&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\type.vue","mtime":1670564913211},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\@vue\\cli-service\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\style-resources-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi50eXBlVXBsb2FkIHsKICB3aWR0aDogMTUwcHg7CiAgaGVpZ2h0OiAxNTBweDsKICBvdmVyZmxvdzogaGlkZGVuOwp9Cg=="},{"version":3,"sources":["type.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgNA;AACA;AACA;AACA;AACA","file":"type.vue","sourceRoot":"src/views/maintenance","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"select_view\">\n      <el-button icon=\"el-icon-plus\" type=\"primary\" @click=\"addInit()\"\n        >新增</el-button\n      >\n      <!-- <el-button icon=\"el-icon-zoom-in\" type=\"primary\" @click=\"query()\"\n        >查询</el-button\n      > -->\n      <el-button icon=\"el-icon-refresh\" type=\"info\" @click=\"reset()\"\n        >重置</el-button\n      >\n    </div>\n    <div style=\"height: 16px;\"></div>\n    <el-table\n      highlight-current-row\n      v-loading.fullscreen.lock=\"loading\"\n      element-loading-text=\"拼命加载中\"\n      element-loading-spinner=\"el-icon-loading\"\n      :data=\"dataList\"\n      row-key=\"id\"\n      default-expand-all\n      :tree-props=\"{ children: 'list', hasChildren: 'hasChildren' }\"\n      style=\"width: 100%;\"\n    >\n      <!-- <el-table-column type=\"selection\" width=\"45\" show-overflow-tooltip></el-table-column> -->\n      <el-table-column\n        prop=\"id\"\n        label=\"id\"\n        show-overflow-tooltip\n      ></el-table-column>\n\n      <el-table-column\n        prop=\"name\"\n        label=\"名称\"\n        show-overflow-tooltip\n      ></el-table-column>\n      <el-table-column prop=\"imgUrl\" label=\"图片\">\n        <template slot-scope=\"{ row }\">\n          <y-image :src=\"row.imgUrl\" />\n        </template>\n      </el-table-column>\n      <!-- <el-table-column prop=\"isTop\" label=\"是否置顶\" show-overflow-tooltip>\n        <template slot-scope=\"{row}\">\n          <span :class=\"util.global.whetherEnum[row.isTop].class\">\n            {{util.global.whetherEnum[row.isTop].label}}\n          </span>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"status\" label=\"状态\" show-overflow-tooltip>\n        <template slot-scope=\"{row}\">\n          <span :class=\"util.global.StatusEnum[row.status].class\">\n            {{util.global.StatusEnum[row.status].label}}\n          </span>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"createTime\" label=\"创建时间\" show-overflow-tooltip>\n        <template slot-scope=\"{row}\">\n          {{new Date(row.createTime).format('yyyy-MM-dd hh:mm:ss')}}\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"updateTime\" label=\"更新时间\" show-overflow-tooltip>\n        <template slot-scope=\"{row}\">\n          {{new Date(row.updateTime).format('yyyy-MM-dd hh:mm:ss')}}\n        </template>\n      </el-table-column> -->\n      <el-table-column label=\"操作\" width=\"300px\">\n        <template slot-scope=\"{ row }\">\n          <div class=\"settings\">\n            <el-button type=\"warning\" size=\"mini\" plain @click=\"editInit(row)\"\n              >编辑</el-button\n            >\n            <el-button\n              type=\"danger\"\n              size=\"mini\"\n              plain\n              @click=\"delMessage(row.id)\"\n              >删除</el-button\n            >\n          </div>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!-- <el-pagination background @size-change=\"handleSizeChange\" @current-change=\"updatePageNo\"\n      :current-page=\"page.pageNo\" :page-sizes=\"[10, 20, 50, 100]\" :page-size=\"page.dataNum\"\n      layout=\"total, sizes, prev, pager, next, jumper\" :total=\"page.dataSumNum\">\n    </el-pagination> -->\n\n    <model\n      ref=\"addModel\"\n      title=\"新增设备类型\"\n      @ok=\"handleAdd\"\n      @close=\"resetAddForm\"\n    >\n      <el-form\n        :model=\"addForm\"\n        :rules=\"rules\"\n        ref=\"addForm\"\n        status-icon\n        label-width=\"120px\"\n        class=\"demo-ruleForm\"\n      >\n        <el-form-item\n          label=\"设备类型名称\"\n          prop=\"name\"\n          style=\"width:calc(100% - 120px)\"\n        >\n          <el-input\n            type=\"text\"\n            v-model=\"addForm.name\"\n            autocomplete=\"off\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"父级id\"\n          prop=\"pid\"\n          style=\"width:calc(100% - 120px)\"\n        >\n          <el-select v-model.number=\"addForm.pid\" placeholder=\"请选择\">\n            <el-option\n              :label=\"item - 1\"\n              :value=\"item - 1\"\n              :key=\"item - 1\"\n              v-for=\"item in equipmentTypeNum\"\n            ></el-option>\n          </el-select>\n          <!-- <el-input\n            type=\"number\"\n            v-model=\"addForm.pid\"\n            autocomplete=\"off\"\n          ></el-input> -->\n        </el-form-item>\n        <el-form-item label=\"排序\" prop=\"sort\" style=\"width:calc(100% - 120px)\">\n          <el-input\n            type=\"number\"\n            v-model=\"addForm.sort\"\n            autocomplete=\"off\"\n          ></el-input>\n        </el-form-item>\n\n        <el-form-item\n          label=\"设备类型图片\"\n          prop=\"icon\"\n          style=\"width:calc(100% - 120px)\"\n        >\n          <div class=\"typeUpload\">\n            <el-upload\n              action=\"#\"\n              list-type=\"picture-card\"\n              :http-request=\"httpRequest\"\n              :limit=\"1\"\n            >\n              <i class=\"el-icon-plus\"></i>\n            </el-upload>\n          </div>\n        </el-form-item>\n      </el-form>\n    </model>\n\n    <model\n      ref=\"editModel\"\n      title=\"编辑设备类型\"\n      @ok=\"handleEdit\"\n      @close=\"resetEditForm\"\n    >\n      <el-form\n        :model=\"editForm\"\n        :rules=\"rules\"\n        ref=\"editForm\"\n        status-icon\n        label-width=\"120px\"\n        class=\"demo-ruleForm\"\n      >\n        <el-form-item\n          label=\"设备类型名称\"\n          prop=\"name\"\n          style=\"width:calc(100% - 120px)\"\n        >\n          <el-input\n            type=\"text\"\n            v-model=\"editForm.name\"\n            autocomplete=\"off\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"排序\" prop=\"sort\" style=\"width:calc(100% - 120px)\">\n          <el-input\n            type=\"number\"\n            v-model=\"editForm.sort\"\n            autocomplete=\"off\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item\n          label=\"设备类型图片\"\n          prop=\"icon\"\n          style=\"width:calc(100% - 120px)\"\n        >\n          <upload\n            ref=\"editImg\"\n            type=\"image/*\"\n            limit=\"1\"\n            :size=\"1024 ** 2 * 2\"\n          />\n        </el-form-item>\n      </el-form>\n    </model>\n  </div>\n</template>\n<style lang=\"less\" scoped>\n.typeUpload {\n  width: 150px;\n  height: 150px;\n  overflow: hidden;\n}\n</style>\n<script>\nimport { deleteDeviceType, editDeviceType } from \"@/api/order\";\nimport { UploadImg } from \"@/api/system\";\nimport tableMixin from \"@/mixin/table\";\nexport default {\n  name: \"Carousel\",\n  mixins: [tableMixin],\n  data() {\n    return {\n      equipmentTypeNum: null,\n      loading: false,\n      rules: {\n        title: [\n          {\n            required: true,\n            message: \"请输入标题\",\n            trigger: \"blur\",\n          },\n        ],\n        sequence: [\n          {\n            required: true,\n            message: \"请输入排序\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n      addForm: {},\n      url: {\n        query: \"/admin/maintenance/queryDeviceTypeList\",\n        edit: \"/admin//maintenance/editDeviceType\",\n        //   updateStatus:'/admin/edit_carousel_info_status',\n        //   updateTopStatus:'/admin/edit_carousel_info_top'\n      },\n    };\n  },\n  methods: {\n    // 点击删除触发的事件\n    delMessage(id) {\n      this.$confirm(\"此操作将永久删除该文件, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(async () => {\n          const res = await deleteDeviceType(id);\n          if (res.message === \"操作成功\") {\n            this.$message({\n              message: \"删除成功\",\n              type: \"success\",\n            });\n          }\n        })\n        .catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"已取消删除\",\n          });\n        });\n    },\n    // 上传图片的函数\n    async httpRequest(data) {\n      const formData = new FormData();\n      formData.append(\"file\", data.file);\n      const res = await UploadImg(formData);\n      this.addForm.imgUrl = res.data;\n    },\n    query() {\n      this.loading = true;\n      this.$axios\n        .post(this.url.query, {\n          pageNo: this.page.pageNo,\n          pageSize: this.page.dataNum,\n          ...this.searchForm,\n        })\n        .then(({ data }) => {\n          this.dataList = data;\n          this.equipmentTypeNum = data.length + 1;\n        })\n        .catch(function(error) {\n          console.info(error);\n        });\n      this.loading = false;\n    },\n    uploadSucFn(img) {\n      console.info(img);\n    },\n    grantInit() {\n      this.$refs.addModel.open();\n    },\n    handleSubmitForm(fn) {\n      this.$refs.addForm.validate(async (valid) => {\n        if (valid) {\n          if (this.$refs.img.isNull()) {\n            this.$message.error(\"请上传设备类型图片\");\n            return false;\n          }\n          let img = (await this.$refs.img.uploadFile())[0];\n          this.submitForm(fn, {\n            imgUrl: img,\n          });\n          this.$refs.img.reset([]);\n        } else {\n          return false;\n        }\n      });\n    },\n    handleClose(fn) {\n      this.addForm = {};\n      if (fn) fn(false);\n    },\n    addInit() {\n      this.$refs.addModel.open();\n    },\n    handleAdd(fn) {\n      this.$refs.addForm.validate(async (valid) => {\n        if (valid) {\n          const res = await editDeviceType(this.addForm);\n          if (res.message === \"操作成功\") {\n            this.$message({\n              message: \"已添加成功\",\n              type: \"success\",\n            });\n            this.$refs.addModel.close();\n            this.query();\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    resetAddForm(fn) {\n      if (fn) fn(false);\n    },\n    editInit(row) {\n      this.editForm = { ...row };\n      this.$refs.editModel.open();\n      this.$nextTick(() => {\n        this.$refs.editImg.reset(\n          row.imgUrl\n            ? [\n                {\n                  url: this.editForm.imgUrl,\n                },\n              ]\n            : []\n        );\n      });\n    },\n    handleEdit(fn) {\n      this.$refs.editForm.validate(async (valid) => {\n        if (valid) {\n          if (this.$refs.editImg.isNull()) {\n            this.$message.error(\"请上传图标文件\");\n            return false;\n          }\n          let img = (await this.$refs.editImg.uploadFile())[0];\n          this.edit(fn, {\n            imgUrl: img,\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    resetEditForm(fn) {\n      if (fn) fn(false);\n    },\n  },\n};\n</script>\n"]}]}