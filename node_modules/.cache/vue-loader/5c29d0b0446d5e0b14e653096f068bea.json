{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\components\\gdMap\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\components\\gdMap\\index.vue","mtime":1669276636823},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEFNYXBNYW5hZ2VyIH0gZnJvbSAidnVlLWFtYXAiOwpsZXQgYW1hcE1hbmFnZXIgPSBuZXcgQU1hcE1hbmFnZXIoKTsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBvcGVubWFwZGlhbG9nOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICBjb25zdCBzZWxmID0gdGhpczsKICAgIHJldHVybiB7CiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBzZWFyY2hPcHRpb246IHsKICAgICAgICBjaXR5OiAiIiwgLy/mkJzntKLojIPlm7QKICAgICAgICBjaXR5bGltaXQ6IGZhbHNlLCAvL+mZkOWItuaQnOe0ouiMg+WbtAogICAgICAgIC8vY2l0eTogIiIsIGNpdHlsaW1pdDogZmFsc2UsIC8vIOS4jemZkOWItuaQnOe0ouiMg+WbtOaQnOe0ou+8jOavlOWmguaDs+WFqOWbveaQnOe0ogogICAgICB9LAogICAgICBsbmc6ICIiLAogICAgICBsYXQ6ICIiLAogICAgICBhZGRyZXNzOiAiIiwKICAgICAgbWFya2VyOiAiIiwKICAgICAgYW1hcE1hbmFnZXIsCiAgICAgIHpvb206IDEyLAogICAgICBjZW50ZXI6IFsxMTMuNzUxODg0LCAyMy4wMjEwMTZdLAogICAgICBldmVudHM6IHsKICAgICAgICBpbml0OiAobykgPT4gewogICAgICAgICAgby5nZXRDaXR5KChyZXN1bHQpID0+IHsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTsKICAgICAgICAgICAgLy8gdGhpcy5zZWFyY2hPcHRpb24uY2l0eT1yZXN1bHQuY2l0eQogICAgICAgICAgfSk7CiAgICAgICAgICBsZXQgcGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgic2VhcmNoLWJveC13cmFwcGVyIilbMF07CiAgICAgICAgICBwYXIuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoCiAgICAgICAgICAgICJwbGFjZWhvbGRlciIsCiAgICAgICAgICAgICLlnKjov5nph4zovpPlhaXopoHmkJzntKLnmoTlnLDlnYDlk6YiCiAgICAgICAgICApOwogICAgICAgIH0sCiAgICAgICAgbW92ZWVuZDogKCkgPT4ge30sCiAgICAgICAgem9vbWNoYW5nZTogKCkgPT4ge30sCiAgICAgICAgY2xpY2s6IChlKSA9PiB7CiAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKGUubG5nbGF0KTsKICAgICAgICAgIHNlbGYubG5nID0gZS5sbmdsYXQubG5nOwogICAgICAgICAgc2VsZi5sYXQgPSBlLmxuZ2xhdC5sYXQ7CiAgICAgICAgICBzZWxmLmNlbnRlciA9IFtzZWxmLmxuZywgc2VsZi5sYXRdOwogICAgICAgICAgLy8gICBjb25zb2xlLmxvZyhlLmxuZ2xhdCwgMTk5OSk7CgogICAgICAgICAgbGV0IG8gPSBhbWFwTWFuYWdlci5nZXRNYXAoKTsKICAgICAgICAgIGlmICghc2VsZi5tYXJrZXIpIHsKICAgICAgICAgICAgc2VsZi5tYXJrZXIgPSBuZXcgQU1hcC5NYXJrZXIoewogICAgICAgICAgICAgIHBvc2l0aW9uOiBlLmxuZ2xhdCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNlbGYubWFya2VyLnNldE1hcChvKTsKICAgICAgICAgIH0KICAgICAgICAgIHNlbGYubWFya2VyLnNldFBvc2l0aW9uKGUubG5nbGF0KTsKICAgICAgICAgIGxldCBnZW9jb2RlciA9IG5ldyBBTWFwLkdlb2NvZGVyKHt9KTsKCiAgICAgICAgICBnZW9jb2Rlci5nZXRBZGRyZXNzKGUubG5nbGF0LCBmdW5jdGlvbihzdGF0dXMsIHJlc3VsdCkgewogICAgICAgICAgICBpZiAoc3RhdHVzID09PSAiY29tcGxldGUiICYmIHJlc3VsdC5yZWdlb2NvZGUpIHsKICAgICAgICAgICAgICBzZWxmLmFkZHJlc3MgPSByZXN1bHQucmVnZW9jb2RlLmZvcm1hdHRlZEFkZHJlc3M7CiAgICAgICAgICAgICAgLy8gICBjb25zb2xlLmxvZyhzZWxmLmFkZHJlc3MsICI5OTnlnLDlnYAiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBsb2cuZXJyb3IoIuagueaNrue7j+e6rOW6puafpeivouWcsOWdgOWksei0pSIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICB9LAogICAgICBwbHVnaW46IFsKICAgICAgICAiVG9vbEJhciIsCiAgICAgICAgewogICAgICAgICAgcE5hbWU6ICJNYXBUeXBlIiwKICAgICAgICAgIGRlZmF1bHRUeXBlOiAwLAogICAgICAgICAgZXZlbnRzOiB7CiAgICAgICAgICAgIGluaXQobykgewogICAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2cobyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIHBsdWdpbjogWwogICAgICAgIHsKICAgICAgICAgIHBOYW1lOiAiR2VvbG9jYXRpb24iLAogICAgICAgICAgZXZlbnRzOiB7CiAgICAgICAgICAgIGluaXQobykgewogICAgICAgICAgICAgIC8vIG8g5piv6auY5b635Zyw5Zu+5a6a5L2N5o+S5Lu25a6e5L6LCiAgICAgICAgICAgICAgby5nZXRDdXJyZW50UG9zaXRpb24oKHN0YXR1cywgcmVzdWx0KSA9PiB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXN1bHQpKTsKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LnBvc2l0aW9uKSB7CiAgICAgICAgICAgICAgICAgIHNlbGYubG5nID0gcmVzdWx0LnBvc2l0aW9uLmxuZzsKICAgICAgICAgICAgICAgICAgc2VsZi5sYXQgPSByZXN1bHQucG9zaXRpb24ubGF0OwogICAgICAgICAgICAgICAgICBzZWxmLmFkZHJlc3MgPSByZXN1bHQuZm9ybWF0dGVkQWRkcmVzczsKICAgICAgICAgICAgICAgICAgc2VsZi5jZW50ZXIgPSBbc2VsZi5sbmcsIHNlbGYubGF0XTsKICAgICAgICAgICAgICAgICAgLy8gICBjb25zb2xlLmxvZyhzZWxmLmNlbnRlciwgOTk2NjYpOwogICAgICAgICAgICAgICAgICBsZXQgbyA9IGFtYXBNYW5hZ2VyLmdldE1hcCgpOwogICAgICAgICAgICAgICAgICBpZiAoIXNlbGYubWFya2VyKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXJrZXIgPSBuZXcgQU1hcC5NYXJrZXIoewogICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHNlbGYuY2VudGVyLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHNlbGYubWFya2VyLnNldE1hcChvKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzZWxmLm1hcmtlci5zZXRQb3NpdGlvbihzZWxmLmNlbnRlcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgIF0sCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgb25TZWFyY2hSZXN1bHQocG9pcykgewogICAgICBpZiAocG9pcy5sZW5ndGggPiAwKSB7CiAgICAgICAgbGV0IHsgbG5nLCBsYXQsIG5hbWUsIGxvY2F0aW9uIH0gPSBwb2lzWzBdOwogICAgICAgIGxldCBjZW50ZXIgPSBbbG5nLCBsYXRdOwogICAgICAgIHRoaXMubG5nID0gbG5nOwogICAgICAgIHRoaXMubGF0ID0gbGF0OwogICAgICAgIHRoaXMuY2VudGVyID0gW2xuZywgbGF0XTsKICAgICAgICBsZXQgbyA9IGFtYXBNYW5hZ2VyLmdldE1hcCgpOwogICAgICAgIGlmICghdGhpcy5tYXJrZXIpIHsKICAgICAgICAgIHRoaXMubWFya2VyID0gbmV3IEFNYXAuTWFya2VyKHsKICAgICAgICAgICAgcG9zaXRpb246IGNlbnRlciwKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5tYXJrZXIuc2V0TWFwKG8pOwogICAgICAgIH0KICAgICAgICB0aGlzLm1hcmtlci5zZXRQb3NpdGlvbihjZW50ZXIpOwogICAgICAgIC8vIOi/keadpeihpeWFhSAg5qC55o2u57uP57qs5bqm5p+l6K+i5Zyw5Z2ACiAgICAgICAgbGV0IGdlb2NvZGVyID0gbmV3IEFNYXAuR2VvY29kZXIoe30pOwogICAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgICBnZW9jb2Rlci5nZXRBZGRyZXNzKGxvY2F0aW9uLCBmdW5jdGlvbihzdGF0dXMsIHJlc3VsdCkgewogICAgICAgICAgY29uc29sZS5sb2coc3RhdHVzLCByZXN1bHQpOwogICAgICAgICAgaWYgKHN0YXR1cyA9PT0gImNvbXBsZXRlIiAmJiByZXN1bHQucmVnZW9jb2RlKSB7CiAgICAgICAgICAgIHRoYXQuYWRkcmVzcyA9IHJlc3VsdC5yZWdlb2NvZGUuZm9ybWF0dGVkQWRkcmVzczsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLmoLnmja7nu4/nuqzluqbmn6Xor6LlnLDlnYDlpLHotKUiKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8v5ZCR54i257uE5Lu26L+U5Zue5Zyw5Z2ACiAgICByZXR1cm5hZGRyZXNzKCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHRoYXQuJGVtaXQoImdldGFkZHJlc3MiLCB7CiAgICAgICAgYWRkcmVzczogdGhhdC5hZGRyZXNzLAogICAgICAgIGxhdDogdGhhdC5sYXQsCiAgICAgICAgbG5nOiB0aGF0LmxuZywKICAgICAgfSk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoYXQuJGVtaXQoImNsb3NlIik7CiAgICAgIH0sIDIwMCk7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIG9wZW5tYXBkaWFsb2cobmV3dmFsKSB7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IG5ld3ZhbDsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/gdMap","sourcesContent":["<template>\n  <div>\n    <el-dialog\n      title=\"搜索或在地图上点击均可获取地理位置，记得点击确定哦！\"\n      :visible.sync=\"dialogVisible\"\n      width=\"600px\"\n      @close=\"$emit('close')\"\n    >\n      <div class=\"amap-page-container\" style=\"width: 100%; height: 500px\">\n        <el-amap-search-box\n          class=\"search-box\"\n          :search-option=\"searchOption\"\n          :on-search-result=\"onSearchResult\"\n        ></el-amap-search-box>\n        <el-amap\n          ref=\"map\"\n          vid=\"amapDemo\"\n          :amap-manager=\"amapManager\"\n          :center=\"center\"\n          :zoom=\"zoom\"\n          :plugin=\"plugin\"\n          :events=\"events\"\n          class=\"amap-demo\"\n        >\n        </el-amap>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"$emit('close')\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"returnaddress\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport { AMapManager } from \"vue-amap\";\nlet amapManager = new AMapManager();\nexport default {\n  props: {\n    openmapdialog: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    const self = this;\n    return {\n      dialogVisible: false,\n      searchOption: {\n        city: \"\", //搜索范围\n        citylimit: false, //限制搜索范围\n        //city: \"\", citylimit: false, // 不限制搜索范围搜索，比如想全国搜索\n      },\n      lng: \"\",\n      lat: \"\",\n      address: \"\",\n      marker: \"\",\n      amapManager,\n      zoom: 12,\n      center: [113.751884, 23.021016],\n      events: {\n        init: (o) => {\n          o.getCity((result) => {\n            // console.log(result);\n            // this.searchOption.city=result.city\n          });\n          let par = document.getElementsByClassName(\"search-box-wrapper\")[0];\n          par.firstChild.setAttribute(\n            \"placeholder\",\n            \"在这里输入要搜索的地址哦\"\n          );\n        },\n        moveend: () => {},\n        zoomchange: () => {},\n        click: (e) => {\n          //   console.log(e.lnglat);\n          self.lng = e.lnglat.lng;\n          self.lat = e.lnglat.lat;\n          self.center = [self.lng, self.lat];\n          //   console.log(e.lnglat, 1999);\n\n          let o = amapManager.getMap();\n          if (!self.marker) {\n            self.marker = new AMap.Marker({\n              position: e.lnglat,\n            });\n            self.marker.setMap(o);\n          }\n          self.marker.setPosition(e.lnglat);\n          let geocoder = new AMap.Geocoder({});\n\n          geocoder.getAddress(e.lnglat, function(status, result) {\n            if (status === \"complete\" && result.regeocode) {\n              self.address = result.regeocode.formattedAddress;\n              //   console.log(self.address, \"999地址\");\n            } else {\n              log.error(\"根据经纬度查询地址失败\");\n            }\n          });\n        },\n      },\n      plugin: [\n        \"ToolBar\",\n        {\n          pName: \"MapType\",\n          defaultType: 0,\n          events: {\n            init(o) {\n              //   console.log(o);\n            },\n          },\n        },\n      ],\n      plugin: [\n        {\n          pName: \"Geolocation\",\n          events: {\n            init(o) {\n              // o 是高德地图定位插件实例\n              o.getCurrentPosition((status, result) => {\n                // console.log(JSON.stringify(result));\n                if (result && result.position) {\n                  self.lng = result.position.lng;\n                  self.lat = result.position.lat;\n                  self.address = result.formattedAddress;\n                  self.center = [self.lng, self.lat];\n                  //   console.log(self.center, 99666);\n                  let o = amapManager.getMap();\n                  if (!self.marker) {\n                    self.marker = new AMap.Marker({\n                      position: self.center,\n                    });\n                    self.marker.setMap(o);\n                  }\n                  self.marker.setPosition(self.center);\n                }\n              });\n            },\n          },\n        },\n      ],\n    };\n  },\n  methods: {\n    onSearchResult(pois) {\n      if (pois.length > 0) {\n        let { lng, lat, name, location } = pois[0];\n        let center = [lng, lat];\n        this.lng = lng;\n        this.lat = lat;\n        this.center = [lng, lat];\n        let o = amapManager.getMap();\n        if (!this.marker) {\n          this.marker = new AMap.Marker({\n            position: center,\n          });\n          this.marker.setMap(o);\n        }\n        this.marker.setPosition(center);\n        // 近来补充  根据经纬度查询地址\n        let geocoder = new AMap.Geocoder({});\n        let that = this;\n        geocoder.getAddress(location, function(status, result) {\n          console.log(status, result);\n          if (status === \"complete\" && result.regeocode) {\n            that.address = result.regeocode.formattedAddress;\n          } else {\n            console.log(\"根据经纬度查询地址失败\");\n          }\n        });\n      }\n    },\n    //向父组件返回地址\n    returnaddress() {\n      let that = this;\n      that.$emit(\"getaddress\", {\n        address: that.address,\n        lat: that.lat,\n        lng: that.lng,\n      });\n      setTimeout(() => {\n        that.$emit(\"close\");\n      }, 200);\n    },\n  },\n  watch: {\n    openmapdialog(newval) {\n      this.dialogVisible = newval;\n    },\n  },\n};\n</script>\n<style scoped>\n.search-box {\n  position: absolute;\n  top: 25px;\n  left: 20px;\n}\n.amap-page-container {\n  position: relative;\n  z-index: 99999;\n}\n.el-dialog__wrapper /deep/ .el-dialog .el-dialog__header {\n  background-color: #f2f2f2;\n}\n.el-dialog__wrapper /deep/ .el-dialog .el-dialog__header .el-dialog__title {\n  color: #333;\n  font-size: 14px;\n}\n</style>\n"]}]}