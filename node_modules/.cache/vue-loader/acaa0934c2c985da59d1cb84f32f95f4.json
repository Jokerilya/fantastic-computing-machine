{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\system\\setup-role\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\system\\setup-role\\index.vue","mtime":1669258939335},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHJvbGVEZXRhaWxGbiwgYWRkT3JVcGRhdGVSb2xlRm4sIG1lbnVUcmVlTGlzdEZuLCByb2xlTGlzdEZuLCByb2xlUmVtb3ZlRm4sIGhhbmRsZVJvbGVTdGF0dXNGbiB9IGZyb20gJ0AvYXBpL3N5c3RlbS5qcycKaW1wb3J0IHsgbWFwR2V0dGVycywgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2V0dXBSb2xlJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YUxpc3Q6IFtdLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgdHJlZUxpc3Q6IFtdLAogICAgICBjaGVja2VkUm93SW5kZXg6IDAsCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGxhYmVsOiAoZGF0YSwgbm9kZSkgPT4gewogICAgICAgICAgcmV0dXJuIGAke2RhdGEubmFtZX0oSUQ6JHtkYXRhLmlkfSlgCiAgICAgICAgfSwKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJwogICAgICB9LAogICAgICBlZGl0RGF0YTogewogICAgICAgICdkZXNjcmlwdGlvbic6ICcnLAogICAgICAgICdpZCc6ICcnLAogICAgICAgICdpc0FkbWluJzogJycsCiAgICAgICAgJ21lbnVJZHMnOiBbXSwKICAgICAgICAnbmFtZSc6ICcnLAogICAgICAgICdzdGF0dXMnOiB0cnVlCiAgICAgIH0sCiAgICAgIGRhdGFDb25maWc6IHsKICAgICAgICAncGFnZU5vJzogMSwKICAgICAgICAncGFnZVNpemUnOiA1MCwKICAgICAgICAndG90YWwnOiAwLAogICAgICAgICdsb2FkaW5nJzogdHJ1ZQogICAgICB9CiAgICB9CiAgfSwKICBiZWZvcmVNb3VudCgpIHsKICAgIHRoaXNbJ3VzZXIvYWN0aW9uTWVudWxpc3QnXSh7IG1lbnVUeXBlOiAtMSB9KS50aGVuKCgpID0+IHsKICAgICAgdGhpcy5yb2xlTGlzdEZuKCkKICAgIH0pCiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ21lbnVUcmVlTGlzdCddKQogIH0sCiAgbWV0aG9kczogewogICAgLi4ubWFwQWN0aW9ucyhbJ3VzZXIvYWN0aW9uTWVudWxpc3QnXSksCiAgICBjaGVja0NoYW5nZUZuKGRhdGEsIHNlbGZDaGVja2VkLCBjaGxpZENoZWNrZWQpIHsKICAgICAgaWYgKHNlbGZDaGVja2VkKSB7CiAgICAgICAgY29uc29sZS5sb2coZGF0YS5wYXJlbnRJZCkKICAgICAgICBpZiAoZGF0YS5wYXJlbnRJZCAhPSAwKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZChkYXRhLnBhcmVudElkLCB0cnVlKQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNoZWNrQ2hpbGRyZW4oZGF0YSkKICAgICAgfQogICAgfSwKICAgIGNoZWNrQ2hpbGRyZW4oZGF0YSkgewogICAgICBkYXRhLmNoaWxkcmVuLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICB0aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZChpdGVtLmlkLCBmYWxzZSkKICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMuY2hlY2tDaGlsZHJlbihpdGVtKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBnZXRDaGVja2VkS2V5c0ZuKCkgewogICAgICBjb25zdCBpZHMgPSB0aGlzLiRyZWZzLnRyZWUuZ2V0Q2hlY2tlZEtleXMoKQogICAgICB0aGlzLmRhdGFMaXN0W3RoaXMuY2hlY2tlZFJvd0luZGV4XS5tZW51SWRzLnNwbGljZSgwLCB0aGlzLmRhdGFMaXN0W3RoaXMuY2hlY2tlZFJvd0luZGV4XS5tZW51SWRzLmxlbmd0aCwgLi4uaWRzKQogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZQogICAgfSwKICAgIGNoZWNrTWVudUZuKHNjb3ApIHsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgICB0aGlzLmNoZWNrZWRSb3dJbmRleCA9IHNjb3AuJGluZGV4CiAgICAgIHRoaXMudHJlZUxpc3Quc3BsaWNlKDAsIHRoaXMudHJlZUxpc3QubGVuZ3RoLCAuLi5zY29wLnJvdy50cmVlTGlzdCkKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnMudHJlZS5zZXRDaGVja2VkS2V5cyhzY29wLnJvdy5tZW51SWRzKQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuZGF0YUNvbmZpZy5wYWdlU2l6ZSA9IHZhbAogICAgICB0aGlzLnJvbGVMaXN0Rm4oKQogICAgfSwKICAgIGN1cnJlbnRDaGFuZ2VGbihwYWdlTm8pIHsKICAgICAgdGhpcy5kYXRhQ29uZmlnLnBhZ2VObyA9IHBhZ2VObwogICAgICB0aGlzLnJvbGVMaXN0Rm4oKQogICAgfSwKICAgIGFkZERhdGFGbigpIHsKICAgICAgdGhpcy5lZGl0RGF0YSA9IHsKICAgICAgICAnZGVzY3JpcHRpb24nOiAnJywKICAgICAgICAnaWQnOiAnJywKICAgICAgICAnaXNBZG1pbic6ICcnLAogICAgICAgICdtZW51SWRzJzogW10sCiAgICAgICAgJ25hbWUnOiAnJywKICAgICAgICAnc3RhdHVzJzogdHJ1ZQogICAgICB9CiAgICAgIHRoaXMuZGF0YUxpc3QudW5zaGlmdChPYmplY3QuYXNzaWduKHt9LCB0aGlzLmVkaXREYXRhLCB7IHRyZWVMaXN0OiB0aGlzLm1lbnVUcmVlTGlzdCB9KSkKICAgIH0sCiAgICBkZWxldGVBZGRGbihpbmRleCkgewogICAgICB0aGlzLmRhdGFMaXN0LnNwbGljZShpbmRleCwgMSkKICAgIH0sCiAgICBzdGF0dXNDaGFuZ2VGbih2YWwsIGluZGV4KSB7CiAgICAgIGNvbnNvbGUubG9nKHZhbCkKICAgICAgaGFuZGxlUm9sZVN0YXR1c0ZuKHsKICAgICAgICBpZDogdGhpcy5kYXRhTGlzdFtpbmRleF0uaWQsCiAgICAgICAgc3RhdHVzOiB2YWwgPyAxIDogMAogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLmNvZGUgPT0gJzAwMCcpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfmk43kvZzmiJDlip/vvIEnLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZGF0YUxpc3RbaW5kZXhdLnN0YXR1cyA9ICF2YWwKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLmRhdGFMaXN0W2luZGV4XS5zdGF0dXMgPSAhdmFsCiAgICAgIH0pCiAgICB9LAogICAgZWRpdERhdGFGbih2YWwpIHsKICAgICAgaWYgKCF2YWwubmFtZSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+Whq+WGmeinkuiJsuWQjeensO+8gScsCiAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGlmICh2YWwubWVudUlkcy5sZW5ndGggPT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeinkuiJsuadg+mZkOiPnOWNle+8gScsCiAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGFkZE9yVXBkYXRlUm9sZUZuKHsKICAgICAgICAnZGVzY3JpcHRpb24nOiB2YWwuZGVzY3JpcHRpb24sCiAgICAgICAgJ2lkJzogdmFsLmlkLAogICAgICAgICdpc0FkbWluJzogdmFsLmlzQWRtaW4sCiAgICAgICAgJ21lbnVJZHMnOiB2YWwubWVudUlkcy5zbGljZSgpLAogICAgICAgICduYW1lJzogdmFsLm5hbWUKICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc3QgcmVzRGF0YSA9IHRoaXMucmVzRGF0YUZuKHJlcykKICAgICAgICBpZiAocmVzRGF0YSA9PSAnMDAwJykgewogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogJ+aTjeS9nOaIkOWKn++8gScsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMucm9sZUxpc3RGbigpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGRlbGV0ZUZuKHNjb3BlKSB7CiAgICAgIHRoaXMuZGVsZXRlQWxlcnQoKS50aGVuKCgpID0+IHsKICAgICAgICBjb25zdCByZXMgPSByb2xlUmVtb3ZlRm4oeyBpZDogc2NvcGUucm93LmlkIH0pCiAgICAgICAgcmV0dXJuIHJlcwogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBjb25zdCByZXNEYXRhID0gdGhpcy5yZXNEYXRhRm4ocmVzKQogICAgICAgIGlmIChyZXNEYXRhID09ICcwMDAnKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiAn5pON5L2c5oiQ5Yqf77yBJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICB9KQogICAgICAgICAgdGhpcy5kYXRhTGlzdC5zcGxpY2Uoc2NvcGUuJGluZGV4LCAxKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBtZW51Um91dGVLTGlzdChsaXN0KSB7CiAgICAgIGNvbnN0IHJlc0FyciA9IFtdCiAgICAgIGNvbnN0IGZvckVhY2hBcnJGbiA9IGZ1bmN0aW9uKGFycikgewogICAgICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICBpdGVtLmlkICYmIHJlc0Fyci5wdXNoKGl0ZW0uaWQpCiAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGl0ZW0uY2hpbGRyZW4pID09ICdbb2JqZWN0IEFycmF5XScpIHsKICAgICAgICAgICAgZm9yRWFjaEFyckZuKGl0ZW0uY2hpbGRyZW4pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfQogICAgICBmb3JFYWNoQXJyRm4obGlzdCkKICAgICAgcmV0dXJuIHJlc0FycgogICAgfSwKICAgIG1lbnVUcmVlTGlzdEZuKCkgewogICAgICB0aGlzLmRhdGFMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgaXRlbS5zdGF0dXMgPSBpdGVtLnN0YXR1cyA9PSAxCiAgICAgICAgaWYgKGl0ZW0uaWQpIHsKICAgICAgICAgIG1lbnVUcmVlTGlzdEZuKHsgaWQ6IGl0ZW0uaWQgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlc0RhdGEgPSB0aGlzLnJlc0RhdGFGbihyZXMpCiAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmRhdGFMaXN0LCBpbmRleCwgT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwgewogICAgICAgICAgICAgIG1lbnVJZHM6IHRoaXMubWVudVJvdXRlS0xpc3QocmVzRGF0YSkKICAgICAgICAgICAgfSkpCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICByb2xlTGlzdEZuKCkgewogICAgICByb2xlTGlzdEZuKHsKICAgICAgICBwYWdlTm86IHRoaXMuZGF0YUNvbmZpZy5wYWdlTm8sCiAgICAgICAgcGFnZVNpemU6IHRoaXMuZGF0YUNvbmZpZy5wYWdlU2l6ZQogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBjb25zdCByZXNEYXRhID0gdGhpcy5yZXNEYXRhRm4ocmVzKQogICAgICAgIHJlc0RhdGEucmVjb3Jkcy5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICBpdGVtLnRyZWVMaXN0ID0gdGhpcy5tZW51VHJlZUxpc3QKICAgICAgICB9KQogICAgICAgIHRoaXMuZGF0YUxpc3Quc3BsaWNlKDAsIHRoaXMuZGF0YUxpc3QubGVuZ3RoLCAuLi5yZXNEYXRhLnJlY29yZHMpCiAgICAgICAgdGhpcy5kYXRhQ29uZmlnLnRvdGFsID0gcmVzRGF0YS50b3RhbAogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZGF0YUxpc3QpCiAgICAgICAgdGhpcy5tZW51VHJlZUxpc3RGbigpCiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/system/setup-role","sourcesContent":["<template>\n  <div class=\"content_box\">\n    <first-title title=\"角色管理\" />\n    <div class=\"select_view\">\n      <el-button type=\"primary\" @click=\"addDataFn\"><i class=\"el-icon-plus\" />添加角色</el-button>\n      <span class=\"mg_l15\" style=\"color: #F56C6C;\">注意：“修改”和“添加”系统角色项目后需要点击右侧“提交编辑”按钮才会生效哦</span>\n    </div>\n    <el-table\n      v-loading=\"dataConfig.loading\"\n      border\n      :data=\"dataList\"\n      class=\"list\"\n    >\n      <el-table-column label=\"角色ID\" width=\"70px\">\n        <template slot-scope=\"scope\">\n          <span v-if=\"scope.row.id\">{{ scope.row.id }}</span>\n          <span v-if=\"!scope.row.id\" class=\"delete_icon\" @click=\"deleteAddFn(scope.$index)\"><i class=\"el-icon-delete\" /></span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"角色名称\">\n        <template slot-scope=\"scope\">\n          <el-input v-model=\"scope.row.name\" placeholder=\"请输入角色名称\" />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"角色描述\">\n        <template slot-scope=\"scope\">\n          <el-input v-model=\"scope.row.description\" placeholder=\"请输入角色描述\" />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"角色权限菜单\" style=\"width: 100px;\">\n        <template slot-scope=\"scope\">\n          <!-- <el-input v-model=\"scope.row.menuIds\" style=\"width: 400px;\" placeholder=\"请输入角色权限菜单ID或点击右侧按钮选择\" /> -->\n          <el-tooltip class=\"item\" effect=\"dark\" placement=\"bottom\">\n            <div slot=\"content\" style=\"width: 400px;line-height: 1.6em;\">\n              <p style=\"margin-bottom: 10px;\">已选权限ID</p>\n              <p>{{ scope.row.menuIds && scope.row.menuIds.join(',') }}</p>\n            </div>\n            <el-button type=\"primary\" plain=\"\" size=\"small\" @click=\"checkMenuFn(scope)\">点击选择菜单</el-button>\n          </el-tooltip>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"状态(禁用/启用)\">\n        <template slot-scope=\"scope\">\n          <el-switch v-model=\"scope.row.status\" :disabled=\"scope.row.id == ''\" @change=\"statusChangeFn($event,scope.$index)\" />\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" width=\"240px\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" size=\"small\" @click=\"editDataFn(scope.row)\">提交编辑</el-button>\n          <el-button v-if=\"scope.row.id\" type=\"danger\" size=\"small\" @click=\"deleteFn(scope)\"><i class=\"el-icon-delete\" />删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"el_pagination\">\n      <el-pagination\n        background\n        layout=\"prev, pager, next,total,sizes\"\n        :current-page=\"dataConfig.pageNo\"\n        :total=\"dataConfig.total\"\n        :page-sizes=\"[20, 30, 40, 50]\"\n        @current-change=\"currentChangeFn\"\n        @size-change=\"handleSizeChange\"\n      />\n    </div>\n    <el-dialog\n      title=\"权限菜单配置\"\n      :visible.sync=\"dialogVisible\"\n      width=\"50%\"\n    >\n      <el-tree\n        ref=\"tree\"\n        :props=\"defaultProps\"\n        :data=\"treeList\"\n        :check-strictly=\"true\"\n        node-key=\"id\"\n        :default-checked-keys=\"[]\"\n        show-checkbox\n        @check-change=\"checkChangeFn\"\n      />\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"getCheckedKeysFn\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { roleDetailFn, addOrUpdateRoleFn, menuTreeListFn, roleListFn, roleRemoveFn, handleRoleStatusFn } from '@/api/system.js'\nimport { mapGetters, mapActions } from 'vuex'\nexport default {\n  name: 'SetupRole',\n  data() {\n    return {\n      dataList: [],\n      dialogVisible: false,\n      treeList: [],\n      checkedRowIndex: 0,\n      defaultProps: {\n        label: (data, node) => {\n          return `${data.name}(ID:${data.id})`\n        },\n        children: 'children'\n      },\n      editData: {\n        'description': '',\n        'id': '',\n        'isAdmin': '',\n        'menuIds': [],\n        'name': '',\n        'status': true\n      },\n      dataConfig: {\n        'pageNo': 1,\n        'pageSize': 50,\n        'total': 0,\n        'loading': true\n      }\n    }\n  },\n  beforeMount() {\n    this['user/actionMenulist']({ menuType: -1 }).then(() => {\n      this.roleListFn()\n    })\n  },\n  computed: {\n    ...mapGetters(['menuTreeList'])\n  },\n  methods: {\n    ...mapActions(['user/actionMenulist']),\n    checkChangeFn(data, selfChecked, chlidChecked) {\n      if (selfChecked) {\n        console.log(data.parentId)\n        if (data.parentId != 0) {\n          this.$refs.tree.setChecked(data.parentId, true)\n        }\n      } else {\n        this.checkChildren(data)\n      }\n    },\n    checkChildren(data) {\n      data.children.forEach((item) => {\n        this.$refs.tree.setChecked(item.id, false)\n        if (item.children && item.children.length > 0) {\n          this.checkChildren(item)\n        }\n      })\n    },\n    getCheckedKeysFn() {\n      const ids = this.$refs.tree.getCheckedKeys()\n      this.dataList[this.checkedRowIndex].menuIds.splice(0, this.dataList[this.checkedRowIndex].menuIds.length, ...ids)\n      this.dialogVisible = false\n    },\n    checkMenuFn(scop) {\n      this.dialogVisible = true\n      this.checkedRowIndex = scop.$index\n      this.treeList.splice(0, this.treeList.length, ...scop.row.treeList)\n      this.$nextTick(() => {\n        this.$refs.tree.setCheckedKeys(scop.row.menuIds)\n      })\n    },\n    handleSizeChange(val) {\n      this.dataConfig.pageSize = val\n      this.roleListFn()\n    },\n    currentChangeFn(pageNo) {\n      this.dataConfig.pageNo = pageNo\n      this.roleListFn()\n    },\n    addDataFn() {\n      this.editData = {\n        'description': '',\n        'id': '',\n        'isAdmin': '',\n        'menuIds': [],\n        'name': '',\n        'status': true\n      }\n      this.dataList.unshift(Object.assign({}, this.editData, { treeList: this.menuTreeList }))\n    },\n    deleteAddFn(index) {\n      this.dataList.splice(index, 1)\n    },\n    statusChangeFn(val, index) {\n      console.log(val)\n      handleRoleStatusFn({\n        id: this.dataList[index].id,\n        status: val ? 1 : 0\n      }).then((res) => {\n        if (res.code == '000') {\n          this.$message({\n            showClose: true,\n            message: '操作成功！',\n            type: 'success'\n          })\n        } else {\n          this.dataList[index].status = !val\n        }\n      }).catch(() => {\n        this.dataList[index].status = !val\n      })\n    },\n    editDataFn(val) {\n      if (!val.name) {\n        this.$message({\n          showClose: true,\n          message: '请填写角色名称！',\n          type: 'warning'\n        })\n        return\n      }\n      if (val.menuIds.length == 0) {\n        this.$message({\n          showClose: true,\n          message: '请选择角色权限菜单！',\n          type: 'warning'\n        })\n        return\n      }\n      addOrUpdateRoleFn({\n        'description': val.description,\n        'id': val.id,\n        'isAdmin': val.isAdmin,\n        'menuIds': val.menuIds.slice(),\n        'name': val.name\n      }).then((res) => {\n        const resData = this.resDataFn(res)\n        if (resData == '000') {\n          this.$message({\n            showClose: true,\n            message: '操作成功！',\n            type: 'success'\n          })\n          this.roleListFn()\n        }\n      })\n    },\n    deleteFn(scope) {\n      this.deleteAlert().then(() => {\n        const res = roleRemoveFn({ id: scope.row.id })\n        return res\n      }).then((res) => {\n        const resData = this.resDataFn(res)\n        if (resData == '000') {\n          this.$message({\n            showClose: true,\n            message: '操作成功！',\n            type: 'success'\n          })\n          this.dataList.splice(scope.$index, 1)\n        }\n      })\n    },\n    menuRouteKList(list) {\n      const resArr = []\n      const forEachArrFn = function(arr) {\n        arr.forEach((item) => {\n          item.id && resArr.push(item.id)\n          if (Object.prototype.toString.call(item.children) == '[object Array]') {\n            forEachArrFn(item.children)\n          }\n        })\n      }\n      forEachArrFn(list)\n      return resArr\n    },\n    menuTreeListFn() {\n      this.dataList.forEach((item, index) => {\n        item.status = item.status == 1\n        if (item.id) {\n          menuTreeListFn({ id: item.id }).then((res) => {\n            const resData = this.resDataFn(res)\n            this.$set(this.dataList, index, Object.assign({}, item, {\n              menuIds: this.menuRouteKList(resData)\n            }))\n          })\n        }\n      })\n    },\n    roleListFn() {\n      roleListFn({\n        pageNo: this.dataConfig.pageNo,\n        pageSize: this.dataConfig.pageSize\n      }).then((res) => {\n        const resData = this.resDataFn(res)\n        resData.records.forEach((item) => {\n          item.treeList = this.menuTreeList\n        })\n        this.dataList.splice(0, this.dataList.length, ...resData.records)\n        this.dataConfig.total = resData.total\n        console.log(this.dataList)\n        this.menuTreeListFn()\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .content_box{\n    .el-tree-node{\n      margin: 15px 0;\n    }\n  }\n</style>\n"]}]}