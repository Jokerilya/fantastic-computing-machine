{"remainingRequest":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\agentOrder.vue?vue&type=style&index=0&id=1a698842&lang=less&scoped=true&","dependencies":[{"path":"D:\\机将公司\\机将后台端\\background-management-system\\src\\views\\maintenance\\agentOrder.vue","mtime":1676860434081},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\@vue\\cli-service\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\style-resources-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\机将公司\\机将后台端\\background-management-system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQovLyDmoIfpopjmoLflvI8NCi5sYWJlbFN0eWxlIHsNCiAgd2lkdGg6IDEwMHB4Ow0KICBjb2xvcjogIzcwNzA3MDsNCiAgZm9udC13ZWlnaHQ6IDcwMDsNCn0NCi5pbnAgew0KICB3aWR0aDogMjUwcHg7DQp9DQoNCi5hZ2VudE9yZGVyIHsNCiAgcGFkZGluZzogMjVweCA0MHB4Ow0KICAvLyDku6PkuIvljZXpnIDopoHnmoTkv6Hmga8NCiAgLmFnZW50T3JkZXJfaW5mbyB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgICAuaW5mb190b3Agew0KICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgIHBhZGRpbmc6IDAgMTAwcHg7DQogICAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgICAgLml0ZW0gew0KICAgICAgICBmbGV4OiAxOw0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgfQ0KICAgIH0NCiAgICAudHdvSGVpZ2h0IHsNCiAgICAgIGhlaWdodDogMjUwcHg7DQogICAgfQ0KICAgIC5pbmZvX3VuZGVyIHsNCiAgICAgIG1hcmdpbi10b3A6IDIwcHg7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgcGFkZGluZzogMCAxMDBweDsNCg0KICAgICAgLml0ZW0gew0KICAgICAgICBmbGV4OiAxOw0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgfQ0KICAgICAgLml0ZW0xIHsNCiAgICAgICAgZmxleDogMTsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgcGFkZGluZy1yaWdodDogMjBweDsNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgLy8g5bel5YW35qCPDQogIC5hZ2VudE9yZGVyX3Rvb2wgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsNCiAgICAuYnRuIHsNCiAgICAgIHdpZHRoOiAxNjBweDsNCiAgICAgIGhlaWdodDogNDBweDsNCiAgICB9DQogICAgLmJ0bjEgew0KICAgICAgY29sb3I6ICMyZTRjOWU7DQogICAgfQ0KICAgIC5idG4yIHsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyZTRjOWU7DQogICAgICBjb2xvcjogI2ZmZjsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["agentOrder.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"agentOrder.vue","sourceRoot":"src/views/maintenance","sourcesContent":["<!-- 代下单页面 -->\r\n<template>\r\n  <div class=\"agentOrder\">\r\n    <!-- 代下单需要的信息 -->\r\n    <div class=\"agentOrder_info\">\r\n      <el-card>\r\n        <div class=\"info_top\">\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">设备类型</div>\r\n            <el-cascader\r\n              :show-all-levels=\"false\"\r\n              v-model=\"typeValue\"\r\n              :options=\"typeOptions\"\r\n              :props=\"{ value: 'id', label: 'name', children: 'list' }\"\r\n            ></el-cascader>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">设备品牌</div>\r\n            <el-input\r\n              placeholder=\"请输入设备品牌\"\r\n              class=\"inp\"\r\n              v-model=\"data.deviceBrand\"\r\n            ></el-input>\r\n          </div>\r\n        </div>\r\n        <div class=\"info_top\">\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">设备系统</div>\r\n            <el-cascader\r\n              :show-all-levels=\"false\"\r\n              v-model=\"systemValue\"\r\n              :options=\"systemOptions\"\r\n              :props=\"{ value: 'id', label: 'name', children: 'list' }\"\r\n            ></el-cascader>\r\n            <!-- <el-select\r\n              placeholder=\"请选择\"\r\n              class=\"inp\"\r\n              v-model=\"data.deviceSystemId\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in deviceSystemList\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\"\r\n              >\r\n              </el-option>\r\n            </el-select> -->\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">设备数量</div>\r\n            <el-input\r\n              placeholder=\"请输入设备数量\"\r\n              class=\"inp\"\r\n              v-model.number=\"data.num\"\r\n            ></el-input>\r\n          </div>\r\n        </div>\r\n\r\n        <hr color=\"#ebebeb\" />\r\n\r\n        <div class=\"info_under\">\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">设备产地</div>\r\n            <el-radio v-model=\"data.devicePlace\" label=\"国产\">国产</el-radio>\r\n            <el-radio v-model=\"data.devicePlace\" label=\"进口\">进口</el-radio>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">故障类型</div>\r\n            <el-checkbox-group v-model=\"checkList\">\r\n              <el-checkbox label=\"1\">机械故障</el-checkbox>\r\n              <el-checkbox label=\"2\">电气故障</el-checkbox>\r\n              <el-checkbox label=\"3\">系统故障</el-checkbox>\r\n            </el-checkbox-group>\r\n          </div>\r\n        </div>\r\n        <div class=\"info_under twoHeight\">\r\n          <div class=\"item1\">\r\n            <div class=\"labelStyle\">故障描述</div>\r\n            <el-input\r\n              type=\"textarea\"\r\n              :rows=\"10\"\r\n              placeholder=\"请输入设备故障情况，异常，损坏原因等内容，方便师傅准确判断问题，准备工具，携带配件。\"\r\n              v-model=\"data.simpleDesc\"\r\n              resize=\"none\"\r\n              maxlength=\"500\"\r\n              show-word-limit\r\n            >\r\n            </el-input>\r\n          </div>\r\n          <div style=\"flex: 1;\">\r\n            <div style=\"color: #707070;font-weight: 700;margin-bottom: 20px;\">\r\n              上传设备图片视频、故障部位图片视频(最多上传6张图片或视频)\r\n            </div>\r\n            <el-upload\r\n              :limit=\"6\"\r\n              action=\"#\"\r\n              list-type=\"text\"\r\n              :http-request=\"handlePictureCardPreview\"\r\n              :on-remove=\"onRemovePictureCardPreview\"\r\n            >\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n          </div>\r\n        </div>\r\n        <div class=\"info_under\">\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\" style=\"margin-right: 20px;\">\r\n              服务期望日期\r\n            </div>\r\n            <el-date-picker\r\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n              v-model=\"data.serviceTime\"\r\n              type=\"datetime\"\r\n              placeholder=\"请选择预计服务日期\"\r\n            >\r\n            </el-date-picker>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">紧急程度</div>\r\n            <el-radio v-model=\"data.degree\" :label=\"1\">一般</el-radio>\r\n            <el-radio v-model=\"data.degree\" :label=\"2\">紧急</el-radio>\r\n          </div>\r\n        </div>\r\n        <div class=\"info_under\">\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">公司名称</div>\r\n            <el-input\r\n              placeholder=\"请输入公司名称\"\r\n              v-model=\"data.enterpriseName\"\r\n              class=\"inp\"\r\n            ></el-input>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">联系人</div>\r\n            <el-input\r\n              placeholder=\"请输入联系人姓名\"\r\n              class=\"inp\"\r\n              v-model=\"data.contactsPeople\"\r\n            ></el-input>\r\n          </div>\r\n        </div>\r\n        <div class=\"info_under\">\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">联系地址</div>\r\n            <el-input\r\n              placeholder=\"请输入联系地址\"\r\n              class=\"inp\"\r\n              v-model=\"data.address\"\r\n            ></el-input>\r\n          </div>\r\n          <div class=\"item\">\r\n            <div class=\"labelStyle\">联系电话</div>\r\n            <el-input\r\n              @blur=\"phoneCheck\"\r\n              placeholder=\"请输入联系人电话\"\r\n              class=\"inp\"\r\n              v-model.number=\"data.contactsPhone\"\r\n            ></el-input>\r\n          </div>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n    <!-- 底部工具栏 -->\r\n    <div class=\"agentOrder_tool\">\r\n      <el-button class=\"btn btn1\">取消</el-button>\r\n      <el-button class=\"btn btn2\" @click=\"confirmFn\">提交订单</el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  agentCreateOrder,\r\n  queryDeviceSystemList,\r\n  queryDeviceTypeList,\r\n} from \"@/api/order\";\r\nimport { UploadImg } from \"@/api/system\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      typeValue: null,\r\n      typeOptions: null,\r\n      systemValue: null,\r\n      systemOptions: null,\r\n      originallyImgList: [],\r\n\r\n      deviceTypeList: [], // 设备类型\r\n      deviceSystemList: [], //设备系统\r\n      checkList: [],\r\n      dialogImageUrl: [],\r\n      dialogVisible: false,\r\n\r\n      data: {\r\n        address: \"\",\r\n        contactsPeople: \"\",\r\n        contactsPhone: \"\",\r\n        degree: null,\r\n        deviceBrand: \"\",\r\n        devicePlace: \"\",\r\n        deviceSystemId: null,\r\n        deviceTypeId: null,\r\n        enterpriseName: \"\",\r\n        images: \"\",\r\n        num: null,\r\n        serviceTime: \"\",\r\n        simpleDesc: \"\",\r\n        type: \"\",\r\n        uid: \"\",\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    // 移除图片的事件\r\n    onRemovePictureCardPreview(file) {\r\n      const index = this.originallyImgList.findIndex((el) => el === file.name);\r\n      this.originallyImgList.splice(index, 1);\r\n      this.dialogImageUrl.splice(index, 1);\r\n    },\r\n    // 判断手机号码格式\r\n    phoneCheck() {\r\n      if (!/^1[3456789]\\d{9}$/.test(this.data.contactsPhone)) {\r\n        this.$message({\r\n          message: \"手机号码格式不对\",\r\n          type: \"warning\",\r\n        });\r\n        this.data.contactsPhone = \"\";\r\n      }\r\n    },\r\n    // 修改一下 data.type 数据类型\r\n    checkType(arr) {\r\n      let str = \"\";\r\n      arr.forEach((el, index) => {\r\n        if (index !== 0) {\r\n          str = str + \",\" + el;\r\n        } else {\r\n          str = str + el;\r\n        }\r\n      });\r\n      if (arr === this.checkList) {\r\n        this.data.type = str;\r\n      } else {\r\n        this.data.images = str;\r\n      }\r\n    },\r\n    // 点击提交订单\r\n    async confirmFn() {\r\n      if (\r\n        this.typeValue &&\r\n        this.data.deviceBrand &&\r\n        this.systemValue &&\r\n        this.data.num &&\r\n        this.data.devicePlace &&\r\n        this.checkList.length !== 0 &&\r\n        this.data.simpleDesc &&\r\n        this.originallyImgList.length !== 0 &&\r\n        this.data.serviceTime &&\r\n        this.data.degree &&\r\n        this.data.enterpriseName &&\r\n        this.data.contactsPeople &&\r\n        this.data.address &&\r\n        this.data.contactsPhone\r\n      ) {\r\n        const loading = this.$loading();\r\n        this.data.deviceTypeId = this.typeValue[1];\r\n        this.data.deviceSystemId = this.systemValue[1];\r\n        await this.checkType(this.checkList);\r\n        await this.checkType(this.dialogImageUrl);\r\n        const res = await agentCreateOrder(this.data);\r\n        if (res.message === \"操作成功\") {\r\n          this.$message({\r\n            showClose: true,\r\n            message: \"操作成功\",\r\n            type: \"success\",\r\n          });\r\n          this.$router.push(\"/maintenance/maintenance_order\");\r\n          loading.close();\r\n        }\r\n      } else {\r\n        this.$message({\r\n          message: \"信息全是必填,请完善!!\",\r\n          type: \"warning\",\r\n        });\r\n      }\r\n    },\r\n    // 处理图片\r\n    async handlePictureCardPreview(data) {\r\n      let loading = this.$loading({\r\n        text: \"文件正在上传中,请耐心等待...\",\r\n      });\r\n      this.originallyImgList.push(data.file.name);\r\n      const formData = new FormData();\r\n      formData.append(\"file\", data.file);\r\n      const res = await UploadImg(formData);\r\n      this.dialogImageUrl.push(res.data);\r\n      loading.close();\r\n    },\r\n  },\r\n  async created() {\r\n    const loading = this.$loading();\r\n    const list = await queryDeviceTypeList();\r\n    const list1 = await queryDeviceSystemList();\r\n    this.typeOptions = list.data;\r\n    this.systemOptions = list1.data;\r\n    loading.close();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n// 标题样式\r\n.labelStyle {\r\n  width: 100px;\r\n  color: #707070;\r\n  font-weight: 700;\r\n}\r\n.inp {\r\n  width: 250px;\r\n}\r\n\r\n.agentOrder {\r\n  padding: 25px 40px;\r\n  // 代下单需要的信息\r\n  .agentOrder_info {\r\n    margin-bottom: 20px;\r\n    .info_top {\r\n      display: flex;\r\n      padding: 0 100px;\r\n      margin-bottom: 20px;\r\n      .item {\r\n        flex: 1;\r\n        display: flex;\r\n        align-items: center;\r\n      }\r\n    }\r\n    .twoHeight {\r\n      height: 250px;\r\n    }\r\n    .info_under {\r\n      margin-top: 20px;\r\n      display: flex;\r\n      padding: 0 100px;\r\n\r\n      .item {\r\n        flex: 1;\r\n        display: flex;\r\n        align-items: center;\r\n      }\r\n      .item1 {\r\n        flex: 1;\r\n        display: flex;\r\n        padding-right: 20px;\r\n      }\r\n    }\r\n  }\r\n  // 工具栏\r\n  .agentOrder_tool {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    .btn {\r\n      width: 160px;\r\n      height: 40px;\r\n    }\r\n    .btn1 {\r\n      color: #2e4c9e;\r\n    }\r\n    .btn2 {\r\n      background-color: #2e4c9e;\r\n      color: #fff;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}