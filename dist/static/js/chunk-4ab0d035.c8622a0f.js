(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ab0d035"],{"3f69":function(t,a,e){"use strict";e("e552")},e552:function(t,a,e){},ea344:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"assignmentMasterBox"},[e("div",{ref:"mapContainer",attrs:{id:"map-container"}}),e("div",{staticClass:"acceptOrdersMaster"},[e("div",{staticClass:"title"},[t._v(" é™„è¿‘å…±æœ‰"),e("span",{staticClass:"num"},[t._v(t._s(t.masters.length))]),t._v("ä½å¸ˆå‚…æ¥å• ")]),e("div",{staticClass:"masterListBox"},t._l(t.masters,(function(a){return e("div",{key:a.name,staticClass:"masterItem"},[e("div",{staticClass:"masterItem_left"},[e("div",{staticClass:"masterAvatar"},[e("img",{attrs:{src:a.avatar||t.ICONS.defaultAvatar,alt:"å¤´åƒ",loading:"lazy"}})])]),e("div",{staticClass:"masterItem_right"},[e("div",{staticClass:"masterName"},[e("div",[t._v(t._s(a.name))]),e("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleAssign(a)}}},[t._v(" æŒ‡æ´¾ ")])],1),e("div",{staticClass:"masterInfo"},[t._v("æœåŠ¡æ¬¡æ•°ï¼š"+t._s(a.num)+"æ¬¡")]),e("div",{staticClass:"masterInfo"},[t._v("æœåŠ¡åŒºåŸŸï¼š"+t._s(a.area))]),e("div",{staticClass:"masterInfo"},[t._v(" æœåŠ¡æŠ€èƒ½ï¼š "),t._l(t.splitSkills(a.skill),(function(a){return e("el-tag",{key:a,staticStyle:{"margin-right":"4px","margin-top":"2px"},attrs:{size:"small",effect:"light"}},[t._v(" "+t._s(a)+" ")])}))],2)])])})),0),e("div",{staticClass:"paginationBox"},[e("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":10},on:{"current-change":t.handlePageChange}})],1)])])},s=[];e("d81d"),e("b0c0"),e("159b"),e("4de4"),e("ac1f"),e("1276"),e("498a");var i={name:"TianDiMap",props:{company:{type:Object,default:function(){return{name:"å¹¿ä¸œæœºå°†ä¿¡æ¯ç§‘æŠ€æœ‰é™å…¬å¸",lng:113.700589,lat:22.936517}}},mastersData:{type:Array,default:function(){return[]}},tiandituKey:{type:String,default:Object({NODE_ENV:"production",VUE_APP_BASE_API:"https://japi.jijiangkeji.com",BASE_URL:"/jadminWeb/"}).VUE_APP_TIANDITU_KEY||"299cdd394ec7f801437bbf1f8595a262"}},data:function(){return{map:null,ICONS:{company:"https://snk-1305456087.cos.ap-guangzhou.myqcloud.com/user/20251104/HS43766082.png",master:"https://snk-1305456087.cos.ap-guangzhou.myqcloud.com/user/20251104/PW34165872.png",defaultAvatar:"https://snk-1305456087.cos.ap-guangzhou.myqcloud.com/user/20240723/UN96809320.jpg"},companyOverlays:[],masterOverlays:[],masters:[],total:100}},created:function(){this.debounceUpdateMasters=this.$utils?this.$utils.debounce:this.makeDebounce(300),this.masters=this.mastersData.length?this.mastersData:this.getMockMasters()},mounted:function(){console.log("ğŸš€ mapContainer:",this.$refs.mapContainer),this.initMap()},beforeDestroy:function(){this.destroyMap()},watch:{mastersData:{handler:function(t){Array.isArray(t)&&(this.masters=t,this.debounceUpdateMasters(t))},immediate:!0},masters:function(t){this.debounceUpdateMasters(t)}},methods:{initMap:function(){var t=this;if(window.T)this._doInitMap();else{var a="tianditu-script",e=document.getElementById(a);if(e){var n=function a(){window.T?t._doInitMap():setTimeout(a,200)};n()}else{var s=document.createElement("script");s.id=a,s.src="https://api.tianditu.gov.cn/api?v=4.0&tk=".concat(this.tiandituKey),s.onload=function(){setTimeout((function(){return t._doInitMap()}),100)},s.onerror=function(){console.error("[å¤©åœ°å›¾] SDK åŠ è½½å¤±è´¥"),t.$message.error("åœ°å›¾æœåŠ¡åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åé‡è¯•")},document.head.appendChild(s)}}},_doInitMap:function(){if(window.T)try{console.log("[å¤©åœ°å›¾] å¼€å§‹åˆ›å»ºåœ°å›¾å®ä¾‹..."),this.map=new T.Map(this.$refs.mapContainer,{projection:"EPSG:4326"}),console.log("[å¤©åœ°å›¾] åœ°å›¾å®ä¾‹åˆ›å»ºæˆåŠŸ");var t=this.gcj02FromWgs84(this.company.lng,this.company.lat),a=t.lng,e=t.lat,n=new T.LngLat(a,e);this.map.centerAndZoom(n,16),console.log("[å¤©åœ°å›¾] åœ°å›¾ä¸­å¿ƒè®¾ç½®æˆåŠŸ"),this.addVectorLayers(),console.log("[å¤©åœ°å›¾] å›¾å±‚æ·»åŠ æˆåŠŸ"),this.map.addControl(new T.Control.Zoom),this.map.addControl(new T.Control.MapType),console.log("[å¤©åœ°å›¾] æ§ä»¶æ·»åŠ æˆåŠŸ"),this.addCompanyMarker(this.company),this.updateMasters(this.masters),console.log("[å¤©åœ°å›¾] æ ‡è®°æ·»åŠ æˆåŠŸ")}catch(s){console.error("[å¤©åœ°å›¾] åˆå§‹åŒ–å¤±è´¥:",s),this.$message.error("åœ°å›¾åˆå§‹åŒ–å¤±è´¥ï¼š"+(s.message||"æœªçŸ¥é”™è¯¯"))}else console.error("[å¤©åœ°å›¾] window.T æœªå®šä¹‰")},addVectorLayers:function(){try{var t=new T.TileLayer("vec",{maxZoom:18}),a=new T.TileLayer("cva",{maxZoom:18}),e=function(t){var a,e,n=null===(a=t.target)||void 0===a||null===(e=a.Ce)||void 0===e?void 0:e.el;n&&n.style&&(n.style.display="none")};t.on("tileerror",e),a.on("tileerror",e),this.map.addLayer(t),this.map.addLayer(a)}catch(n){console.warn("[å¤©åœ°å›¾] çŸ¢é‡å›¾å±‚å¤±è´¥ï¼Œé™çº§ä¸ºå½±åƒå›¾å±‚",n),this.addImageLayers()}},addImageLayers:function(){try{var t=new T.TileLayer("img",{maxZoom:18}),a=new T.TileLayer("cia",{maxZoom:18});this.map.addLayer(t),this.map.addLayer(a)}catch(e){console.error("[å¤©åœ°å›¾] å½±åƒå›¾å±‚ä¹Ÿå¤±è´¥",e)}},addCompanyMarker:function(t){var a=this;try{console.log("[åæ ‡] åŸå§‹:",t.lng,t.lat);var e=this.gcj02FromWgs84(t.lng,t.lat),n=e.lng,s=e.lat;if(console.log("[åæ ‡] è½¬æ¢å:",n,s),isNaN(n)||isNaN(s))return void console.error("åæ ‡è½¬æ¢å¤±è´¥",t);var i=new T.LngLat(n,s),r=new T.Icon({iconUrl:this.ICONS.company,iconSize:new T.Point(32,32),iconAnchor:new T.Point(16,32)}),o=new T.Marker(i,{icon:r}),l=new T.Label({text:t.name,position:i,offset:new T.Point(0,-35),textStyle:{color:"#1890ff",fontSize:"12px"}});this.map.addOverLay(o),this.map.addOverLay(l),this.companyOverlays=[o,l],o.addEventListener("click",(function(){a.$emit("company-click",t)}))}catch(c){console.error("[æ ‡è®°] æ·»åŠ ä¼ä¸šå¤±è´¥",c)}},updateMasters:function(t){var a=this;this.clearMasterMarkers(),Array.isArray(t)&&0!==t.length&&t.forEach((function(t){if(t.lng&&t.lat)try{var e=a.gcj02FromWgs84(t.lng,t.lat),n=e.lng,s=e.lat,i=new T.LngLat(n,s),r=new T.Icon({iconUrl:a.ICONS.master,iconSize:new T.Point(28,28),iconAnchor:new T.Point(14,28)}),o=new T.Marker(i,{icon:r,title:t.name}),l=new T.Label({text:t.name,position:i,offset:new T.Point(0,-30),textStyle:{fontSize:"11px",color:"#666"}});a.map.addOverLay(o),a.map.addOverLay(l),a.masterOverlays.push(o,l),o.addEventListener("click",(function(){a.$emit("master-click",t)}))}catch(c){console.warn("[æ ‡è®°] æ·»åŠ å¸ˆå‚…å¤±è´¥",t.name,c)}}))},clearMasterMarkers:function(){var t=this;this.masterOverlays.forEach((function(a){try{var e;null===(e=t.map)||void 0===e||e.removeOverLay(a)}catch(n){}})),this.masterOverlays=[]},destroyMap:function(){var t=this;this.clearMasterMarkers(),this.companyOverlays.forEach((function(a){var e;return null===(e=t.map)||void 0===e?void 0:e.removeOverLay(a)})),this.map&&(this.map.destroy(),this.map=null)},gcj02FromWgs84:function(t,a){if(this.outOfChina(a,t))return{lat:a,lng:t};var e=6378245,n=.006693421622965943;function s(t,a){var e=2*t-100+3*a+.2*a*a+.1*t*a+.2*Math.sqrt(Math.abs(t));return e+=2*(20*Math.sin(6*t*Math.PI)+20*Math.sin(2*t*Math.PI))/3,e+=2*(20*Math.sin(a*Math.PI)+40*Math.sin(a/3*Math.PI))/3,e+=2*(160*Math.sin(a/12*Math.PI)+320*Math.sin(a*Math.PI/30))/3,e}function i(t,a){var e=300+t+2*a+.1*t*t+.1*t*a+.1*Math.sqrt(Math.abs(t));return e+=2*(20*Math.sin(6*t*Math.PI)+20*Math.sin(2*t*Math.PI))/3,e+=2*(20*Math.sin(t*Math.PI)+40*Math.sin(t/3*Math.PI))/3,e+=2*(150*Math.sin(t/12*Math.PI)+300*Math.sin(t/30*Math.PI))/3,e}var r=s(t-105,a-35),o=i(t-105,a-35),l=a/180*Math.PI,c=1-n*Math.sin(l)*Math.sin(l),m=Math.sqrt(c);return r=180*r/(e*(1-n)/(c*m)*Math.PI),o=180*o/(e/m*Math.cos(l)*Math.PI),{lat:a+r,lng:t+o}},outOfChina:function(t,a){return t<72.004||t>137.8347||a<.8293||a>55.8271},splitSkills:function(t){return(t||"").split(/ã€|\/|\s+/).filter((function(t){return t.trim()})).map((function(t){return t.trim()}))},makeDebounce:function(t){var a;return function(e){clearTimeout(a),a=setTimeout(e,t)}},handleAssign:function(t){this.$emit("assign",t)},handlePageChange:function(t){this.$emit("page-change",t)},getMockMasters:function(){return[{name:"ç‹å¸ˆå‚…",lng:113.71,lat:22.935,num:20,area:"èŒ¶å±±é•‡ã€çŸ³æ’é•‡ã€ä¼çŸ³é•‡",skill:"æ•°æ§è½¦åºŠ/æ’åˆ€æœº/æ’åˆ€å¼ã€æ•°æ§è½¦åºŠ/æ’åˆ€æœº/ç®€æ˜“è½¦é“£"},{name:"é™ˆå¸ˆå‚…",lng:113.702,lat:22.929,num:35,area:"æ¨ªæ²¥é•‡ã€æ¡¥å¤´é•‡ã€å¤§å²­å±±é•‡",skill:"åŠ å·¥ä¸­å¿ƒ/ç«‹å¼åŠ å·¥ä¸­å¿ƒ/ä¸‰è½´ã€åŠ å·¥ä¸­å¿ƒ/ç«‹å¼åŠ å·¥ä¸­å¿ƒ/å››è½´"},{name:"æ—å¸ˆå‚…",lng:113.708,lat:22.933,num:50,area:"é•¿å®‰é•‡ã€èŒ¶å±±é•‡ã€çŸ³æ’é•‡",skill:"åŠ å·¥ä¸­å¿ƒ/é¾™é—¨å¼åŠ å·¥ä¸­å¿ƒ/ä¸‰è½´ã€åŠ å·¥ä¸­å¿ƒ/é¾™é—¨å¼åŠ å·¥ä¸­å¿ƒ/å››è½´"},{name:"æå¸ˆå‚…",lng:113.695,lat:22.937,num:15,area:"å¤§å²­å±±é•‡ã€æ¡¥å¤´é•‡ã€ä¼çŸ³é•‡",skill:"æ•°æ§è½¦åºŠ/æ’åˆ€æœº/æ’åˆ€å¼ã€æ•°æ§è½¦åºŠ/æ’åˆ€æœº/ç®€æ˜“è½¦é“£"},{name:"å¼ å¸ˆå‚…",lng:113.699,lat:22.928,num:40,area:"æ¨ªæ²¥é•‡ã€é•¿å®‰é•‡ã€èŒ¶å±±é•‡",skill:"åŠ å·¥ä¸­å¿ƒ/ç«‹å¼åŠ å·¥ä¸­å¿ƒ/ä¸‰è½´ã€åŠ å·¥ä¸­å¿ƒ/ç«‹å¼åŠ å·¥ä¸­å¿ƒ/å››è½´"},{name:"å‘¨å¸ˆå‚…",lng:113.705,lat:22.931,num:25,area:"çŸ³æ’é•‡ã€ä¼çŸ³é•‡ã€å¤§å²­å±±é•‡",skill:"åŠ å·¥ä¸­å¿ƒ/é¾™é—¨å¼åŠ å·¥ä¸­å¿ƒ/ä¸‰è½´ã€åŠ å·¥ä¸­å¿ƒ/é¾™é—¨å¼åŠ å·¥ä¸­å¿ƒ/å››è½´"},{name:"å´å¸ˆå‚…",lng:113.703,lat:22.936,num:30,area:"æ¡¥å¤´é•‡ã€é•¿å®‰é•‡ã€èŒ¶å±±é•‡",skill:"æ•°æ§è½¦åºŠ/æ’åˆ€æœº/æ’åˆ€å¼ã€æ•°æ§è½¦åºŠ/æ’åˆ€æœº/ç®€æ˜“è½¦é“£"},{name:"éƒ‘å¸ˆå‚…",lng:113.707,lat:22.93,num:45,area:"å¤§å²­å±±é•‡ã€æ¨ªæ²¥é•‡ã€çŸ³æ’é•‡",skill:"åŠ å·¥ä¸­å¿ƒ/ç«‹å¼åŠ å·¥ä¸­å¿ƒ/ä¸‰è½´ã€åŠ å·¥ä¸­å¿ƒ/ç«‹å¼åŠ å·¥ä¸­å¿ƒ/å››è½´"}]}}},r=i,o=(e("3f69"),e("2877")),l=Object(o["a"])(r,n,s,!1,null,"47aa4c1f",null);a["default"]=l.exports}}]);