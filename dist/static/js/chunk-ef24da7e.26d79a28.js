(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef24da7e"],{"97df":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"masterOrderDiscount"},[t("div",{staticClass:"topControls"},[t("div",{staticClass:"topControlsSearchInfo"},[t("div",{staticClass:"topControlsSearchInfoItem"},[t("div",{staticClass:"label"},[e._v("师傅姓名")]),t("div",[t("el-input",{attrs:{placeholder:"请输入师傅姓名"},model:{value:e.queryMasterOrderDiscountListParams.realName,callback:function(r){e.$set(e.queryMasterOrderDiscountListParams,"realName",r)},expression:"queryMasterOrderDiscountListParams.realName"}})],1)]),t("div",{staticClass:"topControlsSearchInfoItem"},[t("div",{staticClass:"label"},[e._v("企业订单号")]),t("div",[t("el-input",{attrs:{placeholder:"请输入企业订单号"},model:{value:e.queryMasterOrderDiscountListParams.relationOrderSn,callback:function(r){e.$set(e.queryMasterOrderDiscountListParams,"relationOrderSn",r)},expression:"queryMasterOrderDiscountListParams.relationOrderSn"}})],1)]),t("div",{staticClass:"topControlsSearchInfoItem"},[t("div",{staticClass:"label"},[e._v("查询时间")]),t("div",[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeQueryTime},model:{value:e.queryTime,callback:function(r){e.queryTime=r},expression:"queryTime"}})],1)])]),t("div",{staticClass:"topControlsBtn"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(r){return e.openMergeOrderDialog(null)}}},[e._v("新增")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.serachMasterOrderDiscountList}},[e._v("搜索")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.resetMasterOrderDiscountList}},[e._v("重置")])],1)]),t("el-card",{staticStyle:{padding:"20px"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.masterOrderDiscountList}},[t("el-table-column",{attrs:{width:"200",prop:"targetTime",label:"折扣计算时间",align:"center"}}),t("el-table-column",{attrs:{width:"200",prop:"realName",label:"师傅名称",align:"center"}}),t("el-table-column",{attrs:{label:"企业订单号",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return e._l(a.relationOrderSnList,(function(r){return t("div",{key:r,staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(t){return t.preventDefault(),e.goToOrderDesc(r)}}},[e._v(" "+e._s(r)+" ")])}))}}])}),t("el-table-column",{attrs:{prop:"message",label:"描述",align:"center"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("el-button",{attrs:{type:"text"},on:{click:function(r){return e.openMergeOrderDialog(a.id,a.relationOrderSnList)}}},[e._v(" 修改 ")]),t("el-button",{attrs:{type:"text"},on:{click:function(r){return e.deleteMasterDiscountLog(a.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"tabelPagination"},[t("el-pagination",{attrs:{total:e.masterOrderDiscountListTotal,"current-page":e.queryMasterOrderDiscountListParams.pageNo,background:"",layout:"prev, pager, next","page-size":e.queryMasterOrderDiscountListParams.pageSize},on:{"current-change":e.changeMasterOrderDiscountListPage}})],1)],1),t("el-dialog",{attrs:{title:"手动合并订单",visible:e.mergeOrderVisible,"before-close":e.closeMergeOrderDialog,"close-on-click-modal":!1,width:"30%",center:""}},[t("h3",[e._v("需要合并的订单如下:")]),t("div",{staticStyle:{margin:"15px 0",color:"red"}},[e._v(" 注:订单号必须满足同个师傅,设备产地国产 ")]),t("el-form",e._l(e.mergeOrderList,(function(r,a){return t("el-form-item",{key:"订单号"+(a+1),attrs:{label:"订单号"+(a+1)}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-input",{attrs:{placeholder:"请填写订单编号"},model:{value:e.mergeOrderList[a],callback:function(r){e.$set(e.mergeOrderList,a,r)},expression:"mergeOrderList[index]"}}),0!=a?t("el-button",{staticStyle:{"margin-left":"15px"},on:{click:function(r){return e.delOrderNum(a)}}},[e._v(" 删除 ")]):e._e()],1)])})),1),t("el-button",{on:{click:e.addOrderNum}},[e._v("新增订单号")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirmMasterOrder}},[e._v("确 定")]),t("el-button",{on:{click:e.closeMergeOrderDialog}},[e._v("取 消")])],1)],1)],1)},n=[],s=t("2909"),i=t("1da1"),o=(t("4de4"),t("a15b"),t("a434"),t("96cf"),t("f8b7")),l={data:function(){return{masterOrderDiscountListTotal:null,masterOrderDiscountList:[],queryMasterOrderDiscountListParams:{pageNo:1,pageSize:10,queryTime:null,realName:null,relationOrderSn:null},queryTime:null,mergeOrderVisible:!1,mergeOrderList:[],handleMergeMasterOrderParams:{id:null,relationOrderSn:null}}},methods:{deleteMasterDiscountLog:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.$confirm("您确定删除这条合并记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 2:if(a=t.sent,"confirm"!=a){t.next=8;break}return t.next=6,Object(o["h"])({id:e});case 6:n=t.sent,"操作成功"==n.message&&(r.$message({message:n.message,type:"success"}),r.queryMasterOrderDiscountList());case 8:case"end":return t.stop()}}),t)})))()},confirmMasterOrder:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var t,a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t=Object(s["a"])(e.mergeOrderList),a=t.filter((function(e){return null!==e&&void 0!==e&&""!==e})),0!=a.length){r.next=5;break}return e.$message({message:"至少填写一个订单号",type:"warning"}),r.abrupt("return");case 5:return e.handleMergeMasterOrderParams.relationOrderSn=a.join(","),r.next=8,Object(o["V"])(e.handleMergeMasterOrderParams);case 8:n=r.sent,"操作成功"==n.message&&(e.closeMergeOrderDialog(),e.queryMasterOrderDiscountList());case 10:case"end":return r.stop()}}),r)})))()},delOrderNum:function(e){this.mergeOrderList.splice(e,1)},closeMergeOrderDialog:function(){this.handleMergeMasterOrderParams={id:null,relationOrderSn:null},this.mergeOrderList=[],this.mergeOrderVisible=!1},addOrderNum:function(){this.mergeOrderList.push("")},openMergeOrderDialog:function(e,r){e?(this.handleMergeMasterOrderParams.id=e,this.mergeOrderList=Object(s["a"])(r),console.log("修改")):this.mergeOrderList.push(""),this.mergeOrderVisible=!0},goToOrderDesc:function(e){this.$router.push({name:"maintenance_order_desc",query:{orderSn:e}})},resetMasterOrderDiscountList:function(){this.queryTime=null,this.queryMasterOrderDiscountListParams={pageNo:1,pageSize:10,queryTime:null,realName:null,relationOrderSn:null},this.queryMasterOrderDiscountList()},changeQueryTime:function(){this.queryMasterOrderDiscountListParams.queryTime=this.queryTime[0]+"~"+this.queryTime[1]},queryMasterOrderDiscountList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(o["Eb"])(e.queryMasterOrderDiscountListParams);case 2:t=r.sent,e.masterOrderDiscountList=t.data.records,e.masterOrderDiscountListTotal=t.data.total;case 5:case"end":return r.stop()}}),r)})))()},changeMasterOrderDiscountListPage:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.queryMasterOrderDiscountListParams.pageNo=e,r.queryMasterOrderDiscountList();case 2:case"end":return t.stop()}}),t)})))()},serachMasterOrderDiscountList:function(){this.queryMasterOrderDiscountListParams.pageNo=1,this.queryMasterOrderDiscountList()}},created:function(){this.queryMasterOrderDiscountList()}},c=l,u=(t("ea2e"),t("2877")),d=Object(u["a"])(c,a,n,!1,null,"490d48d6",null);r["default"]=d.exports},"9ce2":function(e,r,t){},a15b:function(e,r,t){"use strict";var a=t("23e7"),n=t("e330"),s=t("44ad"),i=t("fc6a"),o=t("a640"),l=n([].join),c=s!=Object,u=o("join",",");a({target:"Array",proto:!0,forced:c||!u},{join:function(e){return l(i(this),void 0===e?",":e)}})},ea2e:function(e,r,t){"use strict";t("9ce2")}}]);