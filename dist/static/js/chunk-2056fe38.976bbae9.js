(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2056fe38"],{"08a2":function(t,e,n){},"9f07":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content_box"},[n("first-title",{attrs:{title:"角色管理"}}),n("div",{staticClass:"select_view"},[n("el-button",{attrs:{type:"primary"},on:{click:t.addDataFn}},[n("i",{staticClass:"el-icon-plus"}),t._v("添加角色")]),n("span",{staticClass:"mg_l15",staticStyle:{color:"#F56C6C"}},[t._v("注意：“修改”和“添加”系统角色项目后需要点击右侧“提交编辑”按钮才会生效哦")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataConfig.loading,expression:"dataConfig.loading"}],staticClass:"list",attrs:{border:"",data:t.dataList}},[n("el-table-column",{attrs:{label:"角色ID",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.id?n("span",[t._v(t._s(e.row.id))]):t._e(),e.row.id?t._e():n("span",{staticClass:"delete_icon",on:{click:function(n){return t.deleteAddFn(e.$index)}}},[n("i",{staticClass:"el-icon-delete"})])]}}])}),n("el-table-column",{attrs:{label:"角色名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.row.name,callback:function(n){t.$set(e.row,"name",n)},expression:"scope.row.name"}})]}}])}),n("el-table-column",{attrs:{label:"角色描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{placeholder:"请输入角色描述"},model:{value:e.row.description,callback:function(n){t.$set(e.row,"description",n)},expression:"scope.row.description"}})]}}])}),n("el-table-column",{staticStyle:{width:"100px"},attrs:{label:"角色权限菜单"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[n("div",{staticStyle:{width:"400px","line-height":"1.6em"},attrs:{slot:"content"},slot:"content"},[n("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("已选权限ID")]),n("p",[t._v(t._s(e.row.menuIds&&e.row.menuIds.join(",")))])]),n("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(n){return t.checkMenuFn(e)}}},[t._v("点击选择菜单")])],1)]}}])}),n("el-table-column",{attrs:{label:"状态(禁用/启用)"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-switch",{attrs:{disabled:""==e.row.id},on:{change:function(n){return t.statusChangeFn(n,e.$index)}},model:{value:e.row.status,callback:function(n){t.$set(e.row,"status",n)},expression:"scope.row.status"}})]}}])}),n("el-table-column",{attrs:{label:"操作",width:"240px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return t.editDataFn(e.row)}}},[t._v("提交编辑")]),e.row.id?n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){return t.deleteFn(e)}}},[n("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]}}])})],1),n("div",{staticClass:"el_pagination"},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next,total,sizes","current-page":t.dataConfig.pageNo,total:t.dataConfig.total,"page-sizes":[20,30,40,50]},on:{"current-change":t.currentChangeFn,"size-change":t.handleSizeChange}})],1),n("el-dialog",{attrs:{title:"权限菜单配置",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-tree",{ref:"tree",attrs:{props:t.defaultProps,data:t.treeList,"check-strictly":!0,"node-key":"id","default-checked-keys":[],"show-checkbox":""},on:{"check-change":t.checkChangeFn}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.getCheckedKeysFn}},[t._v("确 定")])],1)],1)],1)},a=[],i=n("2909"),o=n("5530"),c=(n("99af"),n("b0c0"),n("159b"),n("a434"),n("a4d3"),n("e01a"),n("fb6a"),n("d3b7"),n("8593")),l=n("2f62"),r={name:"SetupRole",data:function(){return{dataList:[],dialogVisible:!1,treeList:[],checkedRowIndex:0,defaultProps:{label:function(t,e){return"".concat(t.name,"(ID:").concat(t.id,")")},children:"children"},editData:{description:"",id:"",isAdmin:"",menuIds:[],name:"",status:!0},dataConfig:{pageNo:1,pageSize:50,total:0,loading:!0}}},beforeMount:function(){var t=this;this["user/actionMenulist"]({menuType:-1}).then((function(){t.roleListFn()}))},computed:Object(o["a"])({},Object(l["c"])(["menuTreeList"])),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])(["user/actionMenulist"])),{},{checkChangeFn:function(t,e,n){e?(console.log(t.parentId),0!=t.parentId&&this.$refs.tree.setChecked(t.parentId,!0)):this.checkChildren(t)},checkChildren:function(t){var e=this;t.children.forEach((function(t){e.$refs.tree.setChecked(t.id,!1),t.children&&t.children.length>0&&e.checkChildren(t)}))},getCheckedKeysFn:function(){var t,e=this.$refs.tree.getCheckedKeys();(t=this.dataList[this.checkedRowIndex].menuIds).splice.apply(t,[0,this.dataList[this.checkedRowIndex].menuIds.length].concat(Object(i["a"])(e))),this.dialogVisible=!1},checkMenuFn:function(t){var e,n=this;this.dialogVisible=!0,this.checkedRowIndex=t.$index,(e=this.treeList).splice.apply(e,[0,this.treeList.length].concat(Object(i["a"])(t.row.treeList))),this.$nextTick((function(){n.$refs.tree.setCheckedKeys(t.row.menuIds)}))},handleSizeChange:function(t){this.dataConfig.pageSize=t,this.roleListFn()},currentChangeFn:function(t){this.dataConfig.pageNo=t,this.roleListFn()},addDataFn:function(){this.editData={description:"",id:"",isAdmin:"",menuIds:[],name:"",status:!0},this.dataList.unshift(Object.assign({},this.editData,{treeList:this.menuTreeList}))},deleteAddFn:function(t){this.dataList.splice(t,1)},statusChangeFn:function(t,e){var n=this;console.log(t),Object(c["m"])({id:this.dataList[e].id,status:t?1:0}).then((function(s){"000"==s.code?n.$message({showClose:!0,message:"操作成功！",type:"success"}):n.dataList[e].status=!t})).catch((function(){n.dataList[e].status=!t}))},editDataFn:function(t){var e=this;t.name?0!=t.menuIds.length?Object(c["c"])({description:t.description,id:t.id,isAdmin:t.isAdmin,menuIds:t.menuIds.slice(),name:t.name}).then((function(t){var n=e.resDataFn(t);"000"==n&&(e.$message({showClose:!0,message:"操作成功！",type:"success"}),e.roleListFn())})):this.$message({showClose:!0,message:"请选择角色权限菜单！",type:"warning"}):this.$message({showClose:!0,message:"请填写角色名称！",type:"warning"})},deleteFn:function(t){var e=this;this.deleteAlert().then((function(){var e=Object(c["v"])({id:t.row.id});return e})).then((function(n){var s=e.resDataFn(n);"000"==s&&(e.$message({showClose:!0,message:"操作成功！",type:"success"}),e.dataList.splice(t.$index,1))}))},menuRouteKList:function(t){var e=[],n=function t(n){n.forEach((function(n){n.id&&e.push(n.id),"[object Array]"==Object.prototype.toString.call(n.children)&&t(n.children)}))};return n(t),e},menuTreeListFn:function(){var t=this;this.dataList.forEach((function(e,n){e.status=1==e.status,e.id&&Object(c["q"])({id:e.id}).then((function(s){var a=t.resDataFn(s);t.$set(t.dataList,n,Object.assign({},e,{menuIds:t.menuRouteKList(a)}))}))}))},roleListFn:function(){var t=this;Object(c["u"])({pageNo:this.dataConfig.pageNo,pageSize:this.dataConfig.pageSize}).then((function(e){var n,s=t.resDataFn(e);s.records.forEach((function(e){e.treeList=t.menuTreeList})),(n=t.dataList).splice.apply(n,[0,t.dataList.length].concat(Object(i["a"])(s.records))),t.dataConfig.total=s.total,console.log(t.dataList),t.menuTreeListFn()}))}})},d=r,u=(n("cae1"),n("2877")),h=Object(u["a"])(d,s,a,!1,null,null,null);e["default"]=h.exports},cae1:function(t,e,n){"use strict";n("08a2")}}]);