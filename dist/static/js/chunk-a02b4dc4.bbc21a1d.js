(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a02b4dc4"],{"0945":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"messageList"},[r("div",{staticClass:"topControls"},[r("div",{staticClass:"topControlsSearchInfo"},[r("div",{staticClass:"topControlsSearchInfoItem"},[r("div",{staticClass:"label"},[e._v("订单号")]),r("div",[r("el-input",{attrs:{placeholder:"请输入订单号"},model:{value:e.queryOrderReminderListParams.relationOrderSn,callback:function(t){e.$set(e.queryOrderReminderListParams,"relationOrderSn",t)},expression:"queryOrderReminderListParams.relationOrderSn"}})],1)]),r("div",{staticClass:"topControlsSearchInfoItem"},[r("div",{staticClass:"label"},[e._v("状态")]),r("div",[r("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.queryOrderReminderListParams.status,callback:function(t){e.$set(e.queryOrderReminderListParams,"status",t)},expression:"queryOrderReminderListParams.status"}},[r("el-option",{attrs:{label:"未处理",value:0}}),r("el-option",{attrs:{label:"已处理",value:1}})],1)],1)])]),r("div",{staticClass:"topControlsBtn"},[r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.queryOrderReminderList}},[e._v("搜索")]),r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.resetSearch}},[e._v("重置")])],1)]),r("el-card",{staticStyle:{padding:"20px"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderReminderList}},[r("el-table-column",{attrs:{prop:"createTime",width:"180",label:"创建时间",align:"center"}}),r("el-table-column",{attrs:{width:"180",label:"订单号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.goToOrderDetails(a.relationOrderSn)}}},[e._v(e._s(a.relationOrderSn))])]}}])}),r("el-table-column",{attrs:{width:"180",prop:"reminderTime",label:"通知时间",align:"center"}}),r("el-table-column",{attrs:{prop:"content",label:"内容",align:"center"}}),r("el-table-column",{attrs:{width:"100",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("div",{style:{color:0==a.status?"#f56c6c":""}},[e._v(" "+e._s(a.statusName)+" ")])]}}])}),r("el-table-column",{attrs:{width:"200",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[0==a.status?r("div",[r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openExtensionTimeDialog(a)}}},[e._v("延后")]),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleOrderReminder("处理",a.id)}}},[e._v("我已处理")])],1):r("div",[e._v("/")])]}}])})],1),r("div",{staticClass:"tabelPagination"},[r("el-pagination",{attrs:{total:e.orderReminderListTotal,background:"",layout:"prev, pager, next","page-size":e.queryOrderReminderListParams.pageSize},on:{"current-change":e.changeListPage}})],1)],1),r("el-dialog",{attrs:{title:"延后提醒时间",center:"",visible:e.extensionTimeDialogVisible,width:"30%"}},[r("el-form",[r("el-form-item",{attrs:{label:"提醒时间"}},[r("el-date-picker",{staticStyle:{"margin-right":"10px"},attrs:{type:"date","picker-options":e.pickerOptionsDate,placeholder:"选择提醒日期","value-format":"yyyy-MM-dd"},model:{value:e.datePickerVal,callback:function(t){e.datePickerVal=t},expression:"datePickerVal"}}),r("el-time-select",{attrs:{"picker-options":{start:"09:00",end:"18:00",step:"00:15"},placeholder:"选择提醒时间"},model:{value:e.timePickerVal,callback:function(t){e.timePickerVal=t},expression:"timePickerVal"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.closeExtensionTimeDialog}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleOrderReminder("延长")}}},[e._v("确 定")])],1)],1)],1)},n=[],i=r("1da1"),s=r("3835"),l=(r("96cf"),r("99af"),r("caad"),r("2532"),r("ac1f"),r("1276"),r("d81d"),r("a9e3"),r("4d90"),r("d3b7"),r("25f0"),r("b147")),o={data:function(){return{queryOrderReminderListParams:{status:null,relationOrderSn:null,pageNo:1,pageSize:10},orderReminderList:[],orderReminderListTotal:0,handleOrderReminderParams:{handleType:null,id:null,newReminderTime:null},extensionTimeDialogVisible:!1,pickerOptionsDate:{disabledDate:function(e){return e.getTime()<(new Date).setHours(0,0,0,0)}},datePickerVal:null,timePickerVal:null,reminderTime:null}},methods:{goToOrderDetails:function(e){var t=this.$router.resolve({name:"maintenance_order_desc",query:{orderSn:e}});window.open(t.href,"_blank")},changeListPage:function(e){this.queryOrderReminderListParams.pageNo=e,this.queryOrderReminderList()},resetSearch:function(){this.queryOrderReminderListParams={status:null,relationOrderSn:null,pageNo:1,pageSize:10},this.queryOrderReminderList()},isDateTimeNotLess:function(e,t,r){var a="".concat(e," ").concat(t),n=a.includes(":")&&2===a.split(":").length?"".concat(a,":00"):a,i=new Date(n),s=new Date(r);if(isNaN(i)||isNaN(s))throw new Error("Invalid date/time string provided");return i.getTime()>=s.getTime()},closeExtensionTimeDialog:function(){this.handleOrderReminderParams={handleType:null,id:null,newReminderTime:null},this.datePickerVal=null,this.timePickerVal=null,this.reminderTime=null,this.extensionTimeDialogVisible=!1},openExtensionTimeDialog:function(e){if(this.handleOrderReminderParams.id=e.id,this.handleOrderReminderParams.handleType=2,this.reminderTime=e.reminderTime,e.reminderTime){var t=e.reminderTime.split(" "),r=Object(s["a"])(t,2),a=r[0],n=r[1];this.datePickerVal=a,this.timePickerVal=n.substring(0,5)}this.extensionTimeDialogVisible=!0},handleOrderReminder:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,o,d,c,m,u,p,h;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("处理"!=e){a.next=4;break}r.$confirm("您确定要将该提醒标记为已处理?","处理提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.handleOrderReminderParams.id=t,r.handleOrderReminderParams.handleType=1,e.next=4,Object(l["a"])(r.handleOrderReminderParams);case 4:a=e.sent,"000"==a.code&&(r.$message({type:"success",message:"操作成功"}),r.queryOrderReminderList(),r.closeExtensionTimeDialog());case 6:case"end":return e.stop()}}),e)})))),a.next=15;break;case 4:if(n=r.isDateTimeNotLess(r.datePickerVal,r.timePickerVal,r.reminderTime),n){a.next=8;break}return r.$message({message:"延长的时间不能小于之前的选的时间",type:"warning"}),a.abrupt("return");case 8:return o=r.timePickerVal.split(":").map(Number),d=Object(s["a"])(o,2),c=d[0],m=d[1],u="".concat(r.datePickerVal," ").concat(c.toString().padStart(2,"0"),":").concat(m.toString().padStart(2,"0"),":00"),r.handleOrderReminderParams.newReminderTime=u,a.next=13,Object(l["a"])(r.handleOrderReminderParams);case 13:p=a.sent,"000"==p.code&&(r.handleOrderReminderParams.id&&(h="notif_shown_"+r.handleOrderReminderParams.id,localStorage.removeItem(h)),r.$message({type:"success",message:"操作成功"}),r.queryOrderReminderList(),r.closeExtensionTimeDialog());case 15:case"end":return a.stop()}}),a)})))()},queryOrderReminderList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["b"])(e.queryOrderReminderListParams);case 2:r=t.sent,"000"==r.code&&(e.orderReminderList=r.data.records,e.orderReminderListTotal=r.data.total);case 4:case"end":return t.stop()}}),t)})))()}},created:function(){this.queryOrderReminderList()}},d=o,c=(r("d320"),r("2877")),m=Object(c["a"])(d,a,n,!1,null,"32be5fb8",null);t["default"]=m.exports},d320:function(e,t,r){"use strict";r("f5fc")},f5fc:function(e,t,r){}}]);