(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b3804692"],{"2b20":function(e,t,i){"use strict";i("d06d")},"94be":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content_box"},[i("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[i("div",{staticClass:"topTool"},[i("el-input",{staticClass:"toolInput",attrs:{placeholder:"请输入标题"},model:{value:e.querySysNoticeListParmas.title,callback:function(t){e.$set(e.querySysNoticeListParmas,"title",t)},expression:"querySysNoticeListParmas.title"}}),i("el-select",{staticClass:"toolInput",attrs:{placeholder:"请选择类型"},model:{value:e.querySysNoticeListParmas.type,callback:function(t){e.$set(e.querySysNoticeListParmas,"type",t)},expression:"querySysNoticeListParmas.type"}},e._l(e.typeList,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",{staticClass:"topTool"},[i("el-button",{on:{click:e.openSystemNoticeDialog}},[e._v("新增")]),i("el-button",{on:{click:e.querySysNoticeList}},[e._v("搜索")]),i("el-button",{on:{click:e.resetSearchFn}},[e._v("重置")])],1)]),i("el-table",{staticClass:"list",staticStyle:{"min-height":"auto"},attrs:{border:"",data:e.sysNoticeList}},[i("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"center","header-align":"center"}}),i("el-table-column",{attrs:{label:"消息类型",prop:"type",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(" "+e._s(1==i.type?"企业公告":"师傅公告")+" ")]}}])}),i("el-table-column",{attrs:{label:"标题",prop:"title",align:"center","header-align":"center"}}),i("el-table-column",{attrs:{label:"内容",align:"center",width:"100","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openHtmlContentDialog(s)}}},[e._v("查看内容")])]}}])}),i("el-table-column",{attrs:{label:"排序",prop:"sort",align:"center",width:"100","header-align":"center"}}),i("el-table-column",{attrs:{width:"150",label:"操作",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openSystemNoticeDialog(s)}}},[e._v("编辑")]),i("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteSysNotice(s)}}},[e._v("删除")])]}}])})],1),i("div",{staticStyle:{height:"16px"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.typeList.length>0,expression:"typeList.length > 0"}],staticClass:"table-block",staticStyle:{"text-align":"center"}},[i("el-pagination",{attrs:{background:"","current-page":e.querySysNoticeListParmas.pageNo,"page-size":e.querySysNoticeListParmas.pageSize,"page-sizes":[20,30,50,100],layout:"total, prev, pager, next",total:e.sysNoticeListTotle},on:{"current-change":e.currentChangeFn}})],1),i("el-dialog",{attrs:{center:"",title:e.systemNoticeDialogTitle,visible:e.systemNoticeDialogVisible,width:"50%","show-close":!1,"close-on-click-modal":!1}},[i("el-form",{ref:"systemNoticeRef",attrs:{model:e.systemNoticeForm,rules:e.systemNoticeRules,"label-position":"left","label-width":"80px"}},[i("el-form-item",{attrs:{label:"消息类型",prop:"type"}},[i("el-select",{attrs:{placeholder:"请选择消息类型"},model:{value:e.systemNoticeForm.type,callback:function(t){e.$set(e.systemNoticeForm,"type",t)},expression:"systemNoticeForm.type"}},e._l(e.typeList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"排序",prop:"sort"}},[i("el-input",{attrs:{placeholder:"请填写排序",type:"number"},model:{value:e.systemNoticeForm.sort,callback:function(t){e.$set(e.systemNoticeForm,"sort",e._n(t))},expression:"systemNoticeForm.sort"}})],1),i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请填写标题"},model:{value:e.systemNoticeForm.title,callback:function(t){e.$set(e.systemNoticeForm,"title",t)},expression:"systemNoticeForm.title"}})],1),i("el-form-item",{attrs:{label:"内容",prop:"content"}},[i("VueEditor",{attrs:{useCustomImageHandler:"",editorToolbar:e.customToolbar},on:{"image-added":e.handleImageAdded},model:{value:e.systemNoticeForm.content,callback:function(t){e.$set(e.systemNoticeForm,"content",t)},expression:"systemNoticeForm.content"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeSystemNoticeDialog}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveSysNoticeDetail}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:e.htmlContentDialogTitle,visible:e.htmlContentDialogVisible,width:"40%","before-close":e.closeHtmlContentDialog,"show-close":!1}},[i("div",{staticStyle:{padding:"0 20px"},domProps:{innerHTML:e._s(e.richTextContent)}})])],1)},n=[],o=i("5530"),a=i("1da1"),r=(i("d3b7"),i("b0c0"),i("96cf"),i("b775"));function l(e){return Object(r["a"])({url:"/admin/notice/querySysNoticeList",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/admin/notice/saveSysNoticeDetail",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/admin/notice/deleteSysNotice?id="+e,method:"get"})}var m=i("8593"),y=i("5873"),d={components:{VueEditor:y["a"]},data:function(){return{sysNoticeList:[],sysNoticeListTotle:null,querySysNoticeListParmas:{title:null,type:null,pageNo:1,pageSize:10},typeList:[{value:1,label:"企业公告"},{value:2,label:"师傅公告"}],systemNoticeDialogTitle:"新增系统消息框",systemNoticeDialogVisible:!1,systemNoticeForm:{type:null,sort:null,title:null,content:null},systemNoticeRules:{type:[{required:!0,message:"请选择类型",trigger:"change"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"change"}]},customToolbar:[[{header:[!1,1,2,3,4,5,6]}],["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],["image"]],richTextContent:null,htmlContentDialogTitle:"内容展示",htmlContentDialogVisible:!1}},methods:{currentChangeFn:function(e){this.querySysNoticeListParmas.pageNo=e,this.querySysNoticeList()},resetSearchFn:function(){this.querySysNoticeListParmas.pageNo=1,this.querySysNoticeListParmas.title=null,this.querySysNoticeListParmas.type=null,this.querySysNoticeList()},closeHtmlContentDialog:function(){this.htmlContentDialogVisible=!1},openHtmlContentDialog:function(e){this.htmlContentDialogTitle="标题: "+e.title,this.richTextContent=e.content,this.htmlContentDialogVisible=!0},deleteSysNotice:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function i(){var s,n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$confirm("您确定要删除该消息通知【".concat(e.title,"】吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 2:if(s=i.sent,"confirm"!=s){i.next=11;break}return i.next=6,u(e.id);case 6:if(n=i.sent,"000"!=n.code){i.next=11;break}return i.next=10,t.querySysNoticeList();case 10:t.$message({message:"删除成功",type:"success"});case 11:case"end":return i.stop()}}),i)})))()},closeSystemNoticeDialog:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs["systemNoticeRef"].resetFields();case 2:e.systemNoticeDialogVisible=!1;case 3:case"end":return t.stop()}}),t)})))()},saveSysNoticeDetail:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs["systemNoticeRef"].validate();case 2:return t.next=4,c(e.systemNoticeForm);case 4:if(i=t.sent,"000"!=i.code){t.next=10;break}return t.next=8,e.querySysNoticeList();case 8:e.closeSystemNoticeDialog(),e.$message({message:"操作成功",type:"success"});case 10:case"end":return t.stop()}}),t)})))()},resizeImage:function(e,t){return new Promise((function(i,s){var n=new FileReader;n.onload=function(n){var o=new Image;o.src=n.target.result,o.onload=function(){var s=t/o.width,n=o.height*s,a=document.createElement("canvas"),r=a.getContext("2d");a.width=t,a.height=n,r.drawImage(o,0,0,t,n),a.toBlob((function(t){t.name=e.name,i(t)}),e.type||"image/jpeg",.9)},o.onerror=function(e){s(e)}},n.onerror=function(e){s(e)},n.readAsDataURL(e)}))},handleImageAdded:function(e,t,i,s){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){var a,r,l,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,n.resizeImage(e,350);case 2:return a=o.sent,r=new FormData,r.append("file",a,e.name),o.next=7,Object(m["a"])(r);case 7:l=o.sent,"000"==l.code&&(c=l.data,t.insertEmbed(i,"image",c),s());case 9:case"end":return o.stop()}}),o)})))()},openSystemNoticeDialog:function(e){e.id?(this.systemNoticeForm=Object(o["a"])({},e),this.systemNoticeDialogTitle="编辑系统消息框"):this.systemNoticeDialogTitle="新增系统消息框",this.systemNoticeDialogVisible=!0},querySysNoticeList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l(e.querySysNoticeListParmas);case 2:i=t.sent,"000"==i.code&&(e.sysNoticeList=i.data.records,e.sysNoticeListTotle=i.data.total);case 4:case"end":return t.stop()}}),t)})))()}},created:function(){this.querySysNoticeList()}},p=d,g=(i("2b20"),i("2877")),b=Object(g["a"])(p,s,n,!1,null,"0e5f0aee",null);t["default"]=b.exports},d06d:function(e,t,i){}}]);